; Common State file for M.U.G.E.N beta 2002.04.14

; ADD004 BASIC
; Ver.: 20070602


; System variables usage
; ----------------------
; Var name    Type   Purpose
; --------    ----   -------
; sysvar(0)   Temp   Set by State 5081 (HITL_SLIDE) to 1 to prevent
;                    showing ground hit frame in State 5110 (HIT_LIEDOWN).
;                    Used by guarding States.
; sysvar(1)   Temp   Used by State 40 (Jump Start) amd 45 (Air Jump Start)
;                    to keep track of which way to jump.
;                    Used by State 5100 and 5110 to remember downward
;                    velocity of player just before hitting the ground.
;                    Used in State 5080 for storing the anim # to display.
; sysfvar(3)  Temp   firt attack
; sysfvar(4)  Temp   team mode


; The following States have special handling within MUGEN, and should be
; overridden with caution:
; Jump Start (40): airjumping bookkeeping at time = 0
; All guard States (120-155): guard handling throughout State
; Hit_trip, shaking (5070): defence increases at time = 0
; Hit_bounce (5100): defence increases at time = 0, player becomes
;                    invincible if within 10 ticks of getting up
; Hit_liedown (5110): player changes to get-up State (5120) when ready
; Hit_getup (5120): player's defence is restored to normal at time = 0
; Hitfall_recover (5200): player's defence is restored at time = 0
; Hitfall_airrecover (5210): player's defence is restored at time = 0





;---------------------------------------------------------------------------
; HIT_BOUNCE (hit ground)
[Statedef 5100]
type    = L
movetype= H
physics = N

[State 5000, 1]
type = ChangeAnim
trigger1 = time = 0
trigger1 = NumHelper(6969) = 1
value = 25100

[State 5100, 1]
type = VelSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x > 1
x = 1

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = NumHelper(6969) = 0
;triggerall = var(22) = 0
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = NumHelper(6969) = 0
;triggerall = var(22) = 0
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 2] ;Hit ground anim (normal)
type = null;ChangeAnim
triggerall = NumHelper(6969) = 0
triggerall = var(22) != 0
triggerall = time = 0
trigger1 = (anim != [15051,15059]) && (anim != [15061,15069])
trigger2 = !SelfAnimExist(15100 + (anim % 10))
value = 15100

[State 5100, 3] ;Hit ground anim (for hit up)
type = null;ChangeAnim
triggerall = NumHelper(6969) = 0
triggerall = var(22) != 0
trigger1 = time = 0
trigger1 = (anim = [15051,15059]) || (anim = [15061,15069])
trigger1 = SelfAnimExist(15100 + (anim % 10))
value = 15100 + (anim % 10)

[State 5100, 1]
type = width
trigger1 = time = 0
edge = 10,10

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5110 ;HIT_LIEDOWN

[State 5100, 8]
type = GameMakeAnim
trigger1 = Time = 1
value = 60 + (sysvar(1) > 5)
pos = 0, 0
under = sysvar(0) <= 5

[State 5100, Explod]
type = Explod
trigger1 = Time = 0
trigger1 = (sysvar(1) > 14)
anim = f62
pos = 0,0
postype = p1
removetime = -2
pausemove = 1
sprpriority = 9

[State 5100, Explod]
type = Explod
trigger1 = Time = 0
trigger1 = (sysvar(1) > 14)
anim = f63
pos = 0,0
postype = p1
removetime = -2
pausemove = 1
sprpriority = -9

[State 5100, KOFM]
type = EnvShake
trigger1 = Time = 0
trigger1 = (sysvar(1) > 14)
time = 25
freq = 210
ampl = 10

[State 1000, LifeAdd]
type = LifeAdd
trigger1 = (sysvar(1) > 14)
trigger1 = Timemod = 3,0
value = -25
kill = 1

[State 5100, 11]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 12]
type = PlaySnd
trigger1 = Time = 1
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
trigger2 = anim = 25100 && time = 5
value = 5101

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;==============================================================



;---------------------------------------------------------------------------
; Stand
[Statedef 0]
type = S
physics = S
sprpriority = 0

[State 0]
	type = ChangeAnim
	trigger1 = Anim != 0 && Anim != 5
	trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
	value = 0

[State 0]
	type = VelSet
	trigger1 = Time = 0
	y = 0

[State 0] ;Stop moving if low velocity or 4 ticks pass
	type = VelSet
	trigger1 = abs(vel x) < 2
	trigger2 = Time = 4
	x = 0



;--------------------------
; AI行動乱数
;--------------------------

[State 0] ;ダッシュ
	type = ChangeState
	triggerall = var(51) = 1 && Ctrl
	triggerall = sysvar(4)
	trigger1 = Random < 200 && P2Dist X > 300 && (ScreenPos X = [5,315])
	trigger2 = FrontEdgeBodyDist > 320
	value = 100

[State 0] ;後ダッシュ
	type = ChangeState
	triggerall = var(51) = 1 && Ctrl
	triggerall = sysvar(4)
	trigger1 = Random < 40 && P2Dist X < 200 && (ScreenPos X = [5,315])
	value = 105

[State 0] ;前進/後退
	type = ChangeState
	triggerall = var(51) = 1 && Ctrl
	triggerall = sysvar(4)
	trigger1 = Random < 200
	value = 21

; 通常ジャンプ
[State 0] 
	type = ChangeState
	triggerall = var(51) = 1 && Ctrl
	triggerall = sysvar(4)
	triggerall = (Pos Y < Enemy,Pos Y && ScreenPos Y > 0) || (Pos Y > Enemy,Pos Y && ScreenPos Y < 240)
	triggerall = Random < 100
	triggerall = NumEnemy

	trigger1 = Random < 600 && (Pos Y < Enemy,Pos Y) && (Pos Y < Enemy,Pos Y - 60)
	trigger2 = Random < 400 && (Pos Y < Enemy,Pos Y) && (Pos Y < Enemy,Pos Y - 100)
	trigger3 = Random < 200 && (Pos Y < Enemy,Pos Y) && (Pos Y < Enemy,Pos Y - 150)
	trigger4 = Random < 100 && (Pos Y < Enemy,Pos Y) && (Pos Y < Enemy,Pos Y - 200)

	trigger5 = Random < 600 && (Pos Y > Enemy,Pos Y) && (Pos Y < Enemy,Pos Y + 200)
	trigger6 = Random < 400 && (Pos Y > Enemy,Pos Y) && (Pos Y < Enemy,Pos Y + 150)
	trigger7 = Random < 200 && (Pos Y > Enemy,Pos Y) && (Pos Y < Enemy,Pos Y + 100)
	trigger8 = Random < 100 && (Pos Y > Enemy,Pos Y) && (Pos Y < Enemy,Pos Y + 60)
	value = 40

; AIジャンプ
[State 0]
	type = ChangeState
	value = 41
	triggerall = var(51) = 1 && Ctrl
	triggerall = sysvar(4)
	trigger1 = Random < 300
	trigger1 = P2BodyDist X = [80,120]
	trigger1 = Enemy, NumProj >= 1

; 中・小跳躍
[State ai_6]
	type = ChangeState
	value = Ifelse(P2BodyDist X < 80, 40, 43)
	triggerall = var(51) = 1 && Ctrl
	triggerall = sysvar(4)
	trigger1 = Random < 55 && Random < Life*2
	trigger1 = BackEdgebodyDist > 5
	trigger1 = P2BodyDist X < 100 && P2StateType = C


[State 0] ;しゃがむ
	type = ChangeState
	triggerall = var(51) = 1 && Ctrl
	triggerall = sysvar(4)
	triggerall = (Pos Y < Enemy,Pos Y && ScreenPos Y > 0) || (Pos Y > Enemy,Pos Y && ScreenPos Y < 240)
	triggerall = Random < 100
	triggerall = NumEnemy

	trigger1 = Random < 600 && (Pos Y < Enemy,Pos Y) && (Pos Y < Enemy,Pos Y - 200)
	trigger2 = Random < 500 && (Pos Y < Enemy,Pos Y) && (Pos Y < Enemy,Pos Y - 150)
	trigger3 = Random < 400 && (Pos Y < Enemy,Pos Y) && (Pos Y < Enemy,Pos Y - 100)
	trigger4 = Random < 300 && (Pos Y < Enemy,Pos Y) && (Pos Y < Enemy,Pos Y - 60)

	trigger5 = Random < 600 && (Pos Y > Enemy,Pos Y) && (Pos Y < Enemy,Pos Y + 60)
	trigger6 = Random < 500 && (Pos Y > Enemy,Pos Y) && (Pos Y < Enemy,Pos Y + 100)
	trigger7 = Random < 400 && (Pos Y > Enemy,Pos Y) && (Pos Y < Enemy,Pos Y + 150)
	trigger8 = Random < 300 && (Pos Y > Enemy,Pos Y) && (Pos Y < Enemy,Pos Y + 200)

	value = 10
	ctrl = 0


;--------

;------------------------------







;---------------------------------------------------------------------------
; Stand to Crouch
[Statedef 10]
type = C
physics = C
anim = 10

[State 0]
	type = VelMul
	trigger1 = Time = 0
	x = .75

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 11


;---------------------------------------------------------------------------
; Crouching
[Statedef 11]
type = C
physics = C
anim = 11
sprpriority = 0

[State 0] ;Change from turning animation
	type = ChangeAnim
	trigger1 = Anim = 6 && AnimTime = 0
	value = 11

[State 0]
	type = CtrlSet
	trigger1 = var(51) = 1 && !Ctrl
	trigger1 = time > 20
	value = 1

;---------------------------------------------------------------------------
; Crouch to Stand
[Statedef 12]
type = S
physics = S
anim = 12

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 0


;---------------------------------------------------------------------------
; Walk
[Statedef 20]
type = S
physics = S
sprpriority = 0

[State 0]
	type = VelSet
	trigger1 = command = "holdfwd"
	x = const(velocity.walk.fwd.x)
[State 0]
	type = VelSet
	trigger1 = command = "holdback"
	x = const(velocity.walk.back.x)

[State 0]
	type = ChangeAnim
	triggerall = vel x > 0
	trigger1 = Anim != 20 && Anim != 5
	trigger2 = Anim = 5 && AnimTime = 0
	value = 20

[State 0]
	type = ChangeAnim
	triggerall = vel x < 0
	trigger1 = Anim != 21 && Anim != 5
	trigger2 = Anim = 5 && AnimTime = 0
	value = 21


;---------------------------------------------------------------------------
; AI. Walk
[Statedef 21]
type = S
physics = S
sprpriority = 0
ctrl = 0

[State 0] ;AI 前進
	type = VelSet
	triggerall = vel x >= 0
	trigger1 = Random < 600 && P2Dist X > 60
	trigger2 = Random < 500 && P2Dist X > 120
	trigger3 = Random < 400 && P2Dist X > 160
	trigger4 = Random < 300 && P2Dist X > 180
	x = const(velocity.walk.fwd.x)
[State 0] ;AI 後退
	type = VelSet
	triggerall = vel x <= 0
	trigger1 = Random < 600 && P2Dist X < 60
	trigger2 = Random < 500 && P2Dist X < 120
	trigger3 = Random < 400 && P2Dist X < 160
	trigger4 = Random < 300 && P2Dist X < 180
	x = const(velocity.walk.back.x)

[State 0] ;turn AIs ctrl on
	type = CtrlSet
	triggerall = time > 0
	trigger1 = RoundState != 2

	trigger2 = vel x > 0 && Random < 80 && P2Dist X > 60
	trigger3 = vel x > 0 && Random < 60 && P2Dist X > 120
	trigger4 = vel x > 0 && Random < 40 && P2Dist X > 160
	trigger5 = vel x > 0 && Random < 20 && P2Dist X > 180

	trigger6 = vel x < 0 && Random < 80 && P2Dist X < 60
	trigger7 = vel x < 0 && Random < 60 && P2Dist X < 120
	trigger8 = vel x < 0 && Random < 40 && P2Dist X < 160
	trigger9 = vel x < 0 && Random < 20 && P2Dist X < 180

	value = 1


;----------
[State 0]
	type = ChangeAnim
	triggerall = vel x > 0
	trigger1 = Anim != 20 && Anim != 5
	trigger2 = Anim = 5 && AnimTime = 0
	value = 20
[State 0]
	type = ChangeAnim
	triggerall = vel x < 0
	trigger1 = Anim != 21 && Anim != 5
	trigger2 = Anim = 5 && AnimTime = 0
	value = 21

[State 0]
	type = ChangeState
	trigger1 = ctrl
	trigger2 = RoundState != 2
	value = 0
	ctrl = 1





;---------------------------------------------------------------------------
; Jump Start
;--------------------------------------------------------------
;ジャンプシステム
;使用変数 sysfvar(1): [0:般 / 1:大 / 2:小 / 3:中]
;0:normal / 1:long / 2:small / 3:middle
;--------------------------------------------------------------

[Statedef 40]   ; Jump Start
type = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1

;----------------
;横方向
[State 0]
	type = VarSet
	trigger1 = Time = 0
	sysvar(1) = Ifelse(command = "holdfwd", 1 , Ifelse(command="holdback", -1, 0))

;----------------
;【ジャンプの種類】

;ノーマルジャンプ
[State 0]
	type = VarSet
	trigger1 = Time = 0
	sysfvar(1) = 0 

;大ジャンプ
[State 0]
	type = VarSet
	triggerall = Time = 0
	trigger1 = PrevStateNo = 100
	trigger2 = NumHelper(90900)
	trigger2 = Helper(90900),var(44) > 0 ;; << jump type
	trigger3 = NumHelper(90901)
	trigger3 = Helper(90901),var(44) > 0 ;; << jump type
	trigger4 = NumHelper(90902)
	trigger4 = Helper(90902),var(44) > 0 ;; << jump type
	sysfvar(1) = 1

;小ジャンプ
[State 0]
	type = VarSet
	triggerall = command != "holdup"
	trigger1 = sysfvar(1) = 0
;--;	trigger1 = sysvar(4) != 2 ;タイプ別
	sysfvar(1) = 2

;中ジャンプ
[State 0]
	type = VarSet
	triggerall = command != "holdup"
	trigger1 = sysfvar(1) = 1
;--;	trigger1 = sysvar(4) != 2 ;タイプ別
	sysfvar(1) = 3

;----------------
;【横移動距離も設定】
;ノーマル/小
[State 0]
	type = VelSet
	trigger1 = AnimTime = 0
	trigger1 = sysfvar(1) = 0 || sysfvar(1) = 2
	x = Ifelse(sysvar(1) = 0, Const(velocity.jump.neu.x), Ifelse(sysvar(1) = 1, Const(velocity.jump.fwd.x), Const(velocity.jump.back.x)))

;中/大
[State 0]
	type = VelSet
	trigger1 = AnimTime = 0
	trigger1 = sysfvar(1) = 1 || sysfvar(1) = 3
	x = Ifelse(sysvar(1) = 0, 0, Ifelse(sysvar(1) = 1, Const(velocity.runjump.fwd.x), Const(velocity.runjump.back.x)))

;----------------
;【高さの設定】

;ノーマル
[State 0]
	type = VelSet
	trigger1 = AnimTime = 0
	y = Const(velocity.jump.y)

;大
[State 0]
	type = VelSet
	trigger1 = AnimTime = 0 && sysfvar(1) = 1
	trigger1 = sysfvar(1) = 1 || sysfvar(1) = 3
	y = Const(velocity.runjump.y)

;小/中
[State 0]
	type = VelSet
	trigger1 = AnimTime = 0 && sysfvar(1) >= 2
	y = - Const(movement.yaccel) / 0.50 * 6.66

	;*中小ジャンプの高さ参照
	;	(1): Const(movement.yaccel) / 0.50 * 6.64
	;	(2): Const(velocity.runjump.y) / 1.41


[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 50
	ctrl = 1


;--------------------------------------------------------------
;AI専用ジャンプ *種類分け、方向指定なし
; for AI jumping only
; StatedefNo [N:41][L:42][M:43][S:40(def)][SP:44]
;--------------------------------------------------------------
[Statedef 41] ; ノーマル
type = S
physics = S
anim = 40
ctrl = 0

[State 0] 
	type = VarSet
	trigger1 = time = 0
	sysfvar(1) = 0

[State 0]
	type = VelSet
	trigger1 = AnimTime = 0
	x = ifelse(sysvar(1) = 0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
	y = const(velocity.jump.y)

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 50
	ctrl = 1

;-----------------------------
[Statedef 42] ;大ジャンプ (long)
type = S
physics = S
anim = 40
ctrl = 0

[State 0]
	type = VarSet
	trigger1 = time = 0
	sysfvar(1) = 1 

[State 0]
	type = VelSet
	trigger1 = AnimTime = 0
	x = ifelse(sysvar(1)=0, 0, ifelse(sysvar(1)=1, const(velocity.runjump.fwd.x), const(velocity.runjump.back.x)))
	y = const(velocity.runjump.y)

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 50
	ctrl = 1

;-----------------------------
[Statedef 43] ;中ジャンプ (middle)
type = S
physics = S
anim = 40
ctrl = 0

[State 0]
	type = VarSet
	trigger1 = time = 0
	sysfvar(1) = Ifelse(sysvar(4) != 2, 3, 0)

[State 0]
	type = VelSet
	trigger1 = AnimTime = 0
	x = ifelse(sysvar(1)=0, 0, ifelse(sysvar(1)=1, const(velocity.runjump.fwd.x), const(velocity.runjump.back.x)))
	y = Ifelse(sysfvar(1) = 3, - Const(movement.yaccel) / 0.50 * 6.66, const(velocity.jump.y))

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 50
	ctrl = 1



;--------------------------------------------------------------

;--------------------------------------------------------------
; AirJump Start (No AirJump)
[Statedef 45]
type = A
physics = N
ctrl = 0
velset = 0,0

[State 0]
	type = ChangeAnim
	trigger1 = SelfAnimExist(44)
	value = 44

[State 0]
	type = ChangeAnim
	trigger1 = !SelfAnimExist(44)
	value = 41

[State 0]
	type = VarSet
	trigger1 = Time = 0
	sysvar(1) = 0

[State 0]
	type = VarSet
	trigger1 = command = "holdfwd"
	sysvar(1) = 1

[State 0]
	type = VarSet
	trigger1 = command = "holdback"
	sysvar(1) = -1

[State 0]
	type = VelSet
	trigger1 = Time = 2
	x = ifelse(sysvar(1)=0, const(velocity.airjump.neu.x), ifelse(sysvar(1)=1, const(velocity.airjump.fwd.x), const(velocity.airjump.back.x)))
	y = const(velocity.airjump.y)

[State 0]
	type = ChangeState
	trigger1 = Time = 2
	value = 50
	ctrl = 1


;--------------------------------------------------------------
;超低ジャンプ → リープアタック
;low jump > leap attack
;--------------------------------------------------------------
[Statedef 48]   ; Jump Start
type = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1
velset = 0, 0

[State 0]
	type = VelSet
	trigger1 = AnimTime = 0
	x = Ifelse(command = "holdfwd", 2 , Ifelse(command="holdback", -2, 0))
	y = - Const(movement.yaccel) / 0.50 * 6.24

	;*高さ参照
	;	(1): Const(movement.yaccel) / 0.50 * 6.24
	;	(2): Const(velocity.runjump.y) / 1.25

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 58
	ctrl = 0




;--------------------------------------------------------------

;--------------------------------------------------------------
; Jump Up
[Statedef 50]
type = A
physics = A

[State 50, 0]
	type = PlaySnd
	trigger1 = Time = 0
	value = F50, 0
	channel = 1

;-----------------------
[State 50, 1]
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = sysfvar(1) < 2  ;N,Lジャンプ
	value = ifelse((vel x)=0, 41, ifelse((vel x)>0, 42, 43))

[State 50, 2]
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = sysfvar(1)>=2  ;M,Sジャンプ
	value = 41

[State 50, 3];落下アニメがあれば...
	type = ChangeAnim
	trigger1 = Vel y > -2
	trigger1 = SelfAnimExist(anim + 3)
	persistent = 0
	value = Anim + 3

[State 50, 4]
	type = AfterImage
	trigger1 = Time = 0
	trigger1 = sysfvar(1)=1 || sysfvar(1)=3  ;中大ジャンプの残像
	time = 25
	length = 9
	FrameGap = 3
	PalBright = 1,1,1
	PalContrast = 128,128,128
	PalAdd = 0,0,0
	PalMul = 1,1,1
	trans = add1


;--------------------------------------------------------------
; Jump Down (empty State for compatibility)
[Statedef 51]
type = A
physics = A

[State 51, 1]
	type = Null
	trigger1 = 1


;--------------------------------------------------------------
; Jump Land
[Statedef 52]
type = S
physics = S
ctrl = 0
anim = 47

[State 0]
	type = VelSet
	trigger1 = Time = 0
	x = 0
	y = 0

[State 0]
	type = PosSet
	trigger1 = Time = 0
	y = 0

[State 0, jump land]
	type = Helper
	trigger1 = Time = 0
	ID = 152000
	Stateno = 152000

[State 0]
	type = CtrlSet
	trigger1 = Time = 3
	value = 1

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 0
	ctrl = 1




;--------------------------------------------------------------
; Jump Up
[Statedef 58]
type = A
physics = A
anim = 41

[State 0]
	type = PlaySnd
	trigger1 = Time = 0
	value = F50, 0
	channel = 1

[State 0]
	type = ChangeAnim
	trigger1 = Vel y > -2
	trigger1 = SelfAnimExist(anim + 3)
	persistent = 0
	value = Anim + 3






;--------------------------------------------------------------

;--------------------------------------------------------------
; RUN_FWD
[Statedef 100]
type = S
physics = S
anim = 100
sprpriority = 1

;-------- (AI)
[State 0]
	type = SelfState
	trigger1 = var(51) = 1 && time = 0 && RoundState = 2
	value = 101

[State 0];足音(一回)
	type = PlaySnd
	trigger1 = AnimElemTime(3) = 0 || AnimElemTime(6) = 0
	value = F100, 0
	channel = 20

[State 0]
	type = VelSet
	trigger1 = 1
	x = const(velocity.run.fwd.x)

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = NoWalk

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = NoAutoTurn

[State 0]
	type = ChangeState
	trigger1 = var(51) != 1
	trigger1 = command != "holdfwd"
	value = 0


;--------------------------------------------------------------
;AI. RUN_FWD

[Statedef 101]
type = S
physics = S
anim = 100
sprpriority = 1
ctrl = 0

[State 0];足音(一回)
	type = PlaySnd
	trigger1 = AnimElemTime(3) = 0 || AnimElemTime(6) = 0
	value = F100, 0
	channel = 20

[State 0]
	type = VelSet
	trigger1 = 1
	x = const(velocity.run.fwd.x)
[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = NoWalk
[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = NoAutoTurn

[State 0]
	type = CtrlSet
	triggerall = time > 2
	triggerall = FrontEdgeBodyDist < 320
	trigger1 = Random < 100 && P2Dist X < 50
	trigger2 = Random < 50 && P2Dist X < 100
	trigger3 = Random < 20 && P2Dist X < 150
	trigger4 = Random < 10 && P2Dist X < 200
	trigger5 = ScreenPos X != [0,320]
	value = 1

[State 0]
	type = ChangeState
	trigger1 = ctrl
	trigger2 = RoundState != 2
	value = 0
	ctrl = 1






;--------------------------------------------------------------
; RUN_BACK
[Statedef 105]
type = A
physics = A
ctrl = 0
anim = 105
sprpriority = 1

[State 0]
	type = VelSet
	trigger1 = Time = 0
	x = const(velocity.run.back.x)
	y = const(velocity.run.back.y)

[State 0]
	type = PlaySnd
	trigger1 = Time = 0
	value = F50, 0
	channel = 1

;[State 0]
;	type = CtrlSet
;	trigger1 = Time = 2
;	value = 1

[State 0] ;バックステップの場合
	type = ChangeState
	trigger1 = Vel Y > 0
	trigger1 = Pos Y >= 0
	value = 52 ;106 ;着地


;--------------------------------------------------------------
; RUN_BACK2 (land) 52とほとんど同じなので省略...???
[Statedef 106]
type = S
physics = S
ctrl = 0
anim = 47

[State 106, 1]
	type = VelSet
	trigger1 = Time = 0
	y = 0

[State 106, 2]
	type = PosSet
	trigger1 = Time = 0
	y = 0

[State 106, 3]
	type = MakeDust
	trigger1 = Time = 2
	pos = -5,-2
	spacing = 1

[State 106, 4]
	type = ChangeState
	trigger1 = Time = 7
	value = 0
	ctrl = 1



;---------------------------------------------------------------------------
; RUN_UP

[Statedef 110]
type = S
physics = N
ctrl = 0

[State 0]
	type = ChangeAnim
	trigger1 = Time = 0
	value = 110

[State 0]
	type = HitBy
	trigger1 = Time = 0
	value = SCA, NT, ST, HT
	time = 30

[State 0]
	type = VelSet
	trigger1 = Time = 0
	x = 0
	z = -7

[State 0]
	type = VelMul
	trigger1 = 1
	z = 0.8

[State 0]
	type = VelSet
	trigger1 = AnimTime = -8
	z = 0

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 0
	ctrl = 1

;---------------------------------------------------------------------------
; RUN_DOWN
[Statedef 115]
type = S
physics = N
ctrl = 0

[State 0]
	type = ChangeAnim
	trigger1 = Time = 0
	value = 110

[State 0]
	type = HitBy
	trigger1 = Time = 0
	value = SCA, NT, ST, HT
	time = 30

[State 0]
	type = VelSet
	trigger1 = Time = 0
	x = 0
	z = 7

[State 0]
	type = VelMul
	trigger1 = 1
	z = 0.8

[State 0]
	type = VelSet
	trigger1 = AnimTime = -8
	z = 0

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 0
	ctrl = 1








;---------------------------------------------------------------------------
; GUARD (start)
[Statedef 120]
type = U    ;Leave State type unchanged
physics = U ;Leave physics unchanged

[State 0]
	type = ChangeAnim
	trigger1 = Time = 0
	value = 120 + (Statetype = C) + (Statetype = A) * 2

[State 0]
	type = StateTypeSet
	trigger1 = Time = 0 && Statetype = S
	physics = S

[State 0]
	type = StateTypeSet
	trigger1 = Time = 0 && Statetype = C
	physics = C

[State 0]
	type = StateTypeSet
	trigger1 = Time = 0 && Statetype = A
	physics = A

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = S && command = "holddown"
	Statetype = C
	physics = C

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = C && command != "holddown"
	Statetype = S
	physics = S

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 130 + (Statetype = C) + (Statetype = A)*2

[State 0]
	type = ChangeState
	trigger1 = command != "holdback"
	trigger2 = !inguarddist
	value = 140

;---------------------------------------------------------------------------
; STAND GUARD (guarding)
[Statedef 130]
type    = S
physics = S

[State 0]
	type = ChangeAnim
	trigger1 = Anim != 130
	value = 130

[State 0]
	type = ChangeState
	trigger1 = command = "holddown"
	value = 131

[State 0]
	type = ChangeState
	trigger1 = command != "holdback"
	trigger2 = !inguarddist
	value = 140

;---------------------------------------------------------------------------
; CROUCH GUARD (guarding)
[Statedef 131]
type    = C
physics = C

[State 0]
	type = ChangeAnim
	trigger1 = Anim != 131
	value = 131

[State 0]
	type = ChangeState
	trigger1 = command != "holddown"
	value = 130

[State 0]
	type = ChangeState
	trigger1 = command != "holdback"
	trigger2 = !inguarddist
	value = 140

;---------------------------------------------------------------------------
; AIR GUARD (guarding)
[Statedef 132]
type    = A
physics = N

[State 0]
	type = ChangeAnim
	trigger1 = Anim != 132
	value = 132

[State 0]
	type = VelAdd
	trigger1 = 1
	y = Const(movement.yaccel)

[State 0]
	type = VarSet
	trigger1 = 1
	sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 0]
	type = VelSet
	trigger1 = sysvar(0)
	y = 0

[State 0]
	type = PosSet
	trigger1 = sysvar(0)
	y = 0

[State 0]
	type = ChangeState
	trigger1 = sysvar(0)
	trigger1 = command = "holdback"
	trigger1 = inguarddist
	value = 130

[State 0]
	type = ChangeState
	trigger1 = sysvar(0)
	value = 52

[State 0]
	type = ChangeState
	trigger1 = command != "holdback"
	trigger2 = !inguarddist
	value = 140

;---------------------------------------------------------------------------
; GUARD (end)
[Statedef 140]
type = U    ;Leave State type unchanged
physics = U ;Leave physics unchanged
ctrl = 1

[State 0]
	type = ChangeAnim
	trigger1 = Time = 0
	value = 140 + (Statetype = C) + (Statetype = A) * 2

[State 0]
	type = StateTypeSet
	trigger1 = Time = 0 && Statetype = S
	physics = S

[State 0]
	type = StateTypeSet
	trigger1 = Time = 0 && Statetype = C
	physics = C

[State 0]
	type = StateTypeSet
	trigger1 = Time = 0 && Statetype = A
	physics = A

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = S && command = "holddown"
	Statetype = C
	physics = C

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = C && command != "holddown"
	Statetype = S
	physics = S

;[State 140, 5] ;Implemented within engine
;type = ChangeState
;trigger1 = AnimTime = 0
;value = (Statetype = C)*11 + (Statetype = A)*51

;---------------------------------------------------------------------------
; STAND GUARD HIT (shaking/get hit)
[Statedef 150]
type = S
movetype = H
physics = N
velset = 0,0

[State 0]
	type = ChangeAnim
	trigger1 = 1
	value = 150

[State 0]
	type = ChangeState
	trigger1 = HitShakeOver
	value = 151 + 2 * (command = "holddown")

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = S && command = "holddown"
	Statetype = C
	physics = C

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = C && command != "holddown"
	Statetype = S
	physics = S

[State 0]
	type = ForceFeedback
	trigger1 = time = 0
	waveform = square
	time = 3


;options
;-------------------------------------
;ガードクラッシュ   (GUARD CRUSH)
;-------------------------------------

; ガードクラッシュ(前警告)
[State 0]
	type = PalFx
	triggerall = GameTime%10 = 1
	trigger1 = NumHelper(90900)
	trigger1 = Helper(90900),var(36) >= 40
	trigger2 = NumHelper(90901)
	trigger2 = Helper(90901),var(36) >= 40
	trigger3 = NumHelper(90902)
	trigger3 = Helper(90902),var(36) >= 40
	time = 2
	add = 200, 0, 0

; ガードクラッシュ!!!
[State 0]
	type = ChangeState
	triggerall = Alive
	trigger1 = NumHelper(90900)
	trigger1 = Helper(90900), var(36) >= 50
	trigger2 = NumHelper(90901)
	trigger2 = Helper(90901), var(36) >= 50
	trigger3 = NumHelper(90902)
	trigger3 = Helper(90902), var(36) >= 50
	IgnoreHitPause = 1
	value = 190010

;---------------------------------------------------------------------------
; SGUARDHIT2 (knocked back)
[Statedef 151]
type = S
movetype = H
physics = S
anim = 150

[State 0]
	type = HitVelSet
	trigger1 = Time = 0
	x = 1

[State 0]
	type = VelSet
	trigger1 = Time = GetHitVar(slidetime)
	trigger2 = HitOver
	x = 0

[State 0]
	type = VelSet
	trigger1 = NumExplod(1196150)
	x = 0

[State 0]
	type = CtrlSet
	trigger1 = Time >= GetHitVar(CtrlTime) * Ifelse(NumExplod(1196150), 0.50, 1)
	value = 1

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = S && command = "holddown"
	Statetype = C
	physics = C

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = C && command != "holddown"
	Statetype = S
	physics = S

[State 0]
	type = ChangeState
	trigger1 = HitOver
	value = 130
	ctrl = 1


;---------------------------------------------------------------------------
; C GUARD HIT (shaking)
[Statedef 152]
type = C
movetype = H
physics = N
velset = 0,0

[State 0]
	type = ChangeAnim
	trigger1 = 1
	value = 151

[State 0]
	type = ChangeState
	trigger1 = HitShakeOver
	value = 151 + 2*(command = "holddown")

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = S && command = "holddown"
	Statetype = C
	physics = C

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = C && command != "holddown"
	Statetype = S
	physics = S

[State 0]
	type = ForceFeedback
	trigger1 = time = 0
	waveform = square
	time = 4


;options
;-------------------------------------
;ガードクラッシュ   (GUARD CRUSH)
;-------------------------------------

; ガードクラッシュ(前警告)
[State 0]
	type = PalFx
	triggerall = GameTime%10 = 1
	trigger1 = NumHelper(90900)
	trigger1 = Helper(90900),var(36) >= 40
	trigger2 = NumHelper(90901)
	trigger2 = Helper(90901),var(36) >= 40
	trigger3 = NumHelper(90902)
	trigger3 = Helper(90902),var(36) >= 40
	time = 2
	add = 200, 0, 0

; ガードクラッシュ!!!
[State 0]
	type = ChangeState
	triggerall = Alive
	trigger1 = NumHelper(90900)
	trigger1 = Helper(90900), var(36) >= 50
	trigger2 = NumHelper(90901)
	trigger2 = Helper(90901), var(36) >= 50
	trigger3 = NumHelper(90902)
	trigger3 = Helper(90902), var(36) >= 50
	IgnoreHitPause = 1
	value = 190010



;---------------------------------------------------------------------------
; CGUARDHIT2 (knocked back)
[Statedef 153]
type = C
movetype = H
physics = C
anim = 151

[State 0]
	type = HitVelSet
	trigger1 = Time = 0
	x = 1

[State 0]
	type = VelSet
	trigger1 = Time = GetHitVar(slidetime)
	trigger2 = HitOver
	x = 0

[State 0]
	type = CtrlSet
	trigger1 = Time >= GetHitVar(CtrlTime)
	value = 1

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = S && command = "holddown"
	Statetype = C
	physics = C

[State 0]
	type = StateTypeSet
	trigger1 = Statetype = C && command != "holddown"
	Statetype = S
	physics = S

[State 0]
	type = ChangeState
	trigger1 = HitOver
	value = 131
	ctrl = 1


;---------------------------------------------------------------------------
; AGUARDHIT (shaking)
[Statedef 154]
type = A
movetype = H
physics = N
velset = 0,0

[State 0]
	type = ChangeAnim
	trigger1 = 1
	value = 152

[State 0]
	type = ChangeState
	trigger1 = HitShakeOver
	value = 155 ;AGUARDHIT2

[State 0]
	type = ForceFeedback
	trigger1 = time = 0
	waveform = square
	time = 4





;---------------------------------------------------------------------------
; AGUARDHIT2 (knocked away)
[Statedef 155]
type = A
movetype = H
physics = N
anim = 152

[State 0]
	type = HitVelSet
	trigger1 = Time = 0
	x = 1
	y = 1

[State 0]
	type = VelAdd
	trigger1 = !NumExplod(1196150)
	y = Const(movement.yaccel)

[State 0]
	type = NotHitBy
	trigger1 = NumExplod(1196150)
	value = SCA

[State 0]
	type = velset
	trigger1 = NumExplod(1196150)
	trigger1 = Time >= GetHitVar(CtrlTime) * 0.5
	x = -2
	y = -4

[State 0]
	type = PosFreeze
	trigger1 = NumExplod(1196150)
	trigger1 = Time <= GetHitVar(CtrlTime) * 0.5

[State 0]
	type = ChangeState
	trigger1 = NumExplod(1196150)
	trigger1 = Time >= GetHitVar(CtrlTime) * 0.5
	value = 140
	IgnoreHitPause = 1

[State 0]
	type = CtrlSet
	trigger1 = Time >= GetHitVar(CtrlTime)
	value = 1

[State 0]
	type = VarSet
	trigger1 = 1
	sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 0]
	type = VelSet
	trigger1 = sysvar(0)
	y = 0

[State 0]
	type = PosSet
	trigger1 = sysvar(0)
	y = 0

[State 0]
	type = ChangeState
	trigger1 = sysvar(0)
	trigger1 = command = "holdback"
	trigger1 = inguarddist
	value = 130

[State 0]
	type = ChangeState
	trigger1 = sysvar(0)
	value = 52



;---------------------------------------------------------------------------
; LOSE (Time over)
[Statedef 170]
type = S
ctrl = 0
anim = Ifelse(SelfAnimExist(170), 170, 175)
velset = 0,0

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	time = 1

;---------------------------------------------------------------------------
; DRAWGAME (Time over)
[Statedef 175]
type = S
ctrl = 0
velset = 0,0

[State 0]
	type = ChangeState
	trigger1 = Time = 0
	trigger1 = !SelfAnimExist(175)
	value = 170

[State 0]
	type = ChangeAnim
	trigger1 = Time = 0
	value = 175

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	time = 1

;---------------------------------------------------------------------------
; PREINTRO
[Statedef 190]
type = S
ctrl = 0
velset = 0,0

[State 190, 1]
type = ChangeAnim
trigger1 = SelfAnimExist(190)
value = 190

[State 190, 2] ;Go straight to intro.
type = ChangeState
trigger1 = Time = 0
value = 191

;---------------------------------------------------------------------------
; INTRO (override this State to give character an intro)
[Statedef 191]
type = S
ctrl = 0

[State 191, 1]
type = ChangeState
trigger1 = Time = 0
value = 0










;---------------------------------------------------------------------------
; HITG_SHAKE
;---------------------------------------------------------------------------

[Statedef 5000]
type = S
movetype = H
physics = N
velset = 0, 0

[State 0] ;Anim for HIT_LIGHT to HIT_HARD
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = GetHitVar(animtype) != [3,5]
	value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 0] ;Anim for HIT_BACK
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = GetHitVar(animtype) = [3,5]
	value = 5030

[State 0] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
	value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 0] ;Freeze anim
	type = ChangeAnim
	trigger1 = Time > 0
	value = anim

[State 0] ;State type gets set to aerial if getting hit up
	type = StateTypeSet
	trigger1 = Time = 0
	trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
	trigger2 = Pos Y != 0
	Statetype = a

[State 0]
	type = ChangeState
	trigger1 = HitShakeOver
	trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
	value = 5001 ;HITG_SLIDE

[State 0]
	type = ChangeState
	trigger1 = HitShakeOver
	value = 5030

[State 5000, FFB Light]
	type = ForceFeedback
	trigger1 = anim = 5000
	trigger2 = anim = 5010
	persistent = 0
	time = 6
	waveform = square

[State 5000, FFB Medium]
	type = ForceFeedback
	trigger1 = anim = 5001
	trigger2 = anim = 5011
	persistent = 0
	time = 8
	waveform = sinesquare
	ampl = 110,-1,-.3

[State 5000, FFB Hard]
	type = ForceFeedback
	trigger1 = anim = 5012
	trigger2 = anim = 5002
	trigger3 = anim = 5030
	persistent = 0
	time = 15
	waveform = sinesquare
	ampl = 140

;----------------
; 画面振動
[State 0]
	Type = EnvShake
	trigger1 = time = 0
	time = 3
	freq = 90 ;; << shake_speed (0-180)
	ampl = Ifelse((Enemy,HitDefAttr=SCA,HA,HP,HT), 3, Ifelse((Enemy,HitDefAttr=SCA,NA,NP,NT), 0, 2))
	phase = 4 ;; << phase_offset

;----------------
;;[State 0] 
;;	type = Helper
;;	triggerall = time = 0
;;	trigger1 = !IsHelper
;;	stateno = 50999

;---------------------------------
; 模擬画面揺れ（失敗(^^;）
;---------------------------------
[Statedef 50999]
type = S
physics = S

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	time = 1
;[State 0]
;	type = AssertSpecial
;	trigger1 = 1
;	flag = invisible

; 画面振動を押さえる
[State 0]
	Type = EnvShake
	trigger1 = 1
	time = 1
;;	freq = 90 ;; shake_speed (0-180)
	ampl = 0;2
;;	phase = 4 ;phase_offset
;op;	ampl = Ifelse((Enemy,HitDefAttr=SCA,HA,HP,HT), 3, Ifelse((Enemy,HitDefAttr=SCA,SA,SP,ST), 2, 0))

; カメラを追わせる
[State 0]
	Type = ScreenBound
	trigger1 = time = 0
;;	value = 1
	movecamera = 1, 1

[State 0]
	Type = posset
	trigger1 = 1
;-;	x = Root,Pos X + Ifelse(time = 0, -320, 320)
	y = Root,Pos Y + Ifelse(time = 0, -260, 0)

[State 0]
	type = DestroySelf
	trigger1 = time > 0














;---------------------------------------------------------------------------
; HITG_SLIDE
[Statedef 5001]
type    = S
movetype= H
physics = S

[State 5001, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5001, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5005 + GetHitVar(animtype) + (GetHitVar(groundtype)=2)*10

[State 5001, 3] ;Stop sliding back
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 5001, 4]
type = VelSet
trigger1 = HitOver
x = 0

;[State 0]
;	type = DefenceMulSet
;	trigger1 = HitOver
;	value = 1

[State 5001, 6]
type = ChangeState
trigger1 = HitOver
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HITC_SHAKE
[Statedef 5010]
type = C
movetype = H
physics = N
velset = 0,0

[State 0] ;Anim for HIT_LIGHT to HIT_HARD
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = GetHitVar(animtype) != [3,5]
	value = 5020 + GetHitVar(animtype)

[State 0] ;Anim for HIT_BACK
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = GetHitVar(animtype) = [3,5]
	value = 5030

[State 0] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
	value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 0] ;Freeze anim
	type = ChangeAnim
	trigger1 = Time > 0
	value = anim

[State 0] ;State type gets set to aerial if getting hit up
	type = StateTypeSet
	triggerall = Time = 0
	trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
	trigger2 = Pos Y != 0
	Statetype = a

[State 0]
	type = ChangeState
	trigger1 = HitShakeOver
	trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
	value = 5011 ;HITC_SLIDE

[State 0]
	type = ChangeState
	trigger1 = HitShakeOver
	value = 5030

[State 5010, FFB Light]
	type = ForceFeedback
	trigger1 = anim = 5020
	persistent = 0
	time = 6
	waveform = square

[State 5010, FFB Medium]
	type = ForceFeedback
	trigger1 = anim = 5021
	persistent = 0
	time = 8
	waveform = sinesquare
	ampl = 110,-1,-.3

[State 5010, FFB Hard]
	type = ForceFeedback
	trigger1 = anim = 5022
	persistent = 0
	time = 15
	waveform = sinesquare
	ampl = 140

;----------------
;----------------
; 画面振動
[State 0]
	Type = EnvShake
	trigger1 = time = 0
	time = 3
	freq = 90 ;; << shake_speed (0-180)
	ampl = Ifelse((Enemy,HitDefAttr=SCA,HA,HP,HT), 3, Ifelse((Enemy,HitDefAttr=SCA,NA,NP,NT), 0, 2))
	phase = 4 ;; << phase_offset

;---------------------------------------------------------------------------
; HITC_SLIDE
[Statedef 5011]
type    = C
movetype= H
physics = C

[State 5011, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5011, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5025 + GetHitVar(animtype)

[State 5011, 3] ;Stop sliding back
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 5011, 4]
type = VelSet
trigger1 = HitOver
x = 0

;[State 0]
;	type = DefenceMulSet
;	trigger1 = HitOver
;	value = 1

[State 5011, 6]
type = ChangeState
trigger1 = HitOver
value = 11
ctrl = 1


;---------------------------------------------------------------------------
; HITA_SHAKE
[Statedef 5020]
type = A
movetype = H
physics = N
velset = 0,0

[State 0] ;Anim for HIT_LIGHT to HIT_HARD
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = GetHitVar(animtype) != [3,5]
	value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 0] ;Anim for HIT_BACK
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = GetHitVar(animtype) = [3,5]
	value = 5030

[State 0] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
	value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 0]
	type = ChangeAnim
	trigger1 = Time > 0
	value = anim

[State 0]
	type = ChangeState
	trigger1 = HitShakeOver
	value = 5030

[State 5020, FFB Light]
	type = ForceFeedback
	trigger1 = anim = 5000
	trigger2 = anim = 5010
	persistent = 0
	time = 6
	waveform = square

[State 5020, FFB Medium]
	type = ForceFeedback
	trigger1 = anim = 5001
	trigger2 = anim = 5011
	persistent = 0
	time = 8
	waveform = sinesquare
	ampl = 110,-1,-.3

[State 5020, FFB Hard]
	type = ForceFeedback
	trigger1 = anim = 5012
	trigger2 = anim = 5002
	trigger3 = anim = 5030
	trigger4 = anim = [5051,5059]
	persistent = 0
	time = 15
	waveform = sinesquare
	ampl = 140

;----------------
; 画面振動
[State 0]
	Type = EnvShake
	trigger1 = time = 0
	time = 3
	freq = 90 ;; << shake_speed (0-180)
	ampl = Ifelse((Enemy,HitDefAttr=SCA,HA,HP,HT), 3, Ifelse((Enemy,HitDefAttr=SCA,NA,NP,NT), 0, 2))
	phase = 4 ;; << phase_offset

;---------------------------------------------------------------------------
; HITA_UP (initial going up)
[Statedef 5030]
type    = A
movetype= H
physics = N
ctrl = 0

[State 5030, 1]
type = VelAdd;Gravity
trigger1 = 1
y = GetHitVar(yaccel)

[State 5030, 2]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5030, 3]
type = ChangeState
triggerall = !HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10  ;.
value = 5040 ;HITA_RECOV

[State 5030, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10  ;.
value = 5050 ;HITA_FALL

[State 5030, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 5035 ;HITA_UP (transition)

;----------------
; 画面振動
[State 0]
	Type = EnvShake
	trigger1 = time = 0
	time = 3
	freq = 90 ;; << shake_speed (0-180)
	ampl = Ifelse((Enemy,HitDefAttr=SCA,HA,HP,HT), 3, Ifelse((Enemy,HitDefAttr=SCA,NA,NP,NT), 0, 2))
	phase = 4 ;; << phase_offset



;---------------------------------------------------------------------------
; HITA_UP_T (transition)
[Statedef 5035]
type    = A
movetype= H
physics = N

[State 5035, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059] ;Not if in hit up anim
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5035

[State 5035, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5035, 3]
type = ChangeState
triggerall = !HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Animation over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5040 ;HITA_RECOV

[State 5035, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Anim is over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5050 ;HITA_FALL

;---------------------------------------------------------------------------
; HITA_RECOV (recovering in air, not falling)
[Statedef 5040]
type    = A
movetype= H
physics = N

[State 5040, 1]
type = ChangeState
trigger1 = !Alive
value = 5050

[State 5040, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim != 5040
trigger2 = Time = 0
trigger2 = Anim != 5035
value = 5040

[State 5040, 3]
type = CtrlSet
trigger1 = HitOver
value = 1

[State 5040, 4]
type = StateTypeSet
trigger1 = HitOver
movetype = I

[State 5040, 5]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5040, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMPLAND

;---------------------------------------------------------------------------
; HITA_FALL (knocked up, falling)
[Statedef 5050]
type    = A
movetype= H
physics = N

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 3] ;Gravity
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 4] ;Recover near ground
type = ChangeState
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 5050, 5]; Recover in mid air
type = ChangeState
triggerall = Vel Y > -1
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 5100 ;HIT_BOUNCE

;---------------------------------------------------------------------------
; HIT_TRIP (shaking)
[Statedef 5070]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5070, 1]
type = ChangeAnim 
trigger1 = 1
value = 5070

[State 5070, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 5071

[State 5070, 3]
type = ForceFeedback
trigger1 = time = 0
time = 12
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HIT_TRIP2 (fall through air)
[Statedef 5071]
type    = A
movetype= H
physics = N

[State 5071, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5071, 2] ;Acceleration
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5071, 3] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 15
type = ChangeState
value = 5110

;---------------------------------------------------------------------------
; HITL_SHAKE
[Statedef 5080]
type    = L
movetype= H
physics = N
velset = 0,0

[State 5080, 1] ;Set default anim
type = VarSet
trigger1 = time = 0
sysvar(2) = ifelse (GetHitVar(yvel) = 0, 5080, 5090)

[State 5080, 2]
type = VarAdd
trigger1 = time = 0
trigger1 = (anim = [5081,5089]) || (anim = [5111,5119])
trigger1 = SelfAnimExist(sysvar(2) + (anim % 10))
sysvar(2) = anim % 10

[State 5080, 3] ;If 5090 doesn't exist, default to 5030
type = VarSet
trigger1 = time = 0
trigger1 = sysvar(2) = 5090
trigger1 = !SelfAnimExist(5090)
sysvar(2) = 5030

[State 5080, 3] ;Freeze
type = ChangeAnim
trigger1 = 1
value = sysvar(2)

[State 5080, 4]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0
value = 5081 ;HITL_SLIDE

[State 5080, 5]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) != 0
value = 5030 ;HITA_UP

;---------------------------------------------------------------------------
; HITL_SLIDE
[Statedef 5081]
type    = L
movetype= H
physics = C

[State 5081, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5081, 2]
type = VelSet
trigger1 = HitOver
x = 0

[State 5081, 3] ;Don't show hit ground frame
type = VarSet
trigger1 = Time = 0
sysvar(0) = 1

[State 5081, 4]
type = ChangeState
trigger1 = HitOver
value = 5110 ;HIT_LIEDOWN

;---------------------------------------------------------------------------
; HIT_BOUNCE (hit ground)
[Statedef 5100]
type = L
movetype = H
physics = N

[State 0]
	type = VelSet
	trigger1 = Time = 0
	trigger1 = GetHitVar(fall.yvel) = 0
	trigger1 = vel x > 1
	x = 1

[State 0]
	type = FallEnvShake
	trigger1 = Time = 0

[State 0]
	type = VarSet
	trigger1 = Time = 0
	sysvar(1) = floor(vel y)

[State 0]
	type = ChangeAnim
	triggerall = time = 0
	trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
	trigger2 = !SelfAnimExist(5100 + (anim % 10))
	value = 5100

[State 0]
	type = ChangeAnim
	trigger1 = time = 0
	trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
	trigger1 = SelfAnimExist(5100 + (anim % 10))
	value = 5100 + (anim % 10)

[State 0]
	type = PosSet
	trigger1 = Time = 0
	y = 0

[State 0]
	type = VelSet
	trigger1 = Time = 0
	y = 0

[State 0]
	type = VelMul
	trigger1 = Time = 0
	x = 0.75

[State 0]
	type = ChangeState
	trigger1 = Time = 0
	trigger1 = GetHitVar(fall.yvel) = 0
	value = 5110 ;HIT_LIEDOWN

[State 0]
	type = GameMakeAnim
	trigger1 = Time = 1
	value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
	pos = 0, 0
	under = sysvar(1) <= 14

[State 0]
	type = HitFallDamage
	trigger1 = Time = 3

;--------
[State 0]
	type = PlaySnd
	trigger1 = Time = 1
;win.;	value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
	value = F5000, (sysvar(1) > 5) + (sysvar(1) > 14)

;;[State 0]
;;	type = EnvShake
;;	trigger1 = Time = 1
;;	time = 4
;;	ampl = 2

[State 0]
	type = PosFreeze
	trigger1 = 1

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 5101

[State 0]
	type = ForceFeedback
	trigger1 = Time = 0
	waveform = sinesquare
	ampl = 128,-3,-.2,.005
	time = 20

;---------------------------------------------------------------------------
; HIT_BOUNCE (bounce into air)
[Statedef 5101]
type    = L
movetype= H
physics = N

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = 20

[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = 1
y = .4

[State 5101, 6] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 12
type = ChangeState
value = 5110

;---------------------------------------------------------------------------
; HIT_LIEDOWN
[Statedef 5110]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
	type = FallEnvShake
	trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from State 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

;アドオン土独自のサウンドを利用したい場合は
;適当に変えて下さい[↓]
[State 5110, 6]
	type = PlaySnd
	trigger1 = Time = 0
	trigger1 = !SysVar(0)
;win.;	value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
	value = F5000, (sysvar(1) > 5) + (sysvar(1) > 14)

;[State 5110, addtion]
;	type = EnvShake
;	trigger1 = Time = 0
;	time = 4
;	ampl = 2

[State 5110, 7]
	type = GameMakeAnim
	trigger1 = Time = 0
	trigger1 = !SysVar(0)
	value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
	pos = 0, 0
	under = sysvar(1) <= 14

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

;---------------------------------------------------------------------------
; HIT_GETUP
[Statedef 5120]
type    = L
movetype= I
physics = N

[State 5120, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5111,5119]
trigger2 = !SelfAnimExist(5120 + (anim % 10))
value = 5120

[State 5120, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5111,5119]
trigger1 = SelfAnimExist(5120 + (anim % 10))
value = 5120 + (anim % 10)

[State 5120, 2]
type = VelSet
trigger1 = Time = 0
x = 0

[State 5120, 3]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5120, 4]
type = HitFallSet
trigger1 = AnimTime = 0
value = 1

[State 5120, 5] ;Can't be thrown right after getting up
type = NotHitBy
trigger1 = AnimTime = 0
value = , NT,ST,HT
time = 12

[State 5120, 6] ;Can't be hit right after getting up (short time)
type = NotHitBy
trigger1 = AnimTime = 0
value2 = SCA
time = 3

[State 5120, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HIT_LIEDEAD
[Statedef 5150]
type = L
movetype = H
physics = N
sprpriority = -3

[State 0] ;Normal anim
	type = ChangeAnim
	triggerall = Time = 0
	triggerall = SelfAnimExist(5140)
	trigger1 = (anim != [5111,5119]) && (anim != [5171,5179])
	trigger2 = !SelfAnimExist(5140 + (anim % 10))
	value = 5140

[State 0] ;Hit up type anim
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = (anim = [5111,5119]) || (anim = [5171,5179])
	trigger1 = SelfAnimExist(5140 + (anim % 10))
	value = 5140 + (anim % 10)

[State 0] ;Match over anim
	type = ChangeAnim
	persistent = 0
	;trigger1 = Time = 0
	trigger1 = MatchOver = 1
	trigger1 = Anim = [5140,5149]
	trigger1 = SelfAnimExist(anim+10)
	value = anim+10

[State 0] ;Switch to 5110 if liedead anim does not exist
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = Anim != [5140,5159]
	trigger1 = Anim != [5110,5119]
	value = 5110

[State 0] ;Friction
	type = VelMul
	trigger1 = 1
	x = 0.85
[State 0] ;Friction
	type = VelSet
	trigger1 = Vel x < .05
	persistent = 0
	x = 0
[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	time = 1

;---------
;--;[State 0]
;--;	type = AssertSpecial
;--;	triggerall = Alive = 0
;--;	triggerall = NumPartner
;--;	triggerall = Partner,sysvar(4)
;--;	trigger1 = time > 150
;--;	trigger2 = (time%10 < 5) && (time = [80,150])
;--;	flag = invisible





;---------------------------------------------------------------------------
; HIT_FALLRECOVER (still falling)
[Statedef 5200]
type    = A
movetype= H
physics = N

[State 5200, 1] ;Change anim if done with transition
type = ChangeAnim
trigger1 = Anim = 5035
trigger1 = AnimTime = 0
value = 5050

[State 5200, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5200, 3]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 10
value = 5201

;---------------------------------------------------------------------------
; HIT_FALLRECOVER (on the ground)
[Statedef 5201]
type    = A
movetype= H
physics = A
anim = 5200

[State 5201, 1] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -5

[State 5201, 2]
type = VelSet
trigger1 = Time = 0
x = -.15
y = -3.5

[State 5201, 3]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5201, 5] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5201, 6]
type = GameMakeAnim
trigger1 = Time = 1
value = 60
pos = 0, 0
under = 1

;---------------------------------------------------------------------------
; HIT_AIRFALLRECOVER
[Statedef 5210]
type    = A
movetype= I
physics = N
anim = 5210
ctrl = 0

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5210, 1]
type = PosFreeze
trigger1 = Time = 0
value = 4

[State 5210, 2] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -20

[State 5210, 1] 
type = VelMul
trigger1 = Time = 4
x = .8
y = .8

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
y = -4.5

[State 5210, 1] 
type = VelMul
trigger1 = Time = 4
trigger1 = Vel Y > 0
y = .5

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
trigger1 = Vel Y > -3
y = -2

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
trigger1 = Vel Y > -2
y = -1

[State 5210, 2] ;Go up
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holdup"
y = -2

[State 5210, 2] ;Go down
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holddown"
y = 1.5

[State 5210, 2] ;Go fwd
type = VelMul
trigger1 = Time = 4
trigger1 = Command = "holdfwd"
x = 1

[State 5210, 2] ;Go back
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holdback"
x = -1

[State 5210, 3]
type = NotHitBy
trigger1 = Time = 0
value = SCA
time = 15

[State 5210, 4]
type = CtrlSet
trigger1 = Time = 20
value = 1

[State 5210, 5]
type = VelAdd;Gravity
trigger1 = Time >= 4
y = .35

[State 5210, 5] ;Land on ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMP_LAND
ctrl = 1







;---------------------------------------------------------------------------
; Continue?
;---------------------------------------------------------------------------

[Statedef 5500]
type = S
ctrl = 1
anim = 5300
velset = 0, 0

[State 0] ;Use continue animation if available
	type = ChangeAnim
	trigger1 = time = 0
	trigger1 = SelfAnimExist(5500)
	value = 5500

;--------
[State 0]
	type = GameMakeAnim
	trigger1 = 1
	trigger1 = NumPartner
	trigger1 = ID < Partner,ID
	trigger2 = !NumPartner
	value = 5500
	pos = ScreenPos X - 160, ScreenPos Y - 240 - 220 - Ifelse(Time < 30, (30-time)*3, 0)
	under = 0
[State 0]
	type = GameMakeAnim
	trigger1 = 1
	trigger1 = NumPartner
	trigger1 = ID < Partner,ID
	trigger2 = !NumPartner
	value = 5500
	pos = ScreenPos X - 160, ScreenPos Y - 240 - 220 - Ifelse(Time < 30, (30-time)*3, 0) -1
	under = 0
[State 0]
	type = GameMakeAnim
	trigger1 = 1
	trigger1 = NumPartner
	trigger1 = ID < Partner,ID
	trigger2 = !NumPartner
	value = 5500
	pos = ScreenPos X - 160, ScreenPos Y - 240 + Ifelse(Time < 30, (30-time)*3, 0)
	under = 0
[State 0]
	type = GameMakeAnim
	trigger1 = 1
	trigger1 = NumPartner
	trigger1 = ID < Partner,ID
	trigger2 = !NumPartner
	value = 5500
	pos = ScreenPos X - 160, ScreenPos Y - 240 + Ifelse(Time < 30, (30-time)*3, 0) + 1
	under = 0

;---------
[State 0]
	type = Width
	trigger1 = 1
	edge = 158 - Const(size.ground.front), 158 - Const(size.ground.back)
;	player = 159, 159
;	value = 159, 159

[State 0]
	type = turn
	trigger1 = time = 0
	trigger1 = NumPartner
	trigger1 = ID > Partner,ID

;--------
[State 0]
	type = velset
	trigger1 = Time%800 = 40
	x = -0.75
[State 0]
	type = velset
	trigger1 = Time%800 = 440
	trigger2 = Time = 240
	x = 0.75

[State 0]
	type = offset
	trigger1 = 1
	y = 999999999









;==============================================================
; デフォルト・開始ステート
;==============================================================
[Statedef 5900]
Type = S

; スコア・ボーナスなど次のステージに持越し
[State 0]
	type = VarRangeSet
	trigger1 = RoundNo = 1
	last = 51
	value = 0

[State 0]
	type = VarRangeSet
	trigger1 = RoundNo = 1
	fvalue = 0


;***************************************************************
;***************************************************************

;get stage info ステージ情報取得
; 【水】
[State 0, water]
	type = varset
	triggerall = !IsHelper
	triggerall = StateNo = 5900 && Time = 0
	trigger1 = Abs(Pos X) = 73
	trigger2 = NumPartner
	trigger2 = Abs(Partner,Pos X) = 73
	sysvar(0) = 1073
;-; 【網】
;-;[State 0, net]
;-;	type = varset
;-;	triggerall = !IsHelper
;-;	triggerall = StateNo = 5900 && Time = 0
;-;	trigger1 = Abs(Pos X) = 75
;-;	trigger2 = NumPartner
;-;	trigger2 = Abs(Partner,Pos X) = 75
;-;	sysvar(0) = 1075

;-; 【サイコドライブ】
;-;[State 0, drive]
;-;	type = varset
;-;	triggerall = !IsHelper
;-;	triggerall = StateNo = 5900 && Time = 0
;-;	trigger1 = Abs(Pos X) = 77
;-;	trigger2 = NumPartner
;-;	trigger2 = Abs(Partner,Pos X) = 77
;-;	sysvar(0) = 1077







;--------------------------------------------------------------
; Set PlayerType for normal mode
;[State 0]
;	type = VarSet
;	triggerall = !IsHelper
;	triggerall = StateNo = 5900 && time = 0
;	trigger1 = sysvar(4) = 0
;	trigger1 = NumPartner = 0
;	sysvar(4) = Ifelse(!(PalNo%3), 3, PalNo%3)

; TeamMode (2on2)
;[State 0]
;	type = VarSet
;	triggerall = !IsHelper
;	triggerall = StateNo = 5900 && time = 0
;	trigger1 = sysvar(4) = 0
;	trigger1 = NumPartner
;	trigger1 = ID < Partner,ID
;	sysvar(4) = 4


;==============================================================
;ラウンド開始
;==============================================================

; Display Fight!
;[State 0] 
;	type = Helper
;	triggerall = !IsHelper
;	triggerall = sysvar(4)
;	triggerall = !NumHelper(180000)
;;	triggerall = !NumHelper(90900)
;	triggerall = TeamSide = 1
;	trigger1 = NumPartner
;	trigger1 = ID < Partner,ID
;	trigger2 = !NumPartner
;	name = "Fight-a4"
;	ID = 180000
;	Stateno = 180000
;	IgnoreHitPause = 1


;==============================================================
;バー表示 (Display life power bars)
;ライフ、パワーバー表示用ヘルパーの呼出
;==============================================================

;--------------------------------------------------------------
; edited life & power bar
;[State 0]
;	type = Helper
;	triggerall = !IsHelper
;	triggerall = !NumHelper(90900)
;	triggerall = !NumHelper(90901)
;	triggerall = !NumHelper(90902)
;	trigger1 = NumPartner
;	trigger1 = ID < Partner,ID
;	trigger2 = !NumPartner
;	name = "LifeBar-A4"
;	id = 90900
;	Stateno = 90900
;--------------------------------------------------------------







;--------------------------------------------------------------
;[State -2, nolifebar] ; ライフバーを隠す
;	type = AssertSpecial
;	triggerall = !IsHelper
;	triggerall = sysvar(4)
;	trigger1 = RoundState != 2
;	trigger2 = RoundState = 2
;	trigger2 = NumHelper(180000)
;	trigger2 = Helper(180000),var(2) < 90
;	flag = NoBarDisplay
;	IgnoreHitPause = 1

;[State -2, nolifebar] ; ライフバーを隠す(var操作)
;	type = varset
;	triggerall = !IsHelper
;	triggerall = sysvar(4) && sysvar(3)
;	trigger1 = RoundState != 2
;	trigger2 = RoundState = 2
;	trigger2 = NumHelper(180000)
;	trigger2 = Helper(180000),var(2) < 90
;	sysvar(3) = 0
;	IgnoreHitPause = 1

;[State -2, nolifebar] ; ライフバーを隠す(var操作 2)
;	type = varadd
;	triggerall = !IsHelper
;	triggerall = sysvar(4)
;	trigger1 = sysvar(3) != 2
;	sysvar(3) = Ifelse(sysvar(3) > 2, -1, 1)
;	IgnoreHitPause = 1










;********************************
[State 0]
	type = ChangeState
	trigger1 = RoundNo = 1
	value = 190








;==============================================================
;ストライカーステート登録。変数(var(59))はどれでも可
;==============================================================
[Statedef 195900]
type = S

;ex.;[State 0]
;ex.;	type=varset
;ex.;	triggerall = var(59) = 0    ;余計な読込みを避けるため
;ex.;	trigger1 = name = "Ryu"     ;キャラ名
;ex.;	var(59) = 1020              ;技ステート番号、cmdファイルより

[State 0]
	type = VarSet
	trigger1 = var(59) = 0 ;それでも空白の場合
	var(59) = 1000         ;未登録のキャラは一括に1000を代入
;---------------
[State 0]                      ;台詞イントロステートへ
	type = ChangeState
	trigger1 = var(59) != 0
	trigger1 = RoundNo = 1
	value = 190000



;==============================================================
;台詞などの演出用
;==============================================================
[Statedef 190000]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = Intro

[State 0]
	type = Helper
	triggerall = Time = 0
	triggerall = sysvar(4) > 0
	trigger1 = !NumHelper(590190)
	name = "my intro"
	ID = 590190
	Stateno = 590190
	pos = 9999999, 9999999

[State 0] ; 通常のイントロへ
	type = ChangeState
	trigger1 = Time = 0
	value = 190





;------------------------------------------------
[Statedef 590190]
ctrl = 0

[State 0]
	type = varset
	triggerall = RoundNo = 1 && IsHomeTeam = 1
	triggerall = MatchNo > 1
	trigger1 = Root,name = "Gouki"
	trigger2 = Root,name = "Karate"
	trigger3 = Root,name = "CVSGeese"
	trigger4 = Root,name = "cvsrugal"
	trigger5 = Root,name = "CVSVega"
	trigger6 = Root,name = "CVSEvilRyu"
	var(0) = 1


;-------------------
[State 0, base]
	type = Explod
	triggerall = var(0) && !var(1) && !NumExplod(9)
	trigger1 = Root,StateNo = 0
	trigger1 = P2StateNo = 0
	ID = 9
	anim = F180000
	sprpriority = 3
	postype = left
	pos = 0, 150
	ontop = 1
	bindtime = -1

;-------------------
[State 0]
	type = Explod
	triggerall = var(0) && !var(1) && !NumExplod(1)
	trigger1 = Root,name = "Gouki" || Root,name = "Karate"
	trigger1 = Root,StateNo = 0
	trigger1 = P2StateNo = 0
	ID = 1
	anim = F180500 + Ifelse(p2name="CVSEvilRyu",  5, random%3)
	sprpriority = 5
	postype = left
	pos = Ifelse(TeamSide = 1, 200, 120), 180
	scale = 0.5, 0.5
	ontop = 1
	bindtime = -1

[State 0]
	type = Explod
	triggerall = var(0) && !var(1) && !NumExplod(1)
	trigger1 = Root,name = "CVSGeese"
	trigger1 = Root,StateNo = 0
	trigger1 = P2StateNo = 0
	ID = 1
	anim = f180100 + Ifelse(p2name="Terry Bogard"||p2name="Andy Bogard"||p2name="NeoRock",  5, random%3)
	sprpriority = 5
	postype = left
	pos = Ifelse(TeamSide = 1, 200, 120), 180
	scale = 0.5, 0.5
	ontop = 1
	bindtime = -1

[State 0]
	type = Explod
	triggerall = var(0) && !var(1) && !NumExplod(1)
	trigger1 = Root,name = "cvsrugal"
	trigger1 = Root,StateNo = 0
	trigger1 = P2StateNo = 0
	ID = 1
	anim = f180200 + Ifelse(p2name="Heidern"||p2name="Leona",  5, random%3)
	sprpriority = 5
	postype = left
	pos = Ifelse(TeamSide = 1, 200, 120), 180
	scale = 0.5, 0.5
	ontop = 1
	bindtime = -1

[State 0]
	type = Explod
	triggerall = var(0) && !var(1) && !NumExplod(1)
	trigger1 = Root,name = "CVSVega"
	trigger1 = Root,StateNo = 0
	trigger1 = P2StateNo = 0
	ID = 1
	anim = f180300 + Ifelse(p2name="CVSEvilRyu"||p2name="CVSRyu",  5, random%3)
	sprpriority = 5
	postype = left
	pos = Ifelse(TeamSide = 1, 200, 120), 180
	scale = 0.5, 0.5
	ontop = 1
	bindtime = -1

[State 0]
	type = Explod
	triggerall = var(0) && !var(1) && !NumExplod(1)
	trigger1 = Root,name = "CVSEvilRyu"
	trigger1 = Root,StateNo = 0
	trigger1 = P2StateNo = 0
	ID = 1
	anim = f180400 + Ifelse(p2name="Gouki"||p2name="Sagat"||p2name="CVSRyu",  5, random%3)
	sprpriority = 5
	postype = left
	pos = Ifelse(TeamSide = 1, 200, 120), 180
	scale = 0.5, 0.5
	ontop = 1
	bindtime = -1

;-------------------
;protrait

[State 0]
	type = Explod
	trigger1 = NumExplod(1)
	trigger1 = !NumExplod(2)
	ID = 2
	anim = 9100
	sprpriority = 4
	postype = left
	facing = Ifelse(TeamSide = 1, 1, -1)
	pos = Ifelse(TeamSide = 1, 0, 320), 209
	ontop = 1
	bindtime = -1

[State 0]
	type = RemoveExplod
	triggerall = NumExplod(2)
	trigger1 = !NumExplod(1)
	ID = 9

[State 0]
	type = RemoveExplod
	triggerall = NumExplod(2)
	trigger1 = !NumExplod(1)
	ID = 2

;-------------------
[State 0]
	type = varset
	trigger1 = var(1) = 0
	trigger1 = NumExplod
	var(1) = 1

[State 0]
	type = varset
	trigger1 = var(0) && var(1)
	trigger1 = !NumExplod
	var(0) = 0

[State 0]
	type = DestroySelf
	trigger1 = var(0) = 0




































;--------------------------------------------------------------
; add004 working...
; 以下は　add004 のメイン処理部分
;--------------------------------------------------------------




;--------------------------------------------------------------
;ブロッキング/ジャストディフェンス用 (上書き可)
;(BLOCKING/JUST defence)
;--------------------------------------------------------------
[Statedef 195500]
type = U
physics = N
sprpriority = 5
velset = 0, 0
ctrl = 0

; アニメーション変更：
; ブロッキング用アニメ番号 (立:195500(130)/屈:1995501(131)/空:195002(132))
; (好きな番号に変更してください^_^)
; 無ければ必須スプライトのガードモーションから流用

; animetion for blocking...
; stand: 195500/130
; squat: 195501/131
; air:   195502/132

;--------
;モーション(motion)
[State 0] ;空 fly
	type = ChangeAnim
	triggerall = NumHelper(90900)
	trigger1 = time = 0 && StateType = A
	value = Ifelse(SelfAnimExist(195502) && Helper(90900),var(22) = 2, 195502, 132)

[State 0] ;屈 squat
	type = ChangeAnim
	triggerall = NumHelper(90900)
	trigger1 = time = 0 && StateType = C
	value = Ifelse(SelfAnimExist(195501) && Helper(90900),var(22) = 2, 195501, 131)

[State 0] ;立 stand
	type = ChangeAnim
	triggerall = NumHelper(90900)
	trigger1 = time = 0 && StateType = S
	value = Ifelse(SelfAnimExist(195500) && Helper(90900),var(22) = 2, 195500, 130)

[State 0] ;フリーズ
	type = ChangeAnim
	triggerall = NumHelper(90900)
	trigger1 = time > 0 && Helper(90900),var(22) = 2
	value = anim

;--------
[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	time = 12

; 振動を押える
[State 0]
	type = EnvShake
	trigger1 = 1
	time = 1
	ampl = 0

; 体力回復
[State 0]
	type = lifeadd
	triggerall = NumHelper(90900)
	trigger1 = Time = 0
	trigger1 = Helper(90900),var(22) = 3
	value =  LifeMax / 25 ;; << (+4%)

;--------
; スパーク (SFX)
[State 0]
	type = SuperPause
	triggerall = NumHelper(90900)
	trigger1 = time = 0
	trigger1 = Helper(90900),var(22) = 2
	time = 5	  ;; <<静止時間
	anim = 210200
	sound = 2500, 1
	pos = Const(Size.Mid.Pos.X)+16, Const(Size.Mid.Pos.Y)
	darken = 0

[State 0]
	type = SuperPause
	triggerall = NumHelper(90900)
	trigger1 = Time = 0
	trigger1 = Helper(90900),var(22) = 3
	time = 5	  ;; <<静止時間
	anim = F210300
	sound = 2500, 0
	pos = Const(Size.Mid.Pos.X)+16, Const(Size.Mid.Pos.Y)
	darken = 0

;--------
; can override p2palfx
[State 0]
	type = PalFx
	triggerall = NumHelper(90900)
	trigger1 = Time = 0
	trigger1 = Helper(90900),var(22) = 2
	add = -100, 120, 120
	time = 4

[State 0]
	type = PalFx
	triggerall = NumHelper(90900)
	trigger1 = Time = 0
	trigger1 = Helper(90900),var(22) = 3
	add = 120, -50, -100
	time = 4

;--------
; パワーアップ power up!
[State 0]
	type = poweradd
	trigger1 = Time = 0
	value = 120

; 連続判定
[State 0]
	type = RemoveExplod
	trigger1 = time = 0
	ID = 1195500

; 連続判定
[State 0]
	type = Explod
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo != 99996
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo != 99996
	ID = 1195500
	anim = F111111
	removetime = 4
	IgnoreHitPause = 1

;--------
[State 0]
	type = StateTypeSet
	triggerall = StateType = S
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo != 99996
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo != 99996
	trigger3 = !NumHelper(99997) && !NumHelper(99998)
	physics = S

[State 0]
	type = StateTypeSet
	triggerall = StateType = C
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo != 99996
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo != 99996
	trigger3 = !NumHelper(99997) && !NumHelper(99998)
	physics = C

[State 0]
	type = StateTypeSet
	triggerall = StateType = A
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo != 99996
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo != 99996
	trigger3 = !NumHelper(99997) && !NumHelper(99998)
	physics = A

;--------
[State 0]
	type = ChangeState
	triggerall = time > 0
	triggerall = NumHelper(90900)
	triggerall = Helper(90900),var(22) = 2
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo != 99996
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo != 99996
	trigger3 = !NumHelper(99997) && !NumHelper(99998)
	value = Ifelse(StateType = S, 0, Ifelse(StateType = A, 50, 11))
	ctrl = 1

;--------
[State 0]
	type = velset
	triggerall = time > 0
	triggerall = NumHelper(90900)
	triggerall = Helper(90900),var(22) = 3
	triggerall = StateType = A
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo != 99996
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo != 99996
	trigger3 = !NumHelper(99997) && !NumHelper(99998)
	x = -1.5
	y = -3.2

[State 0]
	type = ChangeState
	triggerall = time > 0
	triggerall = NumHelper(90900)
	triggerall = Helper(90900),var(22) = 3
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo != 99996
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo != 99996
	trigger3 = !NumHelper(99997) && !NumHelper(99998)
	value = 140









;--------------------------------------------------------------
; 削りKO用ステート　[上書き可] (shaving KO.)
;--------------------------------------------------------------
; このモーションが存在しないキャラは必須スプライトを流用しています
; キャラデータがある場合は、このステートを上書きするか、もしくは
; [-2]での呼び出し部分を、キャラデータの番号に書き換えてください

;[Begin Action 195200]
; 5000,  0, 0, 0, 4,
; 5000, 10, 0, 0, 4,
; 5000, 20, 0, 0, 4,
; 5000, 30, 0, 0, 4,
; 5020,  0, 0, 0, 4,
; 5020, 10, 0, 0, 4,
; 5020, 20, 0, 0, 4,
; 5020, 30, 0, 0, 4,
; 5040,  0, 0, 0, 4,
; 5040, 10, 0, 0, 1,


[Statedef 195200]
type = S
movetype = H
physics = N
velset = IsHelper * -2, 0

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	time = 1

[State 0] ;アニメ変更1-0
	type = ChangeAnim
	Trigger1 = time = 0
	value = Ifelse(Statetype=S,5002,5022)  ;see air.txt
	; 5002 :立-(stand Hit -hard)       ;loop
	; 5012 :空-(Stand/Air low -hard)
	; 5022 :屈-(Crouch Hit -hard)

;(派生Helper)------------------------------------
;	[State 0]
;		type = Helper
;		trigger1 =  Time = 0 && !IsHelper
;	;	trigger1 = !NumHelper(195200)
;		helpertype = normal
;		name = "over guardP1"
;		ID = 195200
;		Stateno = 195200 ;same Stateno
;		postype = p1

;	[State 0]
;		type = AssertSpecial
;		trigger1 = IsHelper
;		flag = invisible

;	[State 0]
;		type = AfterImage
;		trigger1 = IsHelper
;		trigger1 = Time > 0
;		time = 2
;		framegap = 1
;		length = 5;2
;		PalContrast = 200-(time*10), 200-(time*10), 200-(time*10)
;		trans = add

;	[State 0]
;		type = DestroySelf
;		triggerall = IsHelper
;		Trigger1 = Anim = 5002
;		Trigger1 = (AnimTime=0)||(Time>18) ;ループの場合
;----------------------------------------------

[State 0] ;アニメ変更1-1
	type = ChangeAnim
	Trigger1 = Anim = 5002
	Trigger1 = (AnimTime=0)||(Time>18) ;ループの場合
	value = 5022

[State 0] ;アニメ変更2-0
	type = ChangeAnim
	Trigger1 = Anim = 5022
	Trigger1 = (AnimTime=0)||(Time>36) ;ループの場合
	value = 5080

[State 0] ;アニメ変更2-0
	type = ChangeAnim
	Trigger1 = Anim = 5080
	Trigger1 = (AnimTime=0)||(Time>52) ;ループの場合
	value = 5110

[State 0]
	type = SelfState
	Trigger1 = Anim = 5110
	Trigger1 = (AnimTime=0)||(Time>42) ;ループの場合
	value = 5110





;--------------------------------------------------------------
;ガードクラッシュ(空中版無し^^;)  [上書き可]
;--------------------------------------------------------------
;P1 GUARD CRUSH

[Statedef 190010]
type = U
physics = U
velset = 0, 0

[State 0]
	type = AssertSpecial
	trigger1 = time <= 10
	flag = NoFG
	flag2 = NoBG
	flag3 = NoBarDisplay
	IgnoreHitPause = 1
	supermovetime = 999999999
	pausemovetime = 999999999

; BG
[State 0]
	type = Explod
	trigger1 = time = 0
	anim = F3501
	pos = 0, 0
	ID = 203531
	Sprpriority = -7
	scale = 32, 1
	postype = Left
	bindtime = -1
	IgnoreHitPause = 1
	removetime = 18
	supermovetime = 999999999
	pausemovetime = 999999999

; BG2 LINE
[State 0]
	type = Explod
	trigger1 = time = 0
	anim = F3513
	sprpriority = -6
	postype = Left
	facing = facing
	pos = Floor(ScreenPos X), Floor(ScreenPos Y + const(size.mid.pos.y))
	bindtime = -1
	IgnoreHitPause = 1
	supermovetime = 999999999
	pausemovetime = 999999999

[State 0]
	type = varset
	trigger1 = Time <= 10
	sysvar(3) = 0

[State 0]
	Type = EnvShake
	trigger1 = Time = 1
	Time = 1
	Ampl = 1

[State 0]
	type = SuperPause
	trigger1 = Time = 0
	Time = 10
	movetime = 10
	anim = 210100
	sound = 10010, 0
	pos = const(size.mid.pos.x) ,const(size.mid.pos.y)
	darken = 0

[State 0, warning sound]
	type = PlaySnd
	trigger1 = time = 0
	value = F10200, 1
	IgnoreHitPause = 1
	supermovetime = 999999999
	pausemovetime = 999999999


[State 0]
	type = StateTypeSet
	trigger1 = Time = 0
	physics = Statetype

[State 0, Anim] ;アニメ変更@
	type = ChangeAnim
	Trigger1 = time = 0
	value = Ifelse(Statetype=S,5002,Ifelse(Statetype=C,5022,5012))  ;see air.txt
	; 5002 :立-(stand Hit -hard)
	; 5012 :空-(Stand/Air low -hard)
	; 5022 :屈-(Crouch Hit -hard)

[State 0, To190011]
	type = selfState
	Trigger1 = (AnimTime =0)||(Time>28) ;ループの場合
	value = 190011


;--------------------------------------------------------------
;無防備状態 カウントしやすくするため190011に分離
;faint(^^;

[Statedef 190011]
type = U
physics = U
velset = 0,0

[State 0, physic] ;体勢確認
	type = StateTypeSet
	trigger1 = Time = 0
	physics = Statetype

[State 0, Anim] ;アニメ変更A
	type = ChangeAnim
	Trigger1 = Time = 0
	value = Ifelse(Statetype=S,5007,Ifelse(Statetype=C,5027,5017))
	; 5002-5007
	; 5012-5017
	; 5022-5027

[State 0, Blink]
	type = PalFX
	trigger1 = GameTime%10 = 1
	time = 2
	add = 90,65,160

[State 0, Freeze];凍結
	type = ChangeAnim
	trigger1 = Time <= 80 ;硬直時間
	value = anim	
	
[State 0, VelSet] ;振動. 別に要らないかも
	type = velset
	Trigger1 = AnimTime
	x = GameTime%3-1

[State 0, END]
	type = selfState
	Trigger1 = (AnimTime =0) || (Time > 99) ;ループの場合
	value = Ifelse(Statetype=S,0,11)
	ctrl = 1





;--------------------------------------------------------------
;気絶(ヒヨコ)状態  [上書き可]
;--------------------------------------------------------------
;DIZZY code (P1)

[Statedef 190110]
type = U
physics = U
movetype = H
movehitpersist = 1
;hitdefpersist = 1
ctrl = 0

[State 0]
	type = Nothitby
	trigger1 = 1
	value = SCA

[State 0]
	type = helper
	trigger1 = time = 0
	trigger1 = !NumHelper(403000)
	name = "dizzy birds"
	ID = Ifelse(Life < 200, 403003, 403000 + Random%3)
	Stateno = 190140
	IgnoreHitPause = 1
	type = Helper

[State 0]
	type = ForceFeedback
	trigger1 = alive
	trigger1 = Time = 0
	time = 8
	ampl = 240
	waveform = sine

[State 0]
	type = SelfState
	trigger1 = HitShakeOver
	value = StateNo + 1


;--------------------------------------------------------------
;ガードブレーキングやられ  [上書き可]
;--------------------------------------------------------------
;Guard Breaking (P2State)


[Statedef 190120]
type = U
movetype = I
physics = N
velset = Ifelse(StateType = A, -4, -8), 9
ctrl = 0

[State 0]
	type = Nothitby
	trigger1 = 1
	value = SCA
	time = 1

[State 0]
	type = ChangeAnim
	trigger1 = time = 0
	value = Ifelse(Statetype = S, 5002, Ifelse(Statetype = C, 5022, 5012))
	; 5002-5007 :立-(stand Hit -hard)       ;loop-no loop
	; 5012-5017 :空-(Stand/Air low -hard)
	; 5022-5027 :屈-(Crouch Hit -hard)
[State 0]
	type = ChangeAnim
	trigger1 = Anim = 5002 || Anim = 5012 || Anim = 5022
	trigger1 = AnimTime = 0 && Pos Y >= 0
	value = Ifelse(Anim = 5002, 5007, Ifelse(Anim = 5012, 5017, 5027))

[State 0]
	type = velset
	trigger1 = pos y >= 0
	y = 0
[State 0]
	type = posset
	trigger1 = pos y > 0
	y = 0

[State 0]
	type = VelMul
	trigger1 = pos y >= 0
	x = 0.9

[State 0]
	type = EnvShake
	trigger1 = Time = 1
	time = 6
	ampl = 3
	IgnoreHitPause = 1


[State 0]
	type = LifeAdd
	trigger1 = Time = 1
	value = -150
	kill = 0
	IgnoreHitPause = 1

[State 0]
	type = StateTypeSet
	trigger1 = time = 1
	movetype = H
	IgnoreHitPause = 1
[State 0]
	type = StateTypeSet
	trigger1 = time > 0 && pos y >= 0
	Statetype = S
	movetype = H
	physics = N
	IgnoreHitPause = 1

[State 0]
	type = StateTypeSet
	trigger1 = Anim = 5007 || Anim = 5017 || Anim = 5027
	trigger1 = AnimElem = 1, > 12
	movetype = I
	IgnoreHitPause = 1

[State 0]
	type = SelfState
	triggerall = !win && RoundState != 2
	trigger1 = Anim = 5007 || Anim = 5017 || Anim = 5027
	trigger1 = AnimElem = 1, > 12
	value = 195200

[State 0]
	type = SelfState
	trigger1 = Anim = 5007 || Anim = 5017 || Anim = 5027
	trigger1 = AnimElem = 1, > 12
	value = 190116
	ctrl = 0

;--------
[State 0]
	type = PlaySnd
	trigger1 = time = 0
	value = F10010, 0
	IgnoreHitPause = 1
[State 0]
	type = BGPalFX
	trigger1 = time = 0
	add = 200, 200, 200
	invertall = 0
	time = 1
	IgnoreHitPause = 1
[State 0]
	type = PalFx
	trigger1 = time < 10 && time%2 = 1
	time = 1
	add = 150,150,150
	mul = 180,180,180
	sinadd = 50,50,50,25
	color = 0
	invertall = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	triggerall = NumExplod(505000) < 10
	trigger1 = GameTime%3 < 2
	ID = 505000
	anim = F210520 + Random%4
	postype = p1
	pos = 0, Ifelse(StateType = C, -30, -50)
	random = 80, Ifelse(StateType = C, 80, 160)
	scale = 0.5, 0.5
	facing = Ifelse(Random < 500, 1, -1)
	ownpal = 1
	bindtime = 1
	sprpriority = 4
	IgnoreHitPause = 1


;--------------------------------------------------------------
[Statedef 190111]	;down
type = A
movetype = H
physics = N
velset = -4, -7
movehitpersist = 1
ctrl = 0

[State 0]
	type = Nothitby
	trigger1 = 1
	value = SCA

[State 0]
	type = ChangeAnim
	trigger1 = AnimTime = 0
	trigger1 = Anim = 5035
	trigger2 = Time = 0     ;If no transition anim
	trigger2 = Anim != 5035
	trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
	trigger2 = Anim != 5090 ;Not if hit off ground anim
	value = 5050

[State 0] ;Coming down anim
	type = ChangeAnim
	trigger1 = anim = [5050,5059]
	trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
	trigger1 = SelfAnimExist(anim+10)
	value = anim + 10
	persistent = 0

[State 0] ;Gravity
	type = VelAdd
	trigger1 = 1
	y = GetHitVar(yaccel)

[State 0]
	type = Pause
	trigger1 = Time%2 = 0
	trigger1 = Time <= 16
	time = 2

[State 0]
	type = SelfState
	trigger1 = Vel Y > 0
	trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
	value = StateNo + 1 ;HIT_BOUNCE

;--------------------------------------------------------------
[Statedef 190112]	;hit bounce-1
type = L
movetype = H
physics = N
movehitpersist = 1
ctrl = 0

[State 0]
	type = Nothitby
	trigger1 = 1
	value = SCA

[State 0]
	type = VelSet
	trigger1 = Time = 0
	trigger1 = GetHitVar(fall.yvel) = 0
	trigger1 = vel x > 1
	x = 1

[State 0]
	type = FallEnvShake
	trigger1 = Time = 0

[State 0] ;Save fall velocity
	type = VarSet
	trigger1 = Time = 0
	sysvar(1) = floor(vel y)

[State 0] ;Hit ground anim (normal)
	type = ChangeAnim
	triggerall = time = 0
	trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
	trigger2 = !SelfAnimExist(5100 + (anim % 10))
	value = 5100

[State 0] ;Hit ground anim (for hit up)
	type = ChangeAnim
	trigger1 = time = 0
	trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
	trigger1 = SelfAnimExist(5100 + (anim % 10))
	value = 5100 + (anim % 10)

[State 0]
	type = PosSet
	trigger1 = Time = 0
	y = 0

[State 0]
	type = VelSet
	trigger1 = Time = 0
	y = 0

[State 0] ;Reduce speed
	type = VelMul
	trigger1 = Time = 0
	x = 0.75

[State 0]
	type = GameMakeAnim
	trigger1 = Time = 1
	value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
	pos = 0, 0
	under = sysvar(1) <= 10

[State 0]
	type = PlaySnd
	trigger1 = Time = 1
	value = F5000, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 0]
	type = PosFreeze
	trigger1 = 1

[State 0]
	type = SelfState
	trigger1 = AnimTime = 0
	value = StateNo + 1

[State 0]
	type = ForceFeedback
	trigger1 = Time = 0
	waveform = sinesquare
	ampl = 128,-3,-.2,.005
	time = 20


;--------------------------------------------------------------
[Statedef 190113]; HIT_BOUNCE (bounce into air)
type = L
movetype = H
physics = N
movehitpersist = 1
ctrl = 0

[State 0]
	type = Nothitby
	trigger1 = 1
	value = SCA

[State 0] ;Coming hit ground anim (normal)
	type = ChangeAnim
	triggerall = time = 0
	trigger1 = anim != [5101,5109]
	trigger2 = !SelfAnimExist(5160 + (anim % 10))
	value = 5160

[State 0] ;Coming hit ground anim (for hit up)
	type = ChangeAnim
	triggerall = time = 0
	trigger1 = anim = [5101,5109]
	trigger1 = SelfAnimExist(5160 + (anim % 10))
	value = 5160 + (anim % 10)

[State 0]
	type = HitFallVel
	trigger1 = Time = 0

[State 0]
	type = PosSet
	trigger1 = Time = 0
	y = 20

[State 0] ;Acceleration
	type = VelAdd
	trigger1 = 1
	y = .4

[State 0] ;Hit ground
	type = SelfState
	trigger1 = Vel Y > 0
	trigger1 = Pos Y >= 12
	value = StateNo + 1


;--------------------------------------------------------------
[Statedef 190114]	;HIT_LIEDOWN 2nd time
type = L
movetype = H
physics = N
movehitpersist = 1
ctrl = 0

[State 0]
	type = Nothitby
	trigger1 = 1
	value = SCA

[State 0]
	type = FallEnvShake
	trigger1 = Time = 0

[State 0] ;For hit up/up-diag type (from State 5081)
	type = ChangeAnim
	persistent = 0
	trigger1 = SelfAnimExist(5110 + (anim % 10))
	trigger1 = anim = [5081,5089]
	value = 5110 + (anim % 10)

[State 0] ;Hit ground anim (normal)
	type = ChangeAnim
	triggerall = time = 0
	triggerall = anim != [5110,5119] ;Not already changed anim
	trigger1 = anim != [5161,5169]
	trigger2 = !SelfAnimExist(5170 + (anim % 10))
	value = 5170

[State 0] ;Hit ground anim (for hit up)
	type = ChangeAnim
	triggerall = time = 0
	triggerall = anim != [5110,5119] ;Not already changed anim
	trigger1 = anim = [5161,5169]
	trigger1 = SelfAnimExist(5170 + (anim % 10))
	value = 5170 + (anim % 10)

[State 0]
	type = PosSet
	trigger1 = Time = 0
	y = 0

[State 0] ;Get fall velocity
	type = VarSet
	trigger1 = Time = 0
	trigger1 = GetHitVar(fall.yvel) != 0
	sysvar(1) = floor(vel y)

[State 0]
	type = PlaySnd
	trigger1 = Time = 0
	trigger1 = !SysVar(0)
	;value = F5000, 0 ;Hit ground
	value = F5000, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 0] ;(Ground Shockwave)
	type = GameMakeAnim
	trigger1 = Time = 0
	trigger1 = !SysVar(0)
	value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
	pos = 0, 0
	under = sysvar(1) <= 10

[State 0]
	type = VelSet
	trigger1 = Time = 0
	y = 0

[State 0] ;For hit up type
	type = ChangeAnim
	persistent = 0
	triggerall = anim = [5171,5179]
	triggerall = SelfAnimExist(5110 + (anim % 10))
	trigger1 = AnimTime = 0
	trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
	value = 5110 + (anim % 10)

[State 0] ;For normal
	type = ChangeAnim
	persistent = 0
	triggerall = Anim != [5111,5119]
	trigger1 = AnimTime = 0
	trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
	value = 5110

;-------------------
[State 0]
	type = SelfState
	triggerall = !alive
	trigger1 = AnimTime = 0
	trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
	trigger3 = Anim = [5110,5119]
	value = 5150

[State 0]
	type = SelfState
	triggerall = alive
	trigger1 = AnimTime = 0
	trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
	trigger3 = Anim = [5110,5119]
	value = StateNo + 1

;-------------------
[State 0]
	type = VarSet
	trigger1 = SysVar(0)
	trigger1 = Time = 0
	sysvar(0) = 0

[State 0] ;Friction
	type = VelMul
	trigger1 = 1
	x = 0.85

[State 0]
	type = ForceFeedback
	trigger1 = alive
	trigger1 = Time = 0
	time = 8
	ampl = 240
	waveform = sine

[State 0]
	type = ForceFeedback
	trigger1 = !alive
	trigger1 = Time = 0
	ampl = 200, 7, -.467
	time = 30
	waveform = sine

;--------------------------------------------------------------
[Statedef 190115]	;getup
type = L
movetype = H
physics = N
anim = 5120
velset = 0, 0
movehitpersist = 1
ctrl = 0

[State 0]
	type = Nothitby
	trigger1 = 1
	value = SCA

[State 0]
	type = PosSet
	trigger1 = Time = 0
	y = 0

[State 0]
	type = SelfState
	trigger1 = AnimTime = 0
	value = StateNo + 1
	ctrl = 0

;--------------------------------------------------------------
[Statedef 190116]	;dizzy
type = S
movetype = U 
	;H :ヒットが連続しますが、投げられません
	;I :投げられますが、ヒットは連続しません
	;U :直前のタイプを継承(=H)

physics = S
anim = 5300
movehitpersist = 1
ctrl = 0
velset = 0, 0, 0

[State 0]
	type = posset
	trigger1 = time = 0
	y = 0

[State 0]
	type = helper
	trigger1 = time = 0
	trigger1 = !NumHelper(403000)
	trigger1 = !NumHelper(403001)
	trigger1 = !NumHelper(403002)
	trigger1 = !NumHelper(403003)
	name = "dizzy birds"
	ID = Ifelse(Life < 200, 403003, 403000 + Random%3)
	Stateno = 190140
	IgnoreHitPause = 1
	type = Helper

[State 0, dizzy sound]
	type = playsnd
	trigger1 = Time%42 = 0
	value = F10400, 0
	channel = 2

[State 0]
	type = PalFx
	trigger1 = NumHelper(90900)
	trigger1 = Helper(90900), var(52)%4 = 1
	trigger1 = PrevStateNo != 190120
	time = 1
	add = 120, 120, 120

[State 0]
	type = SelfState

	trigger1 = Time >= 300

	trigger2 = NumHelper(90900)
	trigger2 = Helper(90900), var(52) > 36
	trigger2 = PrevStateNo != 190120

	trigger3 = PrevStateNo = 190120
	trigger3 = time >= 90

	value = 0
	ctrl = 1


;--------------------------------------------------------------
; birds (helper)

[Statedef 190140]
type = A
physics = N
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible

[State 0]
	type = PlayerPush
	trigger1 = 1
	value = 0

[State 0]
	type = BindToParent
	trigger1 = 1
	pos = 0,  Parent,Const(Size.Head.Pos.Y) - 5
	IgnoreHitPause = 1

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	IgnoreHitPause = 1

;--------
[State 0]
	type = varset
	trigger1 = time = 0
	var(10) = IsHelper(403000)*0 + IsHelper(403001) + IsHelper(403002)*2 + IsHelper(403003)*3


[State 0]
	type = varset
	trigger1 = !var(2)
	var(2) = Ceil((Parent,Const(Size.ground.back) + Parent,Const(Size.ground.front)) * (Parent,Const(Size.Xscale)))

[State 0]
	type = varadd
	trigger1 = 1
	var(1) = 1

[State 0]
	type = varset
	trigger1 = 1
	fvar(7) = var(1) / 180.00 * 3.14 * 4
[State 0]
	type = varset
	trigger1 = 1
	fvar(8) = (var(1) + 120) / 180.00 * 3.14 * 4
[State 0]
	type = varset
	trigger1 = 1
	fvar(9) = (var(1) + 240) / 180.00 * 3.14 * 4


[State 0]
	type = varset
	trigger1 = 1
	fvar(1) = sin(fvar(7)) * var(2)
[State 0]
	type = varset
	trigger1 = 1
	fvar(2) = sin(fvar(8)) * var(2)
[State 0]
	type = varset
	trigger1 = 1
	fvar(3) = sin(fvar(9)) * var(2)
[State 0]
	type = varset
	trigger1 = 1
	fvar(4) = cos(fvar(7)) * var(2)/4
[State 0]
	type = varset
	trigger1 = 1
	fvar(5) = cos(fvar(8)) * var(2)/4
[State 0]
	type = varset
	trigger1 = 1
	fvar(6) = cos(fvar(9)) * var(2)/4


;--------
[State 0] ;birds
	type = Explod
	trigger1 = !var(0)
	anim = F403000 + var(10)
	pos = Floor(fvar(1)), Floor(fvar(4))
	ID = 0
	Sprpriority = Ifelse(fvar(4) > 0, 4, -4)
	scale = 0.5, 0.5
	facing = -1
	bindtime = -1
	removetime = 1
	IgnoreHitPause = 1
[State 0] ;birds
	type = Explod
	trigger1 = !var(0)
	anim = F403000 + var(10)
	pos = Floor(fvar(2)), Floor(fvar(5))
	ID = 0
	Sprpriority = Ifelse(fvar(5) > 0, 4, -4)
	scale = 0.5, 0.5
	facing = -1
	bindtime = -1
	removetime = 1
	IgnoreHitPause = 1
[State 0] ;birds
	type = Explod
	trigger1 = !var(0)
	anim = F403000 + var(10)
	pos = Floor(fvar(3)), Floor(fvar(6))
	ID = 0
	Sprpriority = Ifelse(fvar(6) > 0, 4, -4)
	scale = 0.5, 0.5
	facing = -1
	bindtime = -1
	removetime = 1
	IgnoreHitPause = 1


;--------
[State 0]
	type = varset
	trigger1 = Parent,StateNo != [190111,190120]
	var(0) = 1
	IgnoreHitPause = 1

[State 0]
	type = RemoveExplod
	trigger1 = var(0) && NumExplod(0)
	ID = 0
	IgnoreHitPause = 1

[State 0]
	type = DestroySelf
	trigger1 = var(0)
	IgnoreHitPause = 1




;---------------------------------------------------------------------------
; HIT_GETUP for survival mode

;起き上がり→[State190]へ(サバイバル・モード用)
;---------------------------------------------------------------------------

[Statedef 190220]
type = L
movetype = I
physics = N
sprpriority = 5

[State 0]
	type = ChangeAnim
	triggerall = time = 0
	trigger1 = anim != [5111,5119]
	trigger2 = !SelfAnimExist(5120 + (anim % 10))
	value = 5120

[State 0]
	type = ChangeAnim
	triggerall = time = 0
	trigger1 = anim = [5111,5119]
	trigger1 = SelfAnimExist(5120 + (anim % 10))
	value = 5120 + (anim % 10)

[State 0]
	type = VelSet
	trigger1 = Time = 0
	x = 0

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	time = 1

[State 0]
	type = HitFallSet
	trigger1 = AnimTime = 0
	value = 1

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 180
	ctrl = 0













;--------------------------------------------------------------
; ストライカー処理 [上書き可]
; STRIKER

;--------------------------------------------------------------
; 交代に備える
; 画面から飛出

[Statedef 190190]
type = S
physics = S
anim = 40
ctrl = 0
sprpriority = -2

[State 0] ;変数入換
	type = varset
	trigger1 = time = 0
	sysvar(4) = 0
[State 0] ;変数入換
	type = varset
	trigger1 = time = 0
	sysfvar(4) = 0

[State 0]
	trigger1 = 1
	type = NotHitBy
	value = SCA

; カメラを固定
[State 0]
	type = screenbound
	trigger1 = 1
	value = 0
		
; 飛ぶ方向
[State 0]
	type = VelSet
	trigger1 = AnimTime = 0
	x = -6.666 ;const(velocity.runjump.back.x)
	y = -9.999 ;const(velocity.runjump.y)

[State 0]
	type = ChangeState
	trigger1 = AnimTime = 0
	value = 190191   ;空中へ


;--------------------------------------------------------------
; 離陸/空中処理

[Statedef 190191]
type = A
physics = A
sprpriority = -2

[State 0]
	type = screenbound
	trigger1 = 1
	value = 0

[State 0]
	trigger1 = 1
	type = NotHitBy
	value = SCA

[State 0]
	type = PlaySnd
	trigger1 = Time = 0
	value = F50, 0
	channel = 1

;--------
[State 0]
	type = ChangeAnim
	trigger1 = Time = 0
	value = Ifelse((Vel X)=0, 41, Ifelse((Vel X)>0, 42, 43))

[State 0]
	type = ChangeAnim
	trigger1 = Vel Y > -2
	trigger1 = SelfAnimExist(Anim + 3)
	persistent = 0
	value = Anim + 3

[State 0]
	type = AssertSpecial
	Trigger1 = 1
	Flag = NoShadow

[State 0]
	type = SelfState	
	trigger1 = (ScreenPos X != [-60, 380]) || (ScreenPos Y >= 300)
	Value = 190192




;--------------------------------------------------------------
; 待機中...
;--------------------------------------------------------------

[Statedef 190192]
type = S
movetype = H   ;(A),(I)に変えるとＫＯポーズを取る
physics = S
velset = 0, 0
sprpriority = -2
ctrl = 0

[State 0]
	trigger1 = 1
	type = NotHitBy
	value = SCA
[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
[State 0]
	type = screenbound
	trigger1 = 1
	value = 0
[State 0]
	type = PlayerPush
	trigger1 = 1
	value = 0
[State 0, Freeze]
	type = ChangeAnim
	trigger1 = 1
	value = anim
[State 0]		;プレーヤに合わせる
	type = PosSet
	Trigger1 = 1
	x = Partner,Pos X
	y = -800

;--------
;;[State 0] ; ライフ回復
;;	type = LifeAdd
;;	trigger1 = time > 400 && time%20 = 0
;;	tiggger1 = time = 0 && RoundState = 2
;;	Value = 1

[State 0, LifeSetP2]	;ライフの共有
	type = LifeSet
	Trigger1 = Partner,Life <= 0
	Value  = - 1000 ;Const(Data.Life)

[State 0, SPE]
	type = AssertSpecial
	Trigger1 = 1
	flag = noshadow
	flag2 = nokosnd

;----------------------
; 登場

; - 交代呼出
;[State 0]
;	type = varset
;	trigger1 = RoundState = 2
;	trigger1 = Partner, MoveType != H
;	trigger1 = Partner, NumExplod(800001)	;コマンドの変わりに変数を
;	trigger2 = Partner, Alive = 0
;	trigger2 = Partner,time > 50 && Partner, StateNo = 5150
;	sysfvar(4) = 1
;[State 0]
;	type = varset
;	trigger1 = sysfvar(4) = 1
;	trigger2 = Partner, Alive = 0
;	sysvar(4) = 4

; - ストライカー呼出
[State 0]
	type = ChangeState
	trigger1 = RoundState = 2
	trigger1 = Partner, MoveType != H
	trigger1 = Partner, NumExplod(800000)
	trigger2 = sysfvar(4) = 1
	trigger3 = RoundState > 2 ;試合終了時
	value = 190193





;--------------------------------------------------------------
; 登場/[190193-190195]  *上書きすれば独自のステートが可能
;--------------------------------------------------------------

[Statedef 190193]
type = S
movetype = I
physics = S
velset = 0, 0
sprpriority = -2
ctrl = 0	

[State 0]
	type = ScreenBound
	trigger1 = 1
	value = 0	

[State 0]
	type = AssertSpecial
	Trigger1 = Pos Y < 0
	flag = noshadow

[State 0]
	type = Turn
	triggerall = Partner, facing != facing
	Trigger1 = Time = 0 && RoundState = 2
	Trigger2 = RoundState > 2

[State 0]	;プレーヤに合わせ(#1)
	type = PosSet
	triggerall = Time = 0
	Trigger1 = RoundState = 2 
	x = (Partner,BackEdgeBodyDist + 30) * (-facing) + Partner,Pos X
	y = -180

[State 0]	;プレーヤに合わせ(#2)
	type = PosSet
	Trigger1 = RoundState > 2
	x = Partner, Pos X - Win*facing*40
	y = -280 ;見えてしまう場合はもっと上方修正してください

[State 0]
	type = VelSet
	Trigger1 = RoundState = 2 && Time = 0
	Trigger2 = RoundState > 2 && Time > (!Win) * 100
	x = abs(Pos X - Partner,Pos X) / 16 * (RoundState=2)
	y = abs(Pos Y / 16)

[State 0]
	type = ChangeState		
	trigger1 = RoundState = 2 && Time = 0
	trigger2 = RoundState > 2 && Time > (!Win) * 100
	value = Ifelse( sysfvar(4) = 1, 190194, 190196)
	Ctrl = 0



;--------------------------------------------------------------
; ストライカー出現(上書き専用中間ステート)
; empty states for override
;--------------------------------------------------------------

[Statedef 190196]
type = U
movetype = U

[State 0]
	type = ChangeState
	trigger1 = Time = 0
	value = 190194
	ctrl = 0

;以降(190399まで)自由にステートを追加してください(^^





;--------------------------------------------------------------
; ストライカー出現 (striker appears)
; 交代直接移動
;--------------------------------------------------------------
[Statedef 190194]
type = A
movetype = I
physics = N
sprpriority = -2
anim = Ifelse(SelfAnimExist(44), 44, 41)
ctrl = Ifelse(sysvar(4), 1, 0)

[State 0] ;標記
	type = Explod
	triggerall = !NumExplod(296000)
	triggerall = RoundState = 2
	trigger1 = NumPartner
	trigger1 = sysvar(4) = 0
	ID = 296000
	anim = F296000 + !(Partner,NumExplod(510000))*TeamSide
	sprpriority = 5
	postype = P1
	pos = 0, Const(Size.Head.Pos.Y) - 20
	facing = Ifelse(facing = 1, 1, -1)
	scale = 0.5, 0.5
	ontop = 1
	ownpal = 1
	bindtime = -1
	IgnoreHitPause = 1
	removetime = Ifelse(sysfvar(4) = 1, 30, 99)
	supermovetime = 999999999

[State 0]
	type = ScreenBound
	trigger1 = 1
	value = 0

[State 0]
	type = ChangeState
	trigger1 = Pos Y >= 0
	value = 190195
	ctrl = 0


;--------------------------------------------------------------
;着地 > ラウンド終了 (land > roundover)
;--------------------------------------------------------------

[Statedef 190195]
type = S
movetype = H
physics = S
anim = 47
velset = 0, 0
sprpriority = -2
ctrl = 0

[State 0]
	type = ScreenBound
	trigger1 = 1
	value = 0

[State 0, jump land]
	type = Helper
	trigger1 = Time = 0
	ID = 152000
	Stateno = 152000

[State 0]
	type = PosSet
	trigger1 = Time = 0
	Y = 0



;--------------------------
;なにかいい方法はないのいかな...
;[State 0] ;負け用ヘルパー
;	type = Helper
;	triggerall = NumHelper(80195) = 0
;	triggerall = RoundState > 2
;	trigger1 = AnimTime = 0
;	trigger1 = Lose || DrawGame ;フリーズする時もある...(^^;
;	helpertype = Normal
;	name = "LoserP2"
;	ID = 80195
;	Stateno = Ifelse(SelfAnimExist(170), 170, 175)
;	postype = p1
;	sprpriority = -2
;[State 0]
;	type = PosSet
;	trigger1 = NumHelper(80195)
;	Y = 999999999
;[State 0]
;	type = ChangeState
;	trigger1 = NumHelper(80195)
;	value = 0
;	Ctrl = 1

;--------------------------

;--------------------------
[State 0]
	type = ChangeState
	triggerall = RoundState > 2 
	trigger1 = AnimTime = 0
;;	trigger1 = Win
	value = 0
	Ctrl = 1
;--------------------------

[State 0] ;負け用ヘルパー
	type = ChangeState
	triggerall = RoundState > 2
	trigger1 = AnimTime = 0
	trigger1 = Lose || DrawGame
	value = 170
;;	Ctrl = 1


;--------------------------




; 指定Stateへ＊詳細[State195900]を参照

[State 0]
	type = ChangeState
	trigger1 = sysfvar(4) = 0
	trigger1 = RoundState = 2
	trigger1 = AnimTime = 0
	value = Ifelse(!var(59), 1000, var(59))
	Ctrl = 0


[State 0]
	type = ChangeState
	trigger1 = sysfvar(4) = 1
	trigger1 = AnimTime = 0
	value = 0
	Ctrl = 1



















;==============================================================
; ヘルパー用ステート
;==============================================================

;==============================================================
;超必殺勝利演出用ヘルパー (helper State of "hyper combo finish")
;==============================================================
[Statedef 99999]
ctrl = 0

; 退場! ...(^^; 他にいい方法は…
[State 0]
	type = PosSet
	trigger1 = Time = 0
	x = 99999
	y = 99999

[State 0]
	type = varset
	trigger1 = Root,NumExplod(120505) = 0
	var(0) = 1

[State 0]
	type = AssertSpecial
	trigger1 = NumExplod(99999)
	flag = nobg
	flag2 = nofg
	flag3 = invisible
	IgnoreHitPause = 1

[State 0]
	Type = EnvShake
	trigger1 = 1
	Time = 1
	Ampl = 0

[State 0]
	type = PlaySnd
	trigger1 = var(0) && !var(1)
	trigger1 = !NumExplod(99999)
	value = F3000,0 ;[dokkan...!]
	persistent = 0
	IgnoreHitPause = 1

[State 0]
	type = PlaySnd
	trigger1 = var(0) && !var(1)
	value = F10300, 3 ;[hyper combo finish!]
	persistent = 0
	IgnoreHitPause = 1

[State 0]
	type = Explod
	trigger1 = var(0) && !var(1)
	trigger1 = !NumExplod(99999)
	anim = F3000
	ID = 99999
	postype = Left
	sprpriority = -3
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	persistent = 0
	IgnoreHitPause = 1

[State 0]
	type = varset
	trigger1 = NumExplod(99999)
	var(1) = 1
	IgnoreHitPause = 1




;==============================================================
;スーパーコンボ効果用ヘルパー(SuperPause Helper)
;==============================================================
;Level 1

[Statedef 88880]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	IgnoreHitPause = 1

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

;;[State 0]  ;キャラデータによる補正
;;	type = PosSet
;;	trigger1 = time = 0
;;	x = Pos X * Root,Const(Size.XScale)
;;	y = Pos Y * Root,Const(Size.YScale)

;-------------
[State 0] ; type
	type = varset
	trigger1 = time = 0
	var(20) = Root,sysvar(4)

[State 0] ; timer of superpause
	type = varset
	trigger1 = time = 0
	var(0) = 28

;--------------
[State 0]
	type = Pause
	trigger1 = RoundState = 2
	trigger1 = time = 0
	time = var(0)

[State 0]
	type = PlaySnd
	trigger1 = RoundState = 2
	trigger1 = time = 0
	value = F2000, 0
	IgnoreHitPause = 1

;---------------------
;type 1 or 4
[State 0]
	type = BGPalFX
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 1 || var(20) = 4
	add = 0, 0, 0
	mul = 85, 85, 85
	invertall = 0
	time = var(0)
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]  ;BG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 1 || var(20) = 4
	anim = F100
	ID = 1
	sprpriority = -7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 1 || var(20) = 4
	anim = F30020
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

;---------------------
;type 2
[State 0]
	type = BGPalFX
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 2
	add = 0, 0, 0
	mul = 50, 50, 50
	invertall = 0
	time = var(0)
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1


[State 0]  ;BG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 2
	anim = F30000
	ID = 1
	sprpriority = -7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 2
	anim = F30020
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 2
	anim = F30001
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

;---------------------
;type 3
[State 0]
	type = BGPalFX
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 3
	add = 0, 0, 0
	mul = 30, 30, 30
	invertall = 0
	time = var(0)
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]  ;BG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = NumExplod(1) = 0
	trigger1 = var(20) = 3
	anim = F30100
	ID = 1
	sprpriority = -7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = NumExplod(1) = 1
	trigger1 = var(20) = 3
	anim = F30101
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1


;---------------------
[State 0]
	type = DestroySelf
	trigger1 = time > 0




;---------------------------------------------
;Level 2 (MAX)

[Statedef 88882]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	IgnoreHitPause = 1

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

;-------------
[State 0] ; type
	type = varset
	trigger1 = time = 0
	var(20) = Root,sysvar(4)

[State 0] ; timer of superpause
	type = varset
	trigger1 = time = 0
	var(0) = 42

;--------------
[State 0]
	type = Pause
	trigger1 = RoundState = 2
	trigger1 = time = 0
	time = var(0)

[State 0]
	type = PlaySnd
	trigger1 = RoundState = 2
	trigger1 = time = 0
	value = F2000, 2
	IgnoreHitPause = 1

;---------------------
;type 1 or 4
[State 0]
	type = BGPalFX
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 1 || var(20) = 4
	add = 0, 0, 0
	mul = 50, 50, 50
	invertall = 0
	time = var(0)
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]  ;BG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 1 || var(20) = 4
	anim = F102
	ID = 1
	sprpriority = -7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 1 || var(20) = 4
	anim = F30021
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

;---------------------
;type 2
[State 0]
	type = BGPalFX
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 2
	add = 0, 0, 0
	mul = 40, 40, 40
	invertall = 0
	time = var(0)
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1


[State 0]  ;BG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 2
	anim = F30010
	ID = 1
	sprpriority = -7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 2
	anim = F30021
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 2
	anim = F30011
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

;---------------------
;type 3
[State 0]
	type = BGPalFX
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = var(20) = 3
	add = 0, 0, 0
	mul = 0, 0, 0
	invertall = 0
	time = var(0)
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]  ;BG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = NumExplod(1) = 0
	trigger1 = var(20) = 3
	anim = F30110
	postype = Left
	ID = 1
	sprpriority = -7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = NumExplod(1) = 1
	trigger1 = var(20) = 3
	anim = F30111
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1


;---------------------
[State 0]
	type = DestroySelf
	trigger1 = time > 0






;---------------------------------------------
;Level MAX2

[Statedef 88883]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	IgnoreHitPause = 1

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

[State 0]
	type = varset
	trigger1 = time = 0
	var(0) = 42

[State 0]
	type = Pause
	trigger1 = time = 0
	time = var(0)

[State 0]
	type = BGPalFX
	trigger1 = RoundState = 2
	trigger1 = time = 0
	add = 0, 0, 0
	mul = 50, 50, 50
	invertall = 0
	time = var(0)
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]
	type = PlaySnd
	trigger1 = RoundState = 2
	trigger1 = time = 0
	value = F2000, 2
	IgnoreHitPause = 1

[State 0]
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	trigger1 = !NumExplod(1)
	anim = F30300
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 0
	anim = F30101
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

[State 0]
	type = DestroySelf
	trigger1 = time > 0




;==============================================================
;MAX2効果用ヘルパー(MAX2 Helper)
;==============================================================

[Statedef 88870]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	IgnoreHitPause = 1

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = NoBG
	flag2 = NoFG
;opts;	flag3 = NoBarDisplay
	IgnoreHitPause = 1

;-------[init]

[State 0]
	type = varset
	trigger1 = time = 0
	var(1) = IsHelper(88870)*0 + IsHelper(88871)*1 + IsHelper(88872)*2 + IsHelper(88873)*3 + IsHelper(88874)*4 + IsHelper(88875)*5 + IsHelper(88876)*6 + IsHelper(88877)*7 + IsHelper(88878)*8
	IgnoreHitPause = 1

[State 0]
	type = varset
	trigger1 = time = 0
	var(20) = Ifelse(Root,facing = 1, 1, -1)
	IgnoreHitPause = 1

;-------
[State 0] ;BG
	type = Explod
	trigger1 = time = 0
	ID = 1
	anim = F3501 + var(1)
	sprpriority = -7
	postype = Left
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	scale = 32, 1
	bindtime = -1
	ownpal = 1
	IgnoreHitPause = 1


;LINES(1-3) x 12++
[State 0]
	type = Explod
	triggerall = NumExplod(11) < 2
	trigger1 = time%2 = 0
	ID = 11
	anim = F3511
	sprpriority = -6
	postype = Left
	facing = Ifelse(var(20) = 1, 1, -1)
	pos = Ifelse(var(20) = 1, -120, 440), Random%240
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = 1
	ownpal = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	triggerall = NumExplod(12) < 2
	trigger1 = time%2 = 0
	ID = 12
	anim = F3512
	sprpriority = -6
	postype = Left
	facing = var(20)
	pos = Ifelse(var(20) = 1, -120, 440), Random%240
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = 1
	ownpal = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	triggerall = NumExplod(13) < 2
	trigger1 = time%2 = 0
	ID = 13
	anim = F3513
	sprpriority = -6
	postype = Left
	facing = var(20)
	pos = Ifelse(var(20) = 1, -240, 680), Random%240
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = 1
	ownpal = 1
	IgnoreHitPause = 1

;--------
[State 0] ;stop max2 bg eff
	type = varset
	triggerall = Root,NumExplod(88879) = 0

	trigger1 = Root,Ctrl
	trigger2 = Root,StateNo < 1000
	trigger3 = Root,MoveType = H
	trigger4 = RoundState != 2
	trigger5 = Root,NumExplod(88870)

	trigger6 = Root,NumHelper(88870) > 1 || Root,NumHelper(88871) > 1 || Root,NumHelper(88872) > 1 || Root,NumHelper(88873) > 1
	trigger7 = Root,NumHelper(88874) > 1 || Root,NumHelper(88875) > 1 || Root,NumHelper(88876) > 1 || Root,NumHelper(88877) > 1 || Root,NumHelper(88878) > 1

	trigger8 = NumEnemy
	trigger8 = Enemy,NumHelper(88870) || Enemy,NumHelper(88871) || Enemy,NumHelper(88872) || Enemy,NumHelper(88873) || Enemy,NumHelper(88874)
	trigger9 = NumEnemy
	trigger9 = Enemy,NumHelper(88875) || Enemy,NumHelper(88876) || Enemy,NumHelper(88877) || Enemy,NumHelper(88878)

	var(0) = 1
	IgnoreHitPause = 1

[State 0]
	type = RemoveExplod
	trigger1 = var(0)
	ID = 1
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	trigger1 = var(0)
	ID = 11
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	trigger1 = var(0)
	ID = 12
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	trigger1 = var(0)
	ID = 13
	IgnoreHitPause = 1


[State 0]
	type = DestroySelf
	trigger1 = var(0)



;--------------------------------------
;TYPE 2

[Statedef 88871]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	IgnoreHitPause = 1

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = NoBG
	flag2 = NoFG
;;;	flag3 = NoBarDisplay
	IgnoreHitPause = 1

;-------
[State 0]
	type = Explod
	trigger1 = time = 0
	ID = 1
	anim = F3511
	sprpriority = -7
	postype = Left
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	IgnoreHitPause = 1

[State 0]
	type = Explod
	trigger1 = time = 0
	ID = 1
	anim = F3512
	sprpriority = -7
	postype = Left
	pos = 319, 0
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	IgnoreHitPause = 1

;-------
[State 0]
	type = RemoveExplod
	trigger1 = Root,Ctrl
	trigger2 = Root,StateNo < 1000
	trigger3 = Root,MoveType = H
	trigger4 = RoundState != 2
	trigger5 = Root,NumExplod(88870)
	ID = 1

[State 0]
	type = DestroySelf
	trigger1 = Root,Ctrl
	trigger2 = Root,StateNo < 1000
	trigger3 = Root,MoveType = H
	trigger4 = RoundState != 2
	trigger5 = Root,NumExplod(88870)



;--------------------------------------
;TYPE 3

[Statedef 88872]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	IgnoreHitPause = 1

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = NoBG
	flag2 = NoFG
;;;	flag3 = NoBarDisplay
	IgnoreHitPause = 1

[State 0]
	type = Explod
	trigger1 = time = 0
	ID = 1
	anim = F3521
	sprpriority = -7
	postype = Left
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	IgnoreHitPause = 1

;-------
[State 0]
	type = RemoveExplod
	trigger1 = Root,Ctrl
	trigger2 = Root,StateNo < 1000
	trigger3 = Root,MoveType = H
	trigger4 = RoundState != 2
	trigger5 = Root,NumExplod(88870)
	ID = 1

[State 0]
	type = DestroySelf
	trigger1 = Root,Ctrl
	trigger2 = Root,StateNo < 1000
	trigger3 = Root,MoveType = H
	trigger4 = RoundState != 2
	trigger5 = Root,NumExplod(88870)





;==============================================================
; ブレ−キング効果用ヘルパー(Breaking Helper)
;==============================================================
;Level 1

[Statedef 88890]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	IgnoreHitPause = 1

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

;; キャラデータによる補正
;;[State 0]
;;	type = PosSet
;;	trigger1 = time = 0
;;	x = Pos X * Root,Const(Size.XScale)
;;	y = Pos Y * Root,Const(Size.YScale)

;-------------
;init

[State 0]
	type = varset
	trigger1 = time = 0
	var(2) = 32
[State 0]
	type = varset
	trigger1 = time = 0
	var(10) = 256

;-------------
[State 0]
	type = varset
	trigger1 = Parent,MoveType = H
	var(3) = 1
	IgnoreHitPause = 1


[State 0]
	type = PlaySnd
	trigger1 = RoundState = 2
	trigger1 = time = 0
	value = F2100, 1
	IgnoreHitPause = 1

;---------------------

;---------------------
[State 0]
	type = varadd
	trigger1 = time > 0
	trigger1 = var(10) > 80
	var(10) = -15

[State 0]
	type = BGPalFX
	trigger1 = RoundState = 2
	trigger1 = time > 0
	add = 0, 0, 0
	mul = var(10), var(10), var(10)
	invertall = 0
	time = 1
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1

;--------
[State 0]  ;BG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 6
	anim = F30010
	ID = 1
	sprpriority = -7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	IgnoreHitPause = 1
	scale = 0.5, 0.5

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 6
	anim = F30020
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1
	scale = 0.25, 0.25

[State 0]  ;FG
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = time = 6
	anim = F30011
	ID = 1
	sprpriority = 7
	Supermovetime = 999999999
	Pausemovetime = 999999999
	Bindtime = -1
	Ownpal = 1
	ontop = 1
	IgnoreHitPause = 1
	scale = 0.25, 0.25

;--------
[State 0]
	type = RemoveExplod
	trigger1 = var(3)
	id = 1
	IgnoreHitPause = 1

;---------------------
[State 0]
	type = DestroySelf
	trigger1 = time > var(2)
	trigger2 = var(3)
	IgnoreHitPause = 1













;==============================================================
; ブロッキング/JD用ヘルパー (helper of BLOCKING/JD)
;==============================================================
[Statedef 99997]
type = A
movetype = H ; memo damage
physics = N
ctrl = 0
poweradd = 0
anim = (Root,Statetype = C) * 11 + (Root,Statetype = A) * 41

;----------------アニメ設定
[State 0]
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = Root,Statetype = A
	trigger1 = Root,sysfvar(1) < 2  ;; << N,Lジャンプ
	value = Ifelse((Root,vel x) = 0, 41, Ifelse((Root,vel x) > 0, 42, 43))

[State 0]
	type = ChangeAnim
	trigger1 = Time = 0
	trigger1 = Root,Statetype = A
	trigger1 = Root,sysfvar(1) >= 2  ;; << M,Sジャンプ
	value = 41

; 落下アニメがあれば...
[State 0]
	type = ChangeAnim
	trigger1 = Root,Statetype = A
	trigger1 = Root,vel y > -2
	trigger1 = Root,SelfAnimExist(Anim + 3)
	persistent = 0
	value = Anim + 3

;----------------
[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
;op;	flag = NoAutoTurn

[State 0]
	type = PlayerPush
	trigger1 = 1
	value = 0

;-----------------
; 座標設定
; *スパークを表示させないための意図的な"オフセット"です。
; position reset
; *"offset" for erasing sparks intentionally...except proj (--;

[State 0]
	type = posset
	trigger1 = 1
	X = Root, pos X - 420
	Y = Root, Pos Y - 240
	IgnoreHitPause = 1

[State 0]
	type = offset
	trigger1 = 1
	x = 420
	y = 240
	IgnoreHitPause = 1

;-----------------
; 成功(攻撃に合わせる)
[State 0]
	type = HitOverride
	trigger1 = 1
;op;	attr = SCA, AA, AT, AP
	attr = SCA, NA, SA, HA, NP, SP, HP
	time = -1
	slot = 0 ;7
	Stateno = 99996
;op;	forceair = 1  ;; << 浮かす(必要ない)
	IgnoreHitPause = 1
	sparkno = -1 ;; << 効果なし

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = , AT
	IgnoreHitPause = 1


; 終了/失敗
[State 0]
	type = ChangeState
;or;	trigger1 = Root,sysvar(4) = 2
	trigger1 = IsHelper(99997)
	trigger1 = Time > 5 ;; << 受付時間の長さ
;or;	trigger2 = Root,sysvar(4) = 3
	trigger2 = IsHelper(99998)
	trigger2 = Time > 9 ;; << 受付時間の長さ
	trigger3 = Root,Ctrl = 0
	trigger4 = Root,StateNo = 195500
	value = 99995




;-----------------
; 成功
[Statedef 99996]
type = A
movetype = H ; <<情報取得のための"H"
physics = N
ctrl = 0
poweradd = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible

[State 0]
	type = PosSet
	trigger1 = Time = 0
	x = 99999
	y = 99999

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

; 硬直時間取得
;;  * GetHitVar(hitshaketime)
[State 0]
	type = varset
	trigger1 = time = 0
	var(0) = EnemyNear,HitPauseTime + 1

[State 0]
	type = ChangeState
	triggerall = time > 3
	trigger1 = time > var(0) + 3
	value = 99995
	IgnoreHitPause = 1


;-----------------
; 失敗/終了
[Statedef 99995]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1 
	flag = invisible
[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

[State 0]
	type = DestroySelf

;or;	trigger1 = Root,sysvar(4) = 2
	trigger1 = IsHelper(99997)
	trigger1 = Root,StateNo != 195500
	trigger1 = Root,Command != "holdfwd"

;or;	trigger2 = Root,sysvar(4) = 3
	trigger2 = IsHelper(99998)
	trigger2 = Root,StateNo != 195500
	trigger2 = Root,Command != "holdback"

	;-----------
	;一度成功すると、後を押し続ければ、
	;相手のヒットが中断するまで連続JDになります。

;or;	trigger3 = Root,sysvar(4) = 3
	trigger3 = IsHelper(99998)
	trigger3 = Root,StateNo = 195500
	trigger3 = Root,Command = "holdback"

	IgnoreHitPause = 1
















;==============================================================
;[RANKING] ランキング(＆表示)用ヘルパー/ranking helper State
;==============================================================

[Statedef 99980]
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	flag2 = NoBarDisplay

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

; reset hits combo
[State 0]
	type = HitAdd
	trigger1 = time > 0
	value = -999

;------------------------------
; drawing flag
[State 0]
	type = varset
	triggerall = time = 0 && Win
	trigger1 = Root,Alive
	trigger1 = !NumPartner
	trigger2 = NumPartner
	trigger2 = Root,Alive || Partner,Alive
	var(9) = 1



;------------------------------
; var(31):	lifebar draw x
; var(32):	lifebar draw y
; var(33):	powerbar draw x
; var(34):	powerbar draw y
; fvar(3-5):	bar scale(w or h)

; pos init
;[State 0]
;	type = varset
;	trigger1 = time = 0
;	var(31) = Ifelse(TeamSide = 1, 26, 292)
[State 0]
	type = varset
	trigger1 = time = 0
	var(32) = 62

[State 0]
	type = varset
	trigger1 = time = 0
	var(31) = Ifelse(TeamSide = 1, -196, 502)

[State 0]
	type = varadd
	trigger1 = time = [100,110]
	var(31) = Ifelse(TeamSide = 1, 20, -20)
[State 0]
	type = varadd
	trigger1 = time%5 = 0 && time = [110,300]
	var(31) = Ifelse(TeamSide = 1, 1, -1)
[State 0]
	type = varadd
	trigger1 = time > 300
	var(31) = Ifelse(TeamSide = 1, 1, -1) * (time-300)*3





;------------------------------
; 各ボーナス計算
;------------------------------
; get hit bonus
[State 0]
	type = varset
	trigger1 = time = 0 && var(9)
	fvar(13) = Ifelse(fvar(3) = 0, 30, Floor(fvar(13) / (fvar(3) + fvar(13) + 0.001) * 30))

; get guard bonus
[State 0]
	type = varset
	trigger1 = time = 0 && var(9)
	fvar(14) = 30 - Ifelse(fvar(4) / 12 >= 1, 30, Floor(fvar(4) / 12.00 * 30))

; get life bonus
[State 0]
	type = varset
	trigger1 = time = 0 && var(9)
	trigger1 = !NumPartner
	var(1) = Ifelse(Root,Life >= Const(Data.Life)-1, 30, Floor(Root,Life/1.00/Const(Data.Life)*30))
[State 0]
	type = varset
	trigger1 = time = 0 && var(9)
	trigger1 = NumPartner
	var(1) = Ifelse((Root,Life + Partner,Life) >= Const(Data.Life)*2-1, 30, Floor((Root,Life + Partner,Life)/2.00/Const(Data.Life)*30))

; hp finish helper
[State 0]
	type = varset
	trigger1 = time = 0 && var(45) < 2
	trigger1 = Root,NumHelper(99999)
	var(45) = 2
; get tech bonus
[State 0]
	type = varset
	trigger1 = time = 0 && var(9)
	fvar(15) = (var(48)=2)*5 + var(45)*5 + Floor(fvar(4) + fvar(5) + fvar(6) + fvar(7))
[State 0]
	type = varset
	trigger1 = time = 0 && var(9)
	trigger1 = fvar(15) > 30
	fvar(15) = 30

; Rank
[State 0]
	type = varset
	trigger1 = time = 0 && var(9)
	var(2) = Floor(fvar(13) + fvar(14) + fvar(15)) + var(1)
[State 0]
	type = varset
	trigger1 = time = 0 && var(9)
	var(2) = Ifelse(var(2) < 20, 0, Ifelse(var(2) > 99, 14, var(2) / 8))


;--------------------------------
; 配置を整える
[State 0]
	type = varset
	trigger1 = time = 0
	var(33) = (28 - var(2) * 2) * Ifelse(TeamSide = 1, 1, -1)
[State 0]
	type = varset
	trigger1 = time = 0
	var(34) = (var(48) != 2)*6 + (var(1) != 30)*6 + (var(45) = 0)*6


; 得点動態表示
[State 0]
	type = varset
	trigger1 = time = 1
	var(57) = var(58)
[State 0]
	type = varset
	trigger1 = time = 1
	var(58) = 0
[State 0]
	type = varadd
	trigger1 = time > 120 && var(58) < var(57)
	trigger1 = var(51) < 1
	var(58) = 1 + (var(58)<var(57)-20)*(Random%9) + (var(58)<var(57)-200)*(Random%9*10) + (var(58)<var(57)-2000)*(Random%99*10) + (var(58)<var(57)-20000)*(Random%999*10)


; バー縮尺
;------------
[State 0]
	type = varset
	trigger1 = time = 1
	fvar(2) = 0.40
[State 0]
	type = varadd
	trigger1 = time > 110
	fvar(2) = 0.01
[State 0]
	type = varset
	trigger1 = fvar(2) > 0.5
	fvar(2) = 0.5
;------------
[State 0]
	type = varset
	trigger1 = time = 1
	fvar(3) = 0
[State 0]
	type = varadd
	trigger1 = time > 120 && fvar(3) < 0.5
	fvar(3) = 0.1
;------------
[State 0]
	type = varset
	trigger1 = time = 1
	fvar(4) = 0
[State 0]
	type = varadd
	trigger1 = time > 130 && fvar(4) < 0.5
	fvar(4) = 0.1
;------------
[State 0]
	type = varset
	trigger1 = time = 1
	fvar(5) = 0
[State 0]
	type = varadd
	trigger1 = time > 140 && fvar(5) < 0.5
	fvar(5) = 0.1
;------------




;--------------------------------
;描画部分(drawing)
;--------------------------------

; 全描画を初期化
[State 0]
	type = RemoveExplod
	trigger1 = time = 0



;--------------------------------
; K.O.
;---------------------------------
; sound "K.O."
[State 0]
	type = PlaySnd
	triggerall = time = 0 && var(9)
	trigger1 = Root,WinKo
	trigger2 = NumPartner
	trigger2 = Partner,WinKO
	value = F20000, 20
	channel = 1

[State 0]
	type = Explod
	triggerall = time = 0 && var(9)
	triggerall = !NumExplod(199300)
	trigger1 = Root,WinKo
	trigger2 = NumPartner
	trigger2 = Partner,WinKO
	anim = F199302 + (TeamSide - 1)
	ID = 199300
	postype = Left
	sprpriority = 5
	pos = 164, 124
	scale = 0.5, 0.5
	bindtime = -1
	vel = Ifelse(TeamSide = 1, 1, -1) , 0
	ownpal = 1
	ontop = 1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	triggerall = time = 0 && var(9)
	triggerall = NumExplod(199300) = 1
	trigger1 = Root,WinKo
	trigger2 = NumPartner
	trigger2 = Partner,WinKO
	anim = F199300 + (TeamSide - 1)
	ID = 199300
	postype = Left
	sprpriority = 7
	pos = 160, 120
	scale = 0.5, 0.5
	bindtime = -1
	vel = Ifelse(TeamSide = 1, 1, -1) , 0
	ownpal = 1
	ontop = 1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1
	trans = none






;--------------------------------

;--------------------------------
; 下地
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160200
	postype = Left
	facing = Ifelse(TeamSide = 1, 1, -1)
	pos = var(31) + Ifelse(TeamSide = 1, 58, -58), var(32) + 22
	scale = fvar(2), fvar(2)
	sprpriority = -4
	bindtime = -1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160201
	postype = Left
	facing = Ifelse(TeamSide = 1, 1, -1)
	pos = var(31) + Ifelse(TeamSide = 1, 58, -58), var(32) + 22
	scale = fvar(2), fvar(2)
	sprpriority = -4
	bindtime = -1



;--------------------------------

;--------------------------------
; 先制攻撃
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = var(48) = 2
	id = 11
	anim = F160020
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 56, -56), var(32) + 22 + var(34)
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, fvar(3)
	sprpriority = -1
	bindtime = -1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = var(48) = 2
	id = 10
	anim = F160030
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 56, -56), var(32) + 22 + var(34)
	scale = 0.5, fvar(3)
	sprpriority = 0
	bindtime = -1


; パーフェクト勝利  (perfect match)
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = var(1) = 30 ; << 計算後
	id = 11
	anim = F160021
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 56, -56), var(32) + 22 + (var(48) = 2) * 12 + var(34)
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, fvar(3)
	sprpriority = -1
	bindtime = -1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = var(1) = 30 ; << 計算後
	id = 10
	anim = F160033
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 56, -56), var(32) + 22 + (var(48) = 2) * 12 + var(34)
	scale = 0.5, fvar(3)
	sprpriority = 0
	bindtime = -1


; スーパー・フィニッシュ (super/hyper finish message)
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = var(45) > 0
	id = 11
	anim = F160022
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 56, -56), var(32) + 22 + ((var(48) = 2) + (var(1) = 30)) * 12 + var(34)
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, fvar(3)
	sprpriority = -1
	bindtime = -1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = var(45) > 0
	id = 10
	anim = F160030 + var(45)
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 56, -56), var(32) + 22 + ((var(48) = 2) + (var(1) = 30)) * 12 + var(34)
	scale = 0.5, fvar(3)
	sprpriority = 0
	bindtime = -1






;--------------------------------

;--------------------------------
; lights----
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160005
	sprpriority = -1
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 0, - Floor(fvar(15) + fvar(13) + fvar(14)) - var(1)), var(32) + var(34)
	scale = Floor(fvar(13) + fvar(14) + fvar(15)) + var(1) + 2, fvar(4)
	bindtime = -1

; leftbar
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160000
	postype = Left
	pos = var(31) + var(33), var(32) + var(34)
	sprpriority = 0
	bindtime = -1
	scale = 0.5, fvar(4)

; tech
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160004
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 2, - Floor(fvar(15))), var(32) + var(34)
	sprpriority = 0
	bindtime = -1
	scale = fvar(15), fvar(4)

; hit
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160001
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 2 + Floor(fvar(15)), - Floor(fvar(15) + fvar(13))), var(32) + var(34)
	sprpriority = 0
	bindtime = -1
	scale = fvar(13), fvar(4)

; guard
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160002
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 2 + Floor(fvar(15) + fvar(13)), - Floor(fvar(15) + fvar(13) + fvar(14))), var(32) + var(34)
	sprpriority = 0
	bindtime = -1
	scale = fvar(14), fvar(4)

; life
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160003
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 2 + Floor(fvar(15) + fvar(13) + fvar(14)), - Floor(fvar(15) + fvar(13) + fvar(14)) - var(1)), var(32) + var(34)
	sprpriority = 0
	bindtime = -1
	scale = var(1), fvar(4)


;------------------------------
; tech
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = fvar(15) > 10
	anim = F160013
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 2 + Floor(fvar(15)/2), - 5 - Floor(fvar(15)/2) ), var(32) + 8 + var(34)
	scale = 0.5, fvar(4)
	sprpriority = 0
	bindtime = -1

; hit
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = fvar(13) > 1
	anim = F160011
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 2 + Floor(fvar(15) + fvar(13)/2), - Floor(fvar(15) + fvar(13)/2) ), var(32) + 4 + var(34)
	scale = 0.5, fvar(4)
	sprpriority = 0
	bindtime = -1

; guard
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = fvar(14) > 1
	anim = F160010
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 2 + Floor(fvar(15) + fvar(13) + fvar(14)/2), - Floor(fvar(15) + fvar(13) + fvar(14)/2) ), var(32) + 8 + var(34)
	scale = 0.5, fvar(4)
	sprpriority = 0
	bindtime = -1

; life
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	trigger1 = var(1) > 1
	anim = F160012
	postype = Left
	pos = var(31) + var(33) + Ifelse(TeamSide = 1, 2 + Floor(fvar(15) + fvar(13) + fvar(14) + var(1)/2), - Floor(fvar(15) + fvar(13) + fvar(14) + var(1)/2) ), var(32) + 4 + var(34)
	scale = 0.5, fvar(4)
	sprpriority = 0
	bindtime = -1



;--------------------------------------------------------------
; Rank
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160150
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 22, -20), var(32) - 28
	sprpriority = -2
	scale = 0.5, fvar(5)
	bindtime = -1
;--;	trans = sub ; add1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160150
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 22, -20), var(32) - 28
	sprpriority = -1
	scale = 0.5, fvar(5)
	bindtime = -1
	trans = add
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9)
	anim = F160100 + var(2)
	postype = Left
	pos = var(31) + Ifelse(TeamSide = 1, 22, -20), var(32) - 28
	sprpriority = 0
	scale = 0.5, fvar(5)
	bindtime = -1
	trans = add


;---------------------
; win sound
[State 0]
	type = PlaySnd
	triggerall = var(9)
	trigger1 = time = 120
	value = F10300, Ifelse(var(51) > 0, 1, 0)

; perfect sound
[State 0]
	type = PlaySnd
	triggerall = var(9)
	trigger1 = time = 160 && var(51) < 1
	trigger1 = var(1) = 30 ; << 計算後
	value = F10300, 2


;--------------------------------------------------------------
; 点数・ボーナス表示(scores and bonus)
;--------------------------------------------------------------

; score
[State 0]
	type = varadd
	trigger1 = time = 0 && var(9)
	var(58) = var(2) * 250

; 親に加算
[State 0]
	type = ParentVarSet
	trigger1 = time = 0
	trigger1 = Root,sysvar(4)
	trigger1 = var(58) > Root,var(58)
	var(58) = var(58)


;-----------------
; 点数描画(score)

[State 0]
	type = Explod
	trigger1 = time > 11 && var(9) && var(58) > 0
	anim = F300000 + var(58)%10
	postype = Left
	pos = var(31) + Ifelse(TeamSide=1,0,-70) + Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 54, -9), var(32) - 20
	sprpriority = -1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	removetime = 1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9) && var(58) > 9
	anim = F300000 + var(58)/10%10
	postype = Left
	pos = var(31) + Ifelse(TeamSide=1,0,-70) + Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 45, -18), var(32) - 20
	sprpriority = -1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	removetime = 1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9) && var(58) > 99
	anim = F300000 + var(58)/100%10
	postype = Left
	pos = var(31) + Ifelse(TeamSide=1,0,-70) + Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 36, -27), var(32) - 20
	sprpriority = -1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	removetime = 1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9) && var(58) > 999
	anim = F300000 + var(58)/1000%10
	postype = Left
	pos = var(31) + Ifelse(TeamSide=1,0,-70) + Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 27, -36), var(32) - 20
	sprpriority = -1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	removetime = 1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9) && var(58) > 9999
	anim = F300000 + var(58)/10000%10
	postype = Left
	pos = var(31) + Ifelse(TeamSide=1,0,-70) + Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 18, -45), var(32) - 20
	sprpriority = -1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	removetime = 1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9) && var(58) > 99999
	anim = F300000 + var(58)/100000%10
	postype = Left
	pos = var(31) + Ifelse(TeamSide=1,0,-70) + Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 9, -54), var(32) - 20
	sprpriority = -1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	removetime = 1
[State 0]
	type = Explod
	trigger1 = time > 11 && var(9) && var(58) > 999999
	anim = F300000 + var(58)/1000000%10
	postype = Left
	pos = var(31) + Ifelse(TeamSide=1,0,-70) + Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9, -63), var(32) - 20
	sprpriority = -1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	removetime = 1













;; 消す
;-;[State 0]
;-;	type = DestroySelf
;-;	trigger1 = time > 0 && !var(9)












;==============================================================
;[RANKING] ランキング(＆表示)用ヘルパー/ranking helper State
;サバイバル・モード用 for survival mode(team mode)
;==============================================================
;var(0)  ranking/grade

;var(5)  draw pos Y

;var(10) scores
;var(11) wins

[Statedef 99985]
ctrl = 0

[State 0]
	type = PosSet
	trigger1 = Time = 0
	x = 99999999
	y = 99999999

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible

[State 0]
	type = AssertSpecial
	trigger1 = time < 9000
	flag = RoundNotOver

;------------------------------
;INIT

[State 0]
	type = varset
	trigger1 = Time = 0
	var(5) = 52


;------------------------------
[State 0]	;get players scores
	type = varset
	triggerall = Time = 0
	trigger1 = NumEnemy
	trigger1 = Enemy,sysvar(4)
	var(10) = Enemy,var(58)

;--------------------------------------------------------------
;描画部分(drawing)

[State 0, bar]
	type = Explod
	trigger1 = time = 50
	id = 0
	anim = F5600
	sprpriority = 2
	postype = Left
	pos = 0, var(5)
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ontop = 1
	IgnoreHitPause = 1

;--------------------------------------------------------------
;ランキング(総合) ranking
;--------------------------------------------------------------
[State 0, rank]
	type = VarSet
	trigger1 = Time = 0
	trigger1 = NumEnemy
	trigger1 = Enemy,sysvar(4)
	var(0) = Enemy,var(58)%100

;--------------
[State 0, rank]
	type = Explod
	trigger1 = time = 100
	id = 1
	anim = F160100 + var(0)
	sprpriority = 6
	postype = Left
	pos = 120, var(5) + 30
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ontop = 1
	IgnoreHitPause = 1


;--------------------------------------------------------------
;勝利数 (wins)
;--------------------------------------------------------------
[State 0, wins]
	type = VarSet
	trigger1 = Time = 0
	var(11) = RoundNo - 1

; 勝利数描画
[State 0, scr]
	type = Explod
	triggerall = time > 100
	triggerall = var(11) > 0
	trigger1 = NumExplod(11) < Floor(Log(10, var(11))) + 1
	id = 11
	anim = F300000 + var(11)/(10**Ifelse(NumExplod(11)=5, 6, Ifelse(NumExplod(11)=6, 5, NumExplod(11)))) % 10
	postype = Left
	pos = 155 + Floor(Log(10, var(11))) * 9 - NumExplod(11) * 9 , var(5) + 70
	sprpriority = 7
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ontop = 1
	IgnoreHitPause = 1
	scale = 0.5, 0.5

;--------------------------------------------------------------
;点数・ボーナス表示 (scores and bonus)
;--------------------------------------------------------------

; 点数描画
[State 0, score]
	type = Explod
	triggerall = Time > 100
	trigger1 = NumExplod(10) < Floor(Log(10, var(10))) + 1
	id = 10
	anim = F300000 + var(10)/(10**Ifelse(NumExplod(10)=5, 6, Ifelse(NumExplod(10)=6, 5, NumExplod(10)))) % 10
	postype = Left
	pos = 180 + Floor(Log(10, var(10))) * 9 - NumExplod(10) * 9 , var(5) + 98
	sprpriority = 7
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ontop = 1
	IgnoreHitPause = 1
	scale = 0.5, 0.5

















;==============================================================
;[BARS] バー表示用常駐ヘルパー(^^

; ラウンドコール
; ライフバー
; パワーバー
; ガードゲージ
; スコア
; AI
; ランキング

;==============================================================

; var(0):	life
; var(1):	players life
; var(2):	damage
; var(3):	sound index
; var(4):	1/3 life switch

; var(10):	max life

; var(11-12):	just defence & block system

; var(15):	player change

; var(20):	power
; var(21):	players power
; var(22):	players type
; var(23-29):	max mode
; var(30):	max power

; var(31):	lifebar draw x
; var(32):	lifebar draw y
; var(33):	powerbar draw x
; var(34):	powerbar draw y

; var(35):	guardcrush
; var(36):	guardcrush 2

; var(40):	display all bars [0/2]
; var(41):	display power bars

; var(44):      jump type

; var(45):      *** finish
; var(46):	system sound of navigation
; var(47):	K.O. countdown

; var(48):	first attack
; var(49):	counter attack

; var(50):	dizzy
; var(51):	AI(def:-/player:-1/cpu:1)

; var(55):	stage infomation [2-99]

; var(57):	score
; var(58):	score
; var(59):	striker combo Stateno

;------------
; fvar(3-7):	bonus
; fvar(13):


;--------------------------------------------------------------
[Statedef 90900]
ctrl = 0
vel = 0, 0
poweadd = 0
;; anim = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible

[State 0]
	type = AssertSpecial
	trigger1 = RoundState != 2
	flag = NoBarDisplay

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA




;==============================================================
; 描画座標初期化
; init draw pos x y

; lifebar x
[State 0]
	type = varset
	trigger1 = time = 0
	var(31) = 1

; lifebar y
[State 0]
	type = varset
	trigger1 = time = 0
	var(32) = 18

; powerbar x
[State 0]
	type = varset
	trigger1 = time = 0
	var(33) = Ifelse(TeamSide = 1, 6, 314)

; powerbar y
[State 0]
	type = varset
	trigger1 = time = 0
	var(34) = 223


;--------------------------------------------------------------

; get score from parent
[State 0]
	type = varset
	trigger1 = time = 0
	trigger1 = Root,sysvar(4)
	var(57) = Root,var(58)






;==============================================================
;バー全体の表示スイッチ
;switch of all bars displaying

;; all bars ON
[State 0]
	type = varset
	triggerall = RoundState = 2
	triggerall = var(40) != 1
;;	trigger1 = Root,sysvar(3) = 2
	trigger1 = IsHelper(90900)
	var(40) = 1
	IgnoreHitPause = 1

;; only power bars OFF (self)
[State 0]
	type = varset
	triggerall = RoundState = 2
	triggerall = var(40) != 2
;;	trigger1 = Root,sysvar(3) > 2
;;	trigger2 = NumEnemy
;;	trigger2 = Enemy,sysvar(4)
;;	trigger2 = Enemy,sysvar(3) < 2
	trigger1 = IsHelper(90901)
	trigger2 = var(22) = 4 && !NumPartner
	var(40) = 2
	IgnoreHitPause = 1

; all bars OFF
[State 0]
	type = varset
	triggerall = var(40)
;;	trigger1 = Root,sysvar(3) < 2
;;	trigger2 = NumEnemy
;;	trigger2 = Enemy,sysvar(4)
;;	trigger2 = Enemy,sysvar(3) < 2
;;	trigger3 = NumPartner
;;	trigger3 = Root,sysvar(4) = 0
;;	trigger4 = Root,Alive = 0
	trigger1 = RoundState != 2
	var(40) = 0
	IgnoreHitPause = 1









;--------------------------------------------------------------
; player change
; プレーヤー切換
;--------------------------------------------------------------

[State 0]
	type = varset
	trigger1 = var(15)
	trigger1 = !NumPartner
	var(15) = 0

[State 0]
	type = varset
	trigger1 = !var(15)
	trigger1 = Root,Alive = 0
	trigger1 = NumPartner
	trigger1 = Partner,Alive
	var(15) = 1







;==============================================================
;ラウンド開始
;==============================================================

;--; Display Fight!
[State 0] 
	type = Helper
	triggerall = time = 0
	triggerall = !NumHelper(180000)
	trigger1 = TeamSide = 1
	trigger1 = NumEnemy
	name = "Round-Call"
	id = 180000
	Stateno = 180000















;==============================================================
; プレーヤー(親)の値を参照
; get parents parameters

; (MaxLife)
[State 0]
	type = varset
	trigger1 = var(15) = 0
	trigger1 = var(10) != Root,LifeMax
	var(10) = Root,LifeMax
	IgnoreHitPause = 1

[State 0]
	type = varset
	trigger1 = var(15) = 1
	trigger1 = NumPartner
	trigger1 = var(10) != Partner,LifeMax
	var(10) = Partner,LifeMax
	IgnoreHitPause = 1

; (Life)
[State 0]
	type = varset
	trigger1 = var(15) = 0
	trigger1 = var(1) != Root,Life
	var(1) = Root,Life
	IgnoreHitPause = 1

[State 0]
	type = varset
	trigger1 = var(15) = 1
	trigger1 = NumPartner
	trigger1 = var(1) != Partner,Life
	var(1) = Partner,Life
	IgnoreHitPause = 1





;------------------------------
; set player mode
;------------------------------

; normal mode
[State 0]
	type = varset
	triggerall = time = 0
	trigger1 = Root,NumPartner = 0
	var(22) = Ifelse(!(Root,PalNo%3), 3, Root,PalNo%3)

; team mode
[State 0]
	type = varset
	triggerall = time = 0
	trigger1 = Root,NumPartner
	trigger1 = Root,ID < Partner,ID
 	trigger2 = IsHelper(90901) ; << パワーバー表示しない
	var(22) = 4




;------------------------------

;------------------------------
[State 0]
	type = PlaySnd
	triggerall = var(22) = 2 && RoundState = 2
	trigger1 = var(1) <= var(10) / 3
	trigger1 = Power >= 1000 && !var(4)
	value = F10200, 2  ; << "power up!"
	IgnoreHitPause = 1

; 体力が1/3以下判定
[State 0, is red life]
	type = varset
	trigger1 = var(22) = 2 && !var(4)
	trigger1 = var(1) <= var(10) / 3
	var(4) = 1
	IgnoreHitPause = 1

[State 0, is red life]
	type = varset
	trigger1 = var(22) = 2 && var(4)
	trigger1 = var(1) > var(10) / 3
	var(4) = 0
	IgnoreHitPause = 1





;==============================================================
;AI判定  使用変数: Var(51) [def:0 / AI:1/ Hum:-1]
;==============================================================

[State 0]
	type = varset
	trigger1 = time = 0
	var(51) = -1
[State 0]
	type = varset
	triggerall = time = 0
	trigger1 = Root,MatchNo > 1 && Root,IsHomeTeam = 1
	var(51) = 1

;;[State 0]
;;	type = varset
;;	triggerall = time = 0
;;	trigger1 = Root,MatchNo = 1
;;	trigger1 = Root,RoundsExisted = 0
;;	trigger1 = Root,TeamMode = Turns
;;	trigger1 = Root,RoundNo > 9
;;	trigger1 = Root,RoundNo > 0
;;	trigger1 = Root,var(58) > 0
;;	var(51) = 1

; 親へ渡す
[State 0]
	type = ParentVarSet
	triggerall = time = 0
	trigger1 = Root,sysvar(4) ;; * <<*
	var(51) = var(51)









;==============================================================
; ライフバー描画	(life bar) [ID: 490###]
;==============================================================
; 高速化のため、var(0)を使用
; using var(0) to keeping heigh fps.

; 半透明影
[State 0]
	type = RemoveExplod
	trigger1 = var(0) != var(1)
	trigger2 = !var(40)

	trigger3 = var(15) = 0
	trigger3 = var(2) != var(1)
	trigger3 = Root,MoveType != H || Root,Alive = 0 || RoundState != 2

	trigger4 = var(15) = 1
	trigger4 = NumPartner
	trigger4 = var(2) != var(1)
	trigger4 = Partner,MoveType != H || Partner,Alive = 0 || RoundState != 2

	ID = 490000
	IgnoreHitPause = 1

; 外枠
[State 0]
	type = RemoveExplod
	trigger1 = NumExplod(490100)
	trigger1 = !NumExplod(490000)
	ID = 490100
	IgnoreHitPause = 1

[State 0]
	type = RemoveExplod
	trigger1 = NumExplod(490200)
	trigger1 = !NumExplod(490000)
	ID = 490200
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	trigger1 = NumExplod(490201)
	trigger1 = !NumExplod(490000)
	ID = 490201
	IgnoreHitPause = 1

; face
[State 0]
	type = RemoveExplod
	trigger1 = NumExplod(490600)
	trigger1 = !NumExplod(490000)
	ID = 490600
	IgnoreHitPause = 1

; lights
[State 0]
	type = RemoveExplod
	trigger1 = NumExplod(490500)
	trigger1 = !NumExplod(490000)
	ID = 490500
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	trigger1 = NumExplod(490510)
	trigger1 = !NumExplod(490000)
	ID = 490510
	IgnoreHitPause = 1

[State 0, warnning sound]
	type = PlaySnd
	triggerall = var(22) = 2 && RoundState = 2
	trigger1 = var(4) && (var(0) > var(10) / 3)
	value = F10200, 1
	IgnoreHitPause = 1



;--------------------------------------------------------------

; 半透明影
[State 0, LifeBarshadow]
	type = Explod
	triggerall = !NumExplod(490000)
	trigger1 = var(40)
	ID = 490000
	anim = F200100 + var(22)
	sprpriority = -1
	postype = Left
	pos = Ifelse(TeamSide = 1, 160, 159), var(32)
	scale = 0.5, 0.5
	facing = Ifelse(TeamSide = 1, 1, -1)
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1


;---------------------------------------
; ダメージバー描画部分
; DamageBar
;---------------------------------------

;-P1- 

[State 0]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490201) = 0
	trigger1 = var(15) = 0
	trigger1 = TeamSide = 1 && var(40)
	ID = 490201
	anim = F200402 + Ifelse(Root,MoveType != H, 10, 0)
	sprpriority = 4
	postype = Left
	pos = 141 - Floor(var(2)/1.00/var(10)*108), var(32) + 1
	scale = Floor(var(2)/1.00/var(10)*108), 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490201) <= 1
	trigger1 = var(15) = 0
	trigger1 = TeamSide = 1 && var(40)
	ID = 490201
	anim = F200400 + Ifelse(Root,MoveType != H, 10, 0)
	sprpriority = 4
	postype = Left
	pos = 141 - Floor(var(2)/1.00/var(10)*108), var(32) + 1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

;-P1- Partner

[State 0]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490201) = 0
	trigger1 = var(15) = 1 && NumPartner
	trigger1 = TeamSide = 1 && var(40)
	ID = 490201
	anim = F200402 + Ifelse(Partner,MoveType != H, 10, 0)
	sprpriority = 4
	postype = Left
	pos = 141 - Floor(var(2)/1.00/var(10)*108), var(32) + 1
	scale = Floor(var(2)/1.00/var(10)*108), 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490201) <= 1
	trigger1 = var(15) = 1 && NumPartner
	trigger1 = TeamSide = 1 && var(40)
	ID = 490201
	anim = F200400 + Ifelse(Partner,MoveType != H, 10, 0)
	sprpriority = 4
	postype = Left
	pos = 141 - Floor(var(2)/1.00/var(10)*108), var(32) + 1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1


;-P2-

[State 0]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490201) = 0
	trigger1 = var(15) = 0
	trigger1 = TeamSide = 2 && var(40)
	ID = 490201
	anim = F200402 + Ifelse(Root,MoveType != H, 10, 0)
	sprpriority = 4
	postype = Left
	pos = 179, var(32) + 1
	scale = Floor(var(2)/1.00/var(10)*108), 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490201) <= 1
	trigger1 = var(15) = 0
	trigger1 = TeamSide = 2 && var(40)
	ID = 490201
	anim = F200401 + Ifelse(Root,MoveType != H, 10, 0)
	sprpriority = 4
	postype = Left
	pos = 179 + Floor(var(2)/1.00/var(10)*108), var(32) + 1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

;-P2- Partner

[State 0]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490201) = 0
	trigger1 = var(15) = 1 && NumPartner
	trigger1 = TeamSide = 2 && var(40)
	ID = 490201
	anim = F200402 + Ifelse(Partner,MoveType != H, 10, 0)
	sprpriority = 4
	postype = Left
	pos = 179, var(32) + 1
	scale = Floor(var(2)/1.00/var(10)*108), 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490201) <= 1
	trigger1 = var(15) = 1 && NumPartner
	trigger1 = TeamSide = 2 && var(40)
	ID = 490201
	anim = F200401 + Ifelse(Partner,MoveType != H, 10, 0)
	sprpriority = 4
	postype = Left
	pos = 179 + Floor(var(2)/1.00/var(10)*108), var(32) + 1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1


;---------------------------------------
; ライフバー描画部分
;-P1- LifeBar
;---------------------------------------

[State 0, LifeBar1-1]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490200) = 0
	trigger1 = TeamSide = 1 && var(40)
	ID = 490200
	anim = F200015 - Ifelse(var(1)>=var(10)-1, 15, var(1)*15/var(10)) * (!var(4)) + var(4)*6
	sprpriority = 4
	postype = Left
	pos = 141 - Floor(var(1)/1.00/var(10)*108), var(32) + 1
	scale = Floor(var(1)/1.00/var(10)*108), 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0, LifeBar1-2]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490200) <= 1
	trigger1 = TeamSide = 1 && var(40)
	ID = 490200
	anim = F200045 - Ifelse(var(1)>=var(10)-1, 15, var(1)*15/var(10)) * (!var(4)) + var(4)*6
	sprpriority = 4
	postype = Left
	pos = 141 - Floor(var(1)/1.00/var(10)*108), var(32) + 1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

;-------------
;-P2-

[State 0, LifeBar2-1]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490200) = 0
	trigger1 = TeamSide = 2 && var(40)
	ID = 490200
	anim = F200015 - Ifelse(var(1)>=var(10)-1, 15, var(1)*15/var(10)) * (!var(4)) + var(4)*6
	sprpriority = 4
	postype = Left
	pos = 179, var(32) + 1
	scale = Floor(var(1)/1.00/var(10)*108), 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0, LifeBar2-2]
	type = Explod
	triggerall = NumExplod(490000)
	triggerall = NumExplod(490200) <= 1
	trigger1 = TeamSide = 2 && var(40)
	ID = 490200
	anim = F200075 - Ifelse(var(1)>=var(10)-1, 15, var(1)*15/var(10)) * (!var(4)) + var(4)*6
	sprpriority = 4
	postype = Left
	pos = 179 + Floor(var(1)/1.00/var(10)*108), var(32) + 1
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1


;---------------------------------------;外枠
[State 0, LifeBarWindowFrame]
	type = Explod
	triggerall = !NumExplod(490100)
	trigger1 = var(40)
	ID = 490100
	anim = F200200 + TeamSide - 1
	sprpriority = -1
	postype = Left
	pos = Ifelse(TeamSide = 1, 160, 160), var(32)
;;	facing = Ifelse(TeamSide = 1, 1, -1)
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1


;---------------------------------------; ライト
[State 0]
	type = Explod
	triggerall = !NumExplod(490500)
	trigger1 = var(0) > var(1)
	trigger1 = var(40)
	ID = 490500
	anim = F200500
	sprpriority = 2
	postype = Left
	pos = Ifelse(TeamSide=1,141,179) + Ifelse(TeamSide=1,-1,1) * Floor(var(1)/1.00/var(10)*108), var(32) + 1
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]
	type = Explod
	triggerall = !NumExplod(490510)
	trigger1 = var(40)
	ID = 490510
	anim = F200510
	sprpriority = 3
	postype = Left
	pos = Ifelse(TeamSide = 1, 160, 160), var(32)
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1







;---------------------------------------; 顔 1
;; face
;[State 0]
;	type = Explod
;	triggerall = !NumExplod(490600)
;	trigger1 = var(40)
;	ID = 490600
;	anim = 9002
;	sprpriority = 5
;	postype = Left
;	pos = Ifelse(TeamSide = 1, 4, 316), var(32) + 2
;	facing = Ifelse(TeamSide = 1, 1, -1)
;	removetime = -1
;	supermovetime = 999999999
;	pausemovetime = 999999999
;	scale = 1, 1
;	bindtime = -1
;	ownpal = 1
;	ontop = 1
;	IgnoreHitPause = 1





;====================
;; 待機中ライフバー
;;[State 0]
;;	type = Explod
;;	trigger1 = RoundState = 2 && Root,sysvar(4) = 0
;;	ID = 8771
;;	anim = F200402 ;+ Ifelse(Root,MoveType != H, 10, 0)
;;	sprpriority = 4
;;	postype = Left
;;	pos = Ifelse(TeamSide = 1, 4, 216), 48
;;	facing = Ifelse(TeamSide = 1, 1, -1)
;;	scale = 50.0, 0.25
;;	bindtime = -1
;;	ownpal = 1
;;	ontop = 1
;;	removetime = 1
;;[State 0]
;;	type = Explod
;;	trigger1 = RoundState = 2 && Root,sysvar(4) = 0
;;	ID = 8772
;;	anim = F200015 - Ifelse(var(1)>=var(10)-1, 15, var(1)*15/var(10)) * (!var(4)) + var(4)*6
;;	sprpriority = 5
;;	postype = Left
;;	pos = Ifelse(TeamSide = 1, 4, 216), 48
;;	facing = Ifelse(TeamSide = 1, 1, -1)
;;	scale = -Root,Life / 1.0 / LifeMax * 50.0, 0.25
;;	bindtime = -1
;;	ownpal = 1
;;	ontop = 1
;;	removetime = 1



;--------------------------------------------------------------
; big damage sound

[State 0]
	type = PlaySnd
	triggerall = RoundState = 2
	triggerall = var(0) - var(1) > 200	;more then 200 damage!!!
	trigger1 = var(15) = 0
	trigger1 = Root,MoveType = H
	trigger1 = Root,GetHitVar(Guarded) = 0
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,MoveType = H
	trigger2 = Partner,GetHitVar(Guarded) = 0
	value = F10100, 2
	channel = 20
	IgnoreHitPause = 1

;--------------------------------------------------------------

; ライフ一時保存
; memo life to var
[State 0]
	type = varset
	trigger1 = var(0) != var(1)
	var(0) = var(1)
	IgnoreHitPause = 1

; ダメージ一時保存
; memo damage to var
[State 0]
	type = varset
	triggerall = var(2) != var(1)
	trigger1 = var(15) = 0
	trigger1 = Root,MoveType != H
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,MoveType != H
	var(2) = var(1)
	IgnoreHitPause = 1









;==============================================================
;パワーバー描画 (power bar) [ID: 492###]
;==============================================================

; using var(22) to keep heigh fps.
; type 1 : sysvar(4) = 1 and Team mode
; type 2 : sysvar(4) = 2
; type 3 : sysvar(4) = 3
; type 4 : sysvar(4) = 4



[State 0]
	type = varset
	trigger1 = var(30) != Root,Const(Data.Power)
	var(30) = Root,Const(Data.Power)
	IgnoreHitPause = 1

[State 0]
	type = poweradd
	trigger1 = time = 0 && var(48) != 2
	trigger1 = RoundNo = 1 && Power < 1000
	value = 1000



;--------------------------------------------------------------
; TYPE 1 (normal)
;--------------------------------------------------------------

; 半透明影(alpha blend frame)
[State 0, p3-1-1]
	type = RemoveExplod
	triggerall = var(22) = 1 && NumExplod(492000)
	trigger1 = var(40)
	trigger1 = var(20)/1000 - Power/1000 != 0
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492000
	IgnoreHitPause = 1

; 数字(stock number of power)
[State 0, p3-1-2]
	type = RemoveExplod
	triggerall = var(22) = 1 && NumExplod(492300)
	trigger1 = var(40) && !NumExplod(492000)
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492300
	IgnoreHitPause = 1

; 再描画パワーバー(redraw power bars)
[State 0, p3-1-3]
	type = RemoveExplod
	triggerall = var(22) = 1 && NumExplod(492200)
	trigger1 = var(40) && !NumExplod(492000)
	trigger2 = var(40) = 0 || var(40) = 2
	trigger3 = !NumExplod(492000)
	ID = 492200
	IgnoreHitPause = 1

; 外枠(redraw flame)
[State 0, p3-1-4]
	type = RemoveExplod
	triggerall = var(22) = 1 && NumExplod(492100)
	trigger1 = var(40) && !NumExplod(492000)
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492100
	IgnoreHitPause = 1


;-------------------------------------------
; 半透明影(af)
[State 0, p3-1-5]
	type = Explod
	triggerall = var(22) = 1
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492000)
	ID = 492000
	anim = F100050
	sprpriority = -1
	postype = Left
	pos = var(33), var(34) + 4
	scale = 0.5, 0.5
	facing = Ifelse(TeamSide = 1, 1, -1)
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; 数字(number)
[State 0, p3-1-6]
	type = Explod
	triggerall = var(22) = 1
	triggerall = var(40) = 1
	triggerall = Power >= 1000
	trigger1 = !NumExplod(492300)
	ID = 492300
	anim = F100500 + Power/1000 + (TeamSide-1)*10
	sprpriority = 5
	postype = Left
	pos = var(33), var(34) + 4
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; パワーバー(powerbar)
[State 0, p3-1-7]
	type = Explod
	triggerall = var(22) = 1
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492200) && NumExplod(492000)
	ID = 492200
	anim = F100100 + Ifelse(Power>=var(30) || Power>=5000, 9, Power/1000)
	sprpriority = 5
	postype = Left
	pos = var(33), var(34) + 4
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = Ifelse(Power>=var(30), 1, (Power%1000)/1000.00), 1.132
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

[State 0, p3-1-8]
	type = ModifyExplod
	triggerall = var(22) = 1
	triggerall = var(40) = 1
	triggerall = NumExplod(492200)
	triggerall = RoundState = 2
	trigger1 = var(20) - Power != 0
	ID = 492200
	scale = Ifelse(Power>=var(30) || Power>=5000, 1, (Power%1000)/1000.00)
	IgnoreHitPause = 1

; 外枠(frame)
[State 0, p3-1-9]
	type = Explod
	triggerall = var(22) = 1
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492100)
	ID = 492100
	anim = F100000 + (Power>=1000)
	sprpriority = 5
	postype = Left
	pos = var(33), var(34) + 4
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1







;--------------------------------------------------------------
; TYPE 2 (blocking type)
;--------------------------------------------------------------

[State 0, p3-2-1a]
	type = PowerSet
	triggerall = var(22) = 2 && RoundState = 2
	trigger1 = Power >= 1000 && var(20) <= Power
	value = Ifelse(!var(4), 1000, var(30))
	IgnoreHitPause = 1

[State 0, p3-2-1d]
	type = PowerSet
	triggerall = var(22) = 2 && RoundState = 2
	trigger1 = Power < Ifelse(!var(4), 1000, var(30))
	trigger1 = var(20) > Power
	value = 0
	IgnoreHitPause = 1

; モード別パワー制御
[State 0, power increasing type 2]
	type = PowerSet
	triggerall = RoundState = 2
	triggerall = var(22) = 2	;blocking mode
	trigger1 = Root,StateNo != 195500
	trigger1 = Power < 1000
	trigger1 = var(20) > 0 && Power > var(20)
	value = var(20) + (Power - var(20)) / 2
	IgnoreHitPause = 1

; 体力が1/3以下時増加
[State 0]
	type = poweradd
	triggerall = var(22) = 2 && RoundState = 2
	trigger1 = var(4)
	trigger1 = Power < 1000
	value = 2
	IgnoreHitPause = 1


;--------------------------------------------------------------
; 半透明影(alpha blend frame)
[State 0, p3-2-3]
	type = RemoveExplod
	triggerall = var(22) = 2 && NumExplod(492000)
	trigger1 = var(40)
	trigger1 = var(20)/1000 - Power/1000 != 0
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492000
	IgnoreHitPause = 1

; 数字(stock number of power)
[State 0, p3-2-5]
	type = RemoveExplod
	triggerall = var(22) = 2 && NumExplod(492300)
	trigger1 = !NumExplod(492000)
	ID = 492300
	IgnoreHitPause = 1

; 再描画パワーバー(redraw power bars)
[State 0, p3-2-6]
	type = RemoveExplod
	triggerall = var(22) = 2 && NumExplod(492200)
	trigger1 = !NumExplod(492000)
	ID = 492200
	IgnoreHitPause = 1

; 外枠(redraw frame)
[State 0, p3-2-7]
	type = RemoveExplod
	triggerall = var(22) = 2 && NumExplod(492100)
	trigger1 = !NumExplod(492000)
	ID = 492100
	IgnoreHitPause = 1

;-------------------------------------------
; 半透明影(af)
[State 0, p3-2-8]
	type = Explod
	triggerall = var(22) = 2
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492000)
	ID = 492000
	anim = F101050
	sprpriority = -1
	postype = Left
	pos = var(33), var(34) + 2
	scale = 0.5, 0.5
	facing = Ifelse(TeamSide = 1, 1, -1)
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; パワーバー(powerbar)
[State 0, p3-2-9]
	type = Explod
	triggerall = var(22) = 2
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492200) && NumExplod(492000)
	ID = 492200
	anim = F101100 + Ifelse(Power>=1000, 9, Power/1000)
	sprpriority = 5
	postype = Left
	pos = var(33), var(34) + 2
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = Ifelse(Power>=1000, 1, (Power%1000)/1000.00),   1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

[State 0, p3-2-10]
	type = ModifyExplod
	triggerall = var(22) = 2
	triggerall = var(40) = 1
	triggerall = NumExplod(492200)
	trigger1 = var(20) - Power != 0
	ID = 492200
	scale = Ifelse(Power>=1000, 1, (Power%1000)/1000.00),   1
	IgnoreHitPause = 1

; 外枠
[State 0, p3-2-11]
	type = Explod
	triggerall = var(22) = 2
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492100)
	ID = 492100
	anim = F101000
	sprpriority = 5
	postype = Left
	pos = var(33), var(34) + 2
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; 数字(number)
[State 0, p3-2-12]
	type = Explod
	triggerall = var(22) = 2
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492300)
	ID = 492300
	anim = F101500 + Ifelse(Power>=2000, 2, Power/1000) + (TeamSide-1)*10
	sprpriority = 5
	postype = Left
	pos = var(33) + Ifelse(TeamSide = 1, 3, -36), var(34) - 2
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1





;--------------------------------------------------------------
; TYPE 3 (max mode)
;--------------------------------------------------------------
;if this part makes your game slowly, remove it...


; sound of MAX mode
[State 0, p3-3-1]
	type = PlaySnd
	triggerall = var(22) = 3 && RoundState = 2
	trigger1 = Power >= 2000 && var(24) = 0
	value = F10200, 3

[State 0]
	type = Explod
	triggerall = var(22) = 3 && RoundState = 2
	trigger1 = Power >= 2000 && var(24) = 0
	anim = F140 + (Random%4)
	sprpriority = 2
	postype = Left
	pos = Floor(Root,ScreenPos X) + Const(Size.Mid.Pos.X), Floor(Root,ScreenPos Y) + Const(Size.Mid.Pos.Y)
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	IgnoreHitPause = 1

[State 0, p3-3-2b]
	type = PowerSet
	triggerall = var(22) = 3 && RoundState = 1
	trigger1 = Power >= 2000
	value = 1000

[State 0, p3-3-2a]
	type = VarSet
	triggerall = var(22) = 3 && RoundState = 2
	trigger1 = Power >= 2000 && var(24) = 0
	var(25) = 2000

; モード別パワー制御
[State 0, power increasing type 3]
	type = PowerSet
	triggerall = RoundState = 2
	triggerall = var(22) = 3	;just defence mode
	trigger1 = Root,StateNo != 195500
	trigger1 = Power < 1000 && Power != 1000
	trigger1 = var(20) > 0 && Power > var(20)
	value = var(20) + (Power - var(20)) / 2
	IgnoreHitPause = 1

[State 0, p3-3-2b]
	type = PowerSet
	triggerall = var(22) = 3 && RoundState = 2
	trigger1 = Power >= 2000 && var(24) = 0
	value = var(30)

[State 0, p3-3-3]	;max mode on
	type = varset
	triggerall = var(22) = 3 && RoundState = 2
	trigger1 = Power >= 2000 && var(24) = 0
	var(24) = 1
	IgnoreHitPause = 1


;------------------------------------------------------------
[State 0, p3-3-4]
	type = varset
	triggerall = var(22) = 3 && var(24) && RoundState = 2
	trigger1 = Power < var(30)
	var(26) = var(30) - Power
	IgnoreHitPause = 1

[State 0, p3-3-5]
	type = varadd
	trigger1 = var(22) = 3 && var(24) && RoundState = 2
	var(25) = -2 - var(26)
	IgnoreHitPause = 1

[State 0, p3-3-5]
	type = varadd
	trigger1 = var(22) = 3 && var(24) && RoundState = 2
	trigger1 = NumEnemy
	trigger1 = Enemy,MoveType = H
	trigger1 = Enemy,Const(data.fall.defence_mul) < 1
	trigger1 = Root,Ctrl = 0
	trigger1 = Root,StateNo >= 200 && Root,time = 1
	trigger1 = Root,PrevStateNo < 190
	var(25) = -200
	IgnoreHitPause = 1

[State 0, p3-3-6]
	type = PowerSet
	trigger1 = var(22) = 3 && var(24) && RoundState = 2
	value = var(30)
	IgnoreHitPause = 1

[State 0, p3-3-7]
	type = VarSet
	triggerall = var(22) = 3 && var(24) && RoundState = 2
	trigger1 = var(26)
	var(26) = 0
	IgnoreHitPause = 1

;----------------------------------------------------------
[State 0, p3-3-8]
	type = PowerSet
	triggerall = var(22) = 3 && var(24) && RoundState = 2
	trigger1 = var(25) <= 0
	value = 1000
	IgnoreHitPause = 1

[State 0, p3-3-9]
	type = VarSet
	triggerall = var(22) = 3 && var(24) && RoundState = 2
	trigger1 = var(25) <= 0
	var(24) = 0
	IgnoreHitPause = 1







;--------------------------------------------------------------
; 半透明影(alpha blend frame)
[State 0, p3-3-10]
	type = RemoveExplod
	triggerall = var(22) = 3 && NumExplod(492000)
	trigger1 = var(40)
	trigger1 = var(20)/1000 - Power/1000 != 0
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492000
	IgnoreHitPause = 1

; 数字(stock number of power)
[State 0, p3-3-11]
	type = RemoveExplod
	triggerall = var(22) = 3 && NumExplod(492300)
	trigger1 = !NumExplod(492000)
	ID = 492300
	IgnoreHitPause = 1

; 再描画パワーバー(redraw power bars)
[State 0, p3-3-12]
	type = RemoveExplod
	triggerall = var(22) = 3 && NumExplod(492200)
	trigger1 = !NumExplod(492000)
	ID = 492200
	IgnoreHitPause = 1

; 再描画パワーバー(redraw power bars)
[State 0, p3-3-13]
	type = RemoveExplod
	triggerall = var(22) = 3 && NumExplod(492201)
	trigger1 = !NumExplod(492000)
	ID = 492201
	IgnoreHitPause = 1

; 外枠(redraw frame)
[State 0, p3-3-14]
	type = RemoveExplod
	triggerall = var(22) = 3 && NumExplod(492100)
	trigger1 = !NumExplod(492000)
	ID = 492100
	IgnoreHitPause = 1

;-------------------------------------------
; 半透明影(af)
[State 0, p3-3-15]
	type = Explod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492000)
	ID = 492000
	anim = F102050
	sprpriority = -1
	postype = Left
	pos = var(33), var(34)
	scale = 0.5, 0.5
	facing = Ifelse(TeamSide = 1, 1, -1)
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; パワーバー(powerbar)1/2
[State 0, p3-3-17]
	type = Explod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492200) && NumExplod(492000)
	ID = 492200
	anim = F102100 + (var(24) && Power>=2000)*10
	sprpriority = 2
	postype = Left
	pos = var(33), var(34)
	facing = Ifelse(TeamSide = 1, 1, -1)

	scale = Ifelse(Power<1000, (Power%1000)/1000.00, 1), 0.95

	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; パワーバー(powerbar)2/2
[State 0, p3-3-18]
	type = Explod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492201) && NumExplod(492000)
	ID = 492201
	anim = F102100 + (var(24) && Power>=2000)*10
	sprpriority = 2
	postype = Left
	pos = var(33) + Ifelse(TeamSide = 1, 66, -66), var(34) + 2
	facing = Ifelse(TeamSide = 1, 1, -1)

	scale = Ifelse(Power>1000, (Power%1000)/1000.00, 0), 0.95

	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

;-----------------------
[State 0, p3-3-19]
	type = ModifyExplod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	triggerall = NumExplod(492200)
	trigger1 = var(24) = 0
	trigger1 = var(20) - Power != 0
	ID = 492200
	scale = Ifelse(Power<1000, (Power%1000)/1000.00, 1)
	IgnoreHitPause = 1

[State 0, p3-3-20]
	type = ModifyExplod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	triggerall = NumExplod(492201)
	trigger1 = var(24) = 0
	trigger1 = var(20) - Power != 0
	ID = 492201
	scale = Ifelse(Power>1000, (Power%1000)/1000.00, 0)
	IgnoreHitPause = 1

;-----------------------
[State 0, p3-3-21]
	type = ModifyExplod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	triggerall = NumExplod(492200)
	trigger1 = var(24)
	ID = 492200
	scale = Ifelse(var(25)<1000, var(25)/1000.00, 1)
	IgnoreHitPause = 1

[State 0, p3-3-22]
	type = ModifyExplod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	triggerall = NumExplod(492201)
	trigger1 = var(24)
	ID = 492201
	scale = Ifelse(var(25)>1000, (var(25)-1000)/1000.00, 0)
	IgnoreHitPause = 1

;-----------------------
; 外枠
[State 0, p3-3-23]
	type = Explod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492100) && NumExplod(492000)
	ID = 492100
	anim = F102000
	sprpriority = 5
	postype = Left
	pos = var(33), var(34)
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; 数字(number)
[State 0, p3-3-16]
	type = Explod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492300) && NumExplod(492000)
	ID = 492300
	anim = F102500 + Ifelse(Power>=2000, 2, Power/1000) + (TeamSide-1)*10
	sprpriority = 7
	postype = Left
	pos = var(33), var(34) + 6
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

;-----------------------
; カーソル
[State 0, p3-3-24]
	type = RemoveExplod
	triggerall = var(22) = 3
	triggerall = NumExplod(492350)
	trigger1 = var(40) = 1
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492350
	IgnoreHitPause = 1

[State 0, p3-3-25]
	type = Explod
	triggerall = var(22) = 3
	triggerall = var(40) = 1
	triggerall = var(24)
	trigger1 = !NumExplod(492350) && NumExplod(492000) ;(root)
	ID = 492350
	sprpriority = 7
	postype = Left
	anim = F102600
	pos = var(33) + Floor(var(25)/2000.00*132) * Ifelse(TeamSide=1,1,-1), var(34) + 4 - (var(25)<1100) - (var(25)<1050) - (var(25)<1000) - (var(25)<950) - (var(25)<900)
	facing = Ifelse(TeamSide=1, 1, -1)
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1







;--------------------------------------------------------------
; TYPE 4 (team mode)
;--------------------------------------------------------------
; 半透明影(alpha blend frame)
[State 0, p3-4-1]
	type = RemoveExplod
	triggerall = var(22) = 4
	triggerall = NumExplod(492000)
	trigger1 = var(20)/1000 - Power/1000 != 0
	trigger1 = var(40)
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492000
	IgnoreHitPause = 1

; 数字(stock number of power)
[State 0, p3-4-2]
	type = RemoveExplod
	triggerall = var(22) = 4 && NumExplod(492300)
	trigger1 = var(40) && !NumExplod(492000)
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492300
	IgnoreHitPause = 1

; 再描画パワーバー(redraw power bars)
[State 0, p3-4-3]
	type = RemoveExplod
	triggerall = var(22) = 4 && NumExplod(492200)
	trigger1 = var(40) && !NumExplod(492000)
	trigger2 = var(40) = 0 || var(40) = 2
	trigger3 = !NumExplod(492000)
	ID = 492200
	IgnoreHitPause = 1

; 外枠(redraw flame)
[State 0, p3-4-4]
	type = RemoveExplod
	triggerall = var(22) = 4 && NumExplod(492100)
	trigger1 = var(40) && !NumExplod(492000)
	trigger2 = var(40) = 0 || var(40) = 2
	ID = 492100
	IgnoreHitPause = 1


;-------------------------------------------
; 半透明影(af)
[State 0, p3-4-5]
	type = Explod
	triggerall = var(22) = 4
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492000)
	ID = 492000
	anim = F100050
	sprpriority = -1
	postype = Left
	pos = var(33), var(34) + 5
	scale = 0.5, 0.5
	facing = Ifelse(TeamSide = 1, 1, -1)
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; 数字(number)
[State 0, p3-4-6]
	type = Explod
	triggerall = var(22) = 4
	triggerall = var(40) = 1
	triggerall = Power >= 1000
	trigger1 = !NumExplod(492300)
	ID = 492300
	anim = F100500 + Power/1000 + (TeamSide-1)*10
	sprpriority = 5
	postype = Left
	pos = var(33), var(34) + 6
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

; パワーバー(powerbar)
[State 0, p3-4-7]
	type = Explod
	triggerall = var(22) = 4
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492200) && NumExplod(492000)
	ID = 492200
	anim = F100100 + Ifelse(Power>=var(30) || Power>=5000, 9, Power/1000)
	sprpriority = 5
	postype = Left
	pos = var(33), var(34) + 5
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = Ifelse(Power>=var(30), 1, (Power%1000)/1000.00), 0.90
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

[State 0, p3-4-8]
	type = ModifyExplod
	triggerall = var(22) = 4
	triggerall = var(40) = 1
	triggerall = NumExplod(492200)
	triggerall = RoundState = 2
	trigger1 = var(20) - Power != 0
	ID = 492200
	scale = Ifelse(Power>=var(30) || Power>=5000, 1, (Power%1000)/1000.00)
	IgnoreHitPause = 1

; 外枠(frame)
[State 0, p3-4-9]
	type = Explod
	triggerall = var(22) = 4
	triggerall = var(40) = 1
	trigger1 = !NumExplod(492100)
	ID = 492100
	anim = F103000
	sprpriority = 5
	postype = Left
	pos = var(33), var(34) + 4
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1










;--------------------------------------------------------------
; パワー一時保存用
; memo power to var
[State 0]
	type = varset
	triggerall = RoundState = 2
	trigger1 = var(20) - Power != 0
	var(20) = Power
	IgnoreHitPause = 1









;==============================================================
; ガードクラッシュ   (GUARD CRUSH)
;==============================================================
; ガード状態回復(手抜き)

; 回復停止
[State 0]
	type = varset
	triggerall = var(35)
	trigger1 = !var(36)
	trigger2 = var(15) = 0
	trigger2 = var(36) && (Root,MoveType = H)
	trigger3 = var(15) = 1 && NumPartner
	trigger3 = var(36) && (Partner,MoveType = H)
	var(35) = 0

; 回復開始 - 通常速度
[State 0]
	type = varset
	triggerall = var(35) < 1
	trigger1 = NumEnemy
	trigger1 = Enemy,MoveType = H
	var(35) = 1

; 回復開始 - 速度２
[State 0]
	type = varset
	triggerall = var(35) < 2
	trigger1 = var(15) = 0
	trigger1 = Root,StateNo = 190010 ;; << ガードクラッシュ
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,StateNo = 190010
	var(35) = 2

; 消耗
[State 0]
	type = varadd
	triggerall = !var(12)
	trigger1 = var(15) = 0
	trigger1 = Root,StateNo = 150 || Root,StateNo = 152 ;|| Root,StateNo = 154 ;air
	trigger1 = Root,Time = 1
	var(36) = 1 + (Root,GetHitVar(Damage) + Root,GetHitVar(HitShakeTime))/10

; 消耗 (Partner)
[State 0]
	type = varadd
	triggerall = !var(12)
	trigger1 = var(15) = 1 && NumPartner
	trigger1 = Partner,StateNo = 150 || Partner,StateNo = 152 ;|| Partner,StateNo = 154 ;air
	trigger1 = Partner,Time = 1
	var(36) = 1 + (Partner,GetHitVar(Damage) + Partner,GetHitVar(HitShakeTime))/10


; 上限
[State 0]
	type = varset
	trigger1 = var(36) > 50
	var(36) = 50

; 回復 ----------------
[State 0]
	type = varadd
	triggerall = var(35) && var(36)
	trigger1 = var(35) = 1 && GameTime%50 = 0 ; << 通常速度
	trigger2 = var(35) = 2 && GameTime%5 = 0 ; ; << 速度2
	var(36) = -1

[State 0]
	type = varset
	triggerall = var(36)
	trigger1 = var(15) = 0
	trigger1 = Root,StateNo = 190010 ;; << ガードクラッシュ
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,StateNo = 190010
	var(36) = var(36) / 2



;-------------------------------------------------------------
;ガードゲージ(絵)	[ID:493###]

[State 0, GCB]
	type = RemoveExplod
	triggerall = NumExplod(493000)
	trigger1 = !var(40)
	trigger2 = var(37) != var(36)
;--;	trigger3 = var(35) || Root,StateNo = 190010
	ID = 493000
	IgnoreHitPause = 1

; 半透明影
[State 0, GuardBar-Frame0]
	type = Explod
	triggerall = NumExplod(490000) && NumExplod(490100)
	triggerall = NumExplod(493000) < 1
	trigger1 = var(40)
	ID = 493000
	anim = F210010
	sprpriority = 3
	postype = Left
	pos = 160, var(32)
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0, GuardBar-1]
	type = Explod
	triggerall = NumExplod(490000) && NumExplod(490100)
	triggerall = NumExplod(493000) < 2
	trigger1 = var(40)
	ID = 493000
	Anim = F210000
	Sprpriority = 4
	Postype = Left
	pos = Ifelse(TeamSide = 1, 95 + var(36), 175), var(32) + 12
	scale = Ifelse((var(36) = [1, 50]), 50 - var(36), 50), 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1

[State 0, GuardBar-2]
	type = Explod
	triggerall = NumExplod(490000) && NumExplod(490100)
	triggerall = NumExplod(493000) < 3
	trigger1 = var(40)
	ID = 493000
	anim = F210005
	sprpriority = 4
	postype = Left
	pos = Ifelse(TeamSide = 1, 92 + var(36), 178 + 50 - var(36)), var(32) + 12
	Facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

; 外枠
[State 0, GuardBar-Frame2]
	type = Explod
	triggerall = NumExplod(490000) && NumExplod(490100)
	triggerall = NumExplod(493000) < 4
	trigger1 = var(40)
	ID = 493000
	anim = F210011 + (var(36)>=40)
	sprpriority = 7
	postype = Left
	pos = 160, var(32)
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1


; 一時保存
; memo guardpoint
[State 0]
	type = varset
	trigger1 = var(37) != var(36)
	var(37) = var(36)






;==============================================================
; long jump
;==============================================================
[State 0]
	type = varset
	triggerall = var(44) < 2
	triggerall = var(15) = 0
	triggerall = Root,StateType != A
	trigger1 = Root,Command = "holddown"
	trigger2 = Root,Command = "holddown" && (Root,Command = "holdfwd" || Root,Command = "holdback")
	var(44) = 16
	IgnoreHitPause = 1
[State 0]
	type = varset
	triggerall = var(44) < 2
	triggerall = var(15) = 1 && NumPartner
	triggerall = Partner,StateType != A
	trigger1 = Partner,Command = "holddown"
	trigger2 = Partner,Command = "holddown" && (Partner,Command = "holdfwd" || Partner,Command = "holdback")
	var(44) = 16
	IgnoreHitPause = 1

[State 0]
	type = varadd
	trigger1 = var(44) > 0
	var(44) = -1





;==============================================================
; リカバリー・メッセージ (State 5210に置いても可!)
;==============================================================
; recovery message
[State 0]
	type = Explod
	triggerall = RoundState = 2
	triggerall = !NumExplod(402001)
	trigger1 = var(15) = 0
	trigger1 = Root,StateNo = 5210 && Root,Time = 1 ;air rec
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,StateNo = 5210 && Partner,Time = 1 ;air rec
	ID = 402001
	anim = F400007
	sprpriority = -1
	postype = Left
	pos = Ifelse(TeamSide = 1, 65, 255), 100 + (NumExplod(400000) + NumExplod(401000) + NumExplod(1195500)) * 14
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	bindtime = -1
	Supermovetime = 999999999
	Pausemovetime = 999999999
[State 0]
	type = Explod
	triggerall = RoundState = 2
	triggerall = !NumExplod(402000)
	trigger1 = var(15) = 0
	trigger1 = Root,StateNo = 5210 && Root,Time = 1 ;air rec
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,StateNo = 5210 && Partner,Time = 1 ;air rec
	ID = 402000
	anim = F402000 + (TeamSide-1)
	sprpriority = 5
	postype = left
	pos = Ifelse(TeamSide = 1, 65, 255), 100 + (NumExplod(400000) + NumExplod(401000) + NumExplod(1195500)) * 14
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	bindtime = -1
	Supermovetime = 999999999
	Pausemovetime = 999999999




;==============================================================
; ファースト・アタック
;==============================================================
; var(48)

; 特殊キャラ用
[State 0]
	type = varset
	triggerall = RoundState = 2
	triggerall = var(48) = 0
	trigger1 = NumEnemy
	trigger1 = Enemy,sysvar(4)
	trigger1 = Enemy,NumExplod(920000)
	trigger2 = Root,sysvar(4)
	trigger2 = Root,NumExplod(920000)
	var(48) = -9
	IgnoreHitPause = 1

; 判定
; self
[State 0]
	type = varset
	triggerall = RoundState = 2
	triggerall = var(48) = 0
	trigger1 = Root,MoveType = H && Root,GetHitVar(Guarded) = 0
	trigger2 = NumPartner
	trigger2 = Partner,MoveType = H && Partner,GetHitVar(Guarded) = 0
	var(48) = -1
	IgnoreHitPause = 1
; enemy
[State 0]
	type = varset
	triggerall = RoundState = 2
	triggerall = var(48) = 0
	trigger1 = NumEnemy
	trigger1 = Enemy,MoveType = H && (Enemy,GetHitVar(Guarded)) = 0
	var(48) = 1
	IgnoreHitPause = 1


; first attact sound
[State 0, fa sound]
	type = PlaySnd
	trigger1 = RoundState = 2
	trigger1 = var(48) = 1
	value = F10100, 1
	channel = 20

; first attack get bonus
[State 0]
	type = varadd
	trigger1 = RoundState = 2
	trigger1 = var(48) = 1
	var(57) = 100

;-----------------------
; first attact message
[State 0]
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = var(48) = 1 && !NumExplod(400001)
	ID = 400001
	anim = F400005
	sprpriority = -1
	postype = Left
	pos = Ifelse(TeamSide = 1, 65, 255), 100 + (NumExplod(401000) + NumExplod(1195500)) * 14
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	bindtime = -1
	Supermovetime = 999999999
	Pausemovetime = 999999999
[State 0]
	type = Explod
	trigger1 = RoundState = 2
	trigger1 = var(48) = 1 && !NumExplod(400000)
	ID = 400000
	anim = F400000 + (TeamSide-1)
	sprpriority = 1
	postype = Left
	pos = Ifelse(TeamSide = 1, 65, 255), 100 + (NumExplod(401000) + NumExplod(1195500)) * 14
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	bindtime = -1
	Supermovetime = 999999999
	Pausemovetime = 999999999


; first attack var
[State 0]
	type = varset
	trigger1 = var(48) = 1
	var(48) = 2

; first attack icon
[State 0]
	type = Explod
	triggerall = !NumExplod(400010)
	trigger1 = var(40) ;display all bars
	trigger1 = var(48) = 2
	ID = 400010
	anim = F400010
	sprpriority = 2
	postype = Left
	pos = Ifelse(TeamSide = 1, 40, 280), var(32) - 14
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	scale = 0.5, 0.5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999

; RemoveFA
[State 0]
	type = RemoveExplod
	trigger1 = NumExplod(400010)
	trigger1 = var(40) = 0
	ID = 400010













;--------------------------------------------------------------
;カウンター・メッセージ・サウンド
;var(49)

; counter hit set
[State 0]
	type = varset
	triggerall = RoundState = 2
	triggerall = !var(49)
	triggerall = NumEnemy
;;;	triggerall = Enemy,NumHelper(90900) || Enemy,NumHelper(90901) || Enemy,NumHelper(90902)
	triggerall = Enemy,MoveType = A
	triggerall = Enemy,StateNo != 195500
	trigger1 = var(15) = 0
	trigger1 = Root,MoveType != A
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,MoveType != A
	var(49) = 1
	IgnoreHitPause = 1

; counter hit
[State 0]
	type = varset
	triggerall = RoundState = 2
	triggerall = var(49) = 1
	triggerall = NumEnemy
;;;	triggerall = Enemy,NumHelper(90900) || Enemy,NumHelper(90901) || Enemy,NumHelper(90902)
	triggerall = Enemy,MoveType = H
	trigger1 = var(15) = 0
	trigger1 = Root,MoveHit
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,MoveHit
	var(49) = 2
	IgnoreHitPause = 1

; sound of counter
[State 0]
	type = PlaySnd
	triggerall = RoundState = 2
	trigger1 = var(49) = 2 && !NumExplod(401000)
	value = F10200, 0
	channel = 20
	IgnoreHitPause = 1

;-------------------
; get bonus - score
[State 0]
	type = VarAdd
	triggerall = var(51) = -1
	triggerall = RoundState = 2
	trigger1 = var(49) = 2 && !NumExplod(401000)
	var(57) = 110
	IgnoreHitPause = 1

; get bonus - ranking
[State 0]
	type = varadd
	triggerall = RoundState = 2
	trigger1 = var(49) = 2 && !NumExplod(401000)
	fvar(5) = 1
	IgnoreHitPause = 1

;-----------------------------
; flash
[State 0]
	type = Explod
	triggerall = RoundState = 2
	triggerall = !NumExplod(401002)
	trigger1 = var(49) = 2
;;	trigger2 = Root,StateNo = 8200
;;	trigger3 = NumPartner
;;	trigger3 = Partner,StateNo = 8200
	anim = F121
	id = 401002
	postype = Left
	sprpriority = 7
	pos = Floor(Root,ScreenPos X), Floor(Root,ScreenPos Y)
	scale = 25, 25
	bindtime = -1
	ownpal = 1
	ontop = 1
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1

; counter hit message
[State 0]
	type = Explod
	triggerall = RoundState = 2
	triggerall = !NumExplod(401000)
	trigger1 = var(49) = 2
;;	trigger2 = Root,StateNo = 8200
;;	trigger3 = NumPartner
;;	trigger3 = Partner,StateNo = 8200
	ID = 401001
	anim = F400006
	sprpriority = -1
	postype = Left
	pos = Ifelse(TeamSide = 1, 65, 255), 100 + (NumExplod(400000) + NumExplod(1195500)) * 14
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	bindtime = -1
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	triggerall = RoundState = 2
	triggerall = !NumExplod(401000)
	trigger1 = var(49) = 2
;;	trigger2 = Root,StateNo = 8200
;;	trigger3 = NumPartner
;;	trigger3 = Partner,StateNo = 8200
	ID = 401000
	anim = F401000 + TeamSide - 1
	sprpriority = 2
	postype = Left
	pos = Ifelse(TeamSide = 1, 65, 255), 100 + (NumExplod(400000) + NumExplod(1195500)) * 14
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	bindtime = -1
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1



; counter hit reset
[State 0]
	type = varset
	triggerall = var(49)
	triggerall = NumEnemy
;;;	trigger1 = Enemy,NumHelper(90900) || Enemy,NumHelper(90901) || Enemy,NumHelper(90902)
	trigger1 = Enemy,MoveType != A
	trigger2 = Enemy,StateNo = 195500
	var(49) = 0
	IgnoreHitPause = 1





;--------------------------------------------------------------
; マーク blocking/JD mark

[State 0]
	type = RemoveExplod
	triggerall = RoundState = 2
	triggerall = NumExplod(1195501)
	trigger1 = Root,StateNo = 195500 && Root,Time = 1
	trigger2 = NumPartner
	trigger2 = Partner,StateNo = 195500 && Partner,Time = 1
	ID = 1195501
[State 0]
	type = RemoveExplod
	triggerall = RoundState = 2
	triggerall = NumExplod(1195500)
	trigger1 = Root,StateNo = 195500 && Root,Time = 1
	trigger2 = NumPartner
	trigger2 = Partner,StateNo = 195500 && Partner,Time = 1
	ID = 1195500

[State 0]
	type = Explod
	triggerall = RoundState = 2
	triggerall = !NumExplod(1195501)
	trigger1 = Root,StateNo = 195500 && Root,Time = 1
	trigger2 = NumPartner
	trigger2 = Partner,StateNo = 195500 && Partner,Time = 1
	ID = 1195501
	anim = F400006 - (var(22) = 3)
	sprpriority = -1
	postype = Left
	pos = Ifelse(TeamSide = 1, 65, 255), 100 ;;+ (NumExplod(400000) + NumExplod(401000)) * 14
	facing = Ifelse(TeamSide = 1, 1, -1)
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	bindtime = -1
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	triggerall = RoundState = 2
	triggerall = !NumExplod(1195500)
	trigger1 = Root,StateNo = 195500 && Root,Time = 1
	trigger2 = NumPartner
	trigger2 = Partner,StateNo = 195500 && Partner,Time = 1
	ID = 1195500
	anim = F195500 + (TeamSide-1)*10 + (var(22)=3)*100 ;; + NumExplod(1195509)
	sprpriority = 2
	postype = Left
	pos = Ifelse(TeamSide = 1, 65, 255), 100 ;;+ (NumExplod(400000) + NumExplod(401000)) * 14
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	bindtime = -1
	Supermovetime = 999999999
	Pausemovetime = 999999999
	IgnoreHitPause = 1









;==============================================================
;コンビネーションヒット・アナウンス from CVS2
;==============================================================
; var(46)

; sound of rush hits
[State 0]
	type = VarSet
	triggerall = RoundState = 2 ;;&& Root,sysvar(4)
	triggerall = !var(46) || var(46) = 3
	trigger1 = var(15) = 0
	trigger1 = Root,MoveType = H && Root,GetHitVar(Guarded) = 0
	trigger1 = Root,StateNo != [120,155]
	trigger1 = (Root,GetHitVar(HitCount)) >= 4		;more then 4 hits
	var(46) = Ifelse((Root,GetHitVar(HitCount)) > 6, 4, 3)
	IgnoreHitPause = 1
[State 0]
	type = VarSet
	triggerall = RoundState = 2 ;;&& Root,sysvar(4)
	triggerall = !var(46) || var(46) = 3
	trigger1 = var(15) = 1 && NumPartner
	trigger1 = Partner,MoveType = H && Partner,GetHitVar(Guarded) = 0
	trigger1 = Partner,StateNo != [120,155]
	trigger1 = (Partner,GetHitVar(HitCount)) >= 4		;more then 4 hits
	var(46) = Ifelse((Partner,GetHitVar(HitCount)) > 6, 4, 3)
	IgnoreHitPause = 1

; system sound
[State 0]
	type = PlaySnd
	triggerall = RoundState = 2 ;;&& Root,sysvar(4)
	triggerall = var(46)
	trigger1 = var(15) = 0
	trigger1 = Root,MoveType != H 
	trigger2 = var(15) = 1 && NumPartner
	trigger2 = Partner,MoveType != H 
	value = F10100, var(46)
	channel = 20
	IgnoreHitPause = 1

; reset
[State 0]
	type = VarSet
	triggerall = RoundState = 2 ;;&& Root,sysvar(4)
	triggerall = var(46)
	trigger1 = var(15) = 0
	trigger1 = Root,MoveType != H
	trigger2 = var(15) = 0
	trigger2 = Root,MoveType = H && (Root,GetHitVar(HitCount)) < 4
	trigger3 = var(15) = 0
	trigger3 = Root,StateNo = [120,155]

	trigger4 = var(15) = 1 && NumPartner
	trigger4 = Partner,MoveType != H
	trigger5 = var(15) = 1 && NumPartner
	trigger5 = Partner,MoveType = H && (Partner,GetHitVar(HitCount)) < 4
	trigger6 = var(15) = 1 && NumPartner
	trigger6 = Partner,StateNo = [120,155]
	var(46) = 0
	IgnoreHitPause = 1




;--------------------------------------------------------------
; ヒットスパーク・粒
;--------------------------------------------------------------
; (Root)
[State 0]
	type = Explod
	triggerall = NumExplod(505000) < 5
	triggerall = Root,StateNo = 5000 || Root,StateNo = 5010 || Root,StateNo = 5020 || Root,StateNo = 5070 || Root,StateNo = 5100
	triggerall = Root,Time < 5
	trigger1 = Root,Anim = 5002 || Root,Anim = 5012 || Root,Anim = 5022 || Root,Anim = 5030
	trigger2 = Root,Anim = 5001 || Root,Anim = 5011 || Root,Anim = 5021
	ID = 505000
	anim = F80 + Random%5
	sprpriority = -5
	postype = Left
	pos = Floor(Root,ScreenPos X + Const(Size.mid.Pos.X)), Floor(Root,ScreenPos Y + Const(Size.mid.Pos.Y))
;--;	facing = Root,facing
	velocity = (-1 - (Random%80)/10.00) * Root,facing, 1 + ((Random%100)-50)/10.00
	ownpal = 1
	IgnoreHitPause = 1

; (Partner)
[State 0]
	type = Explod
	triggerall = NumExplod(505001) < 5
	triggerall = NumPartner
	triggerall = Partner,StateNo = 5000 || Partner,StateNo = 5010 || Partner,StateNo = 5020 || Partner,StateNo = 5070 || Partner,StateNo = 5100
	triggerall = Partner,Time < 5
	trigger1 = Partner,Anim = 5002 || Partner,Anim = 5012 || Partner,Anim = 5022 || Partner,Anim = 5030
	trigger2 = Partner,Anim = 5001 || Partner,Anim = 5011 || Partner,Anim = 5021
	ID = 505001
	anim = F80 + Random%5
	sprpriority = -5
	postype = Left
	pos = Floor(Partner,ScreenPos X + Partner,Const(Size.mid.Pos.X)), Floor(Partner,ScreenPos Y + Partner,Const(Size.mid.Pos.Y))
;--;	facing = Partner,facing
	velocity = (-1 - (Random%80)/10.00) * Root,facing, 1 + ((Random%100)-50)/10.00
	ownpal = 1
	IgnoreHitPause = 1


;--------------------------------------------------------------
; ヒットスパーク・血飛沫(^^;
;--------------------------------------------------------------
;;[State 0]
;;	type = Explod
;;	triggerall = !NumExplod(505010)
;;	triggerall = Root,Time < 3
;;	triggerall = Random < 120
;;	trigger1 = Root,Anim = 5002 || Root,Anim = 5012 || Root,Anim = 5022 || Root,Anim = 5030
;;	trigger2 = Root,Anim = 5001 || Root,Anim = 5011 || Root,Anim = 5021
;;	ID = 505010
;;	anim = F6 + Random%3
;;	sprpriority = 3
;;	postype = Left
;;	pos = Floor(Root,ScreenPos X + Const(Size.head.Pos.X)), Floor(Root,ScreenPos Y + Const(Size.head.Pos.Y))
;--;	facing = Root,facing
;;	ownpal = 1
;;	IgnoreHitPause = 1










;--------------------------------------------------------------
; 画面振動管理
;--------------------------------------------------------------

;-; 振動を消す
;-;[State 0]
;-;	type = EnvShake
;-;	trigger1 = GameTime%4
;-;	trigger1 = TeamSide = 1
;-;	time = 2
;-;	ampl = 0
;-;	IgnoreHitPause = 1


















;==============================================================
;点数・ボーナス表示  使用変数var(58),var(57)
; get bonus
;==============================================================
;点数加算は正確ではありません(^^; デタラメです...
;精度を上げる工夫をしてください。(誰が？

;; [数値]
;; ノーマル(NA)：    +50
;; スペシャル(SA):   +100
;; スーパー(HA):     +200
;; プロジェ(SP):     +150
;; ヘルパー(Helper): なし(取得不能)
;; カウンターヒット:  +500
;; その他: キャラ側による加算(var(58))

;;[仕組]
;;点数加算はまずvar(57)に代入され、var(58)と比較、上昇した場合は加算

;; @親スコア取得(一回のみ)
;; A親側のスコア上昇を取得


[State 0]
	type = VarAdd
	triggerall = var(51) < 1
	triggerall = RoundState = 2
	trigger1 = NumEnemy
	trigger1 = Enemy,GetHitVar(HitShakeTime) > 0
	trigger1 = Enemy,MoveType = H && Enemy,GetHitVar(Guarded) = 0
	var(57) = 2
	IgnoreHitPause = 1
[State 0]
	type = VarAdd
	triggerall = var(51) < 1
	triggerall = RoundState = 2
	triggerall = NumEnemy
	triggerall = Enemy,GetHitVar(HitShakeTime) > 0
	triggerall = Enemy,MoveType = H && Enemy,GetHitVar(Guarded) = 0
	trigger1 = Root,HitDefAttr = SCA, SA, ST, SP
	trigger2 = NumPartner
	trigger2 = Partner,HitDefAttr = SCA, SA, ST, SP
	var(57) = 15
	IgnoreHitPause = 1
[State 0]
	type = VarAdd
	triggerall = var(51) < 1
	triggerall = RoundState = 2
	triggerall = NumEnemy
	triggerall = Enemy,GetHitVar(HitShakeTime) > 0
	triggerall = Enemy,MoveType = H && Enemy,GetHitVar(Guarded) = 0
	trigger1 = Root,HitDefAttr = SCA, SA, ST, SP
	trigger2 = NumPartner
	trigger2 = Partner,HitDefAttr = SCA, HA, HT, HP
	var(57) = 55
	IgnoreHitPause = 1

[State 0, get bonus proj]
	type = varadd
	triggerall = var(51) < 1
	triggerall = RoundState = 2
	trigger1 = Root,ProjHitTime(0) != -1 && Root,ProjHitTime(0) = 1    ;*リファレンスより参照
	trigger2 = NumPartner
	trigger2 = Partner,ProjHitTime(0) != -1 && Partner,ProjHitTime(0) = 1
	var(57) = 100
	IgnoreHitPause = 1

[State 0, get tec sbonus]
	type = varadd
	triggerall = var(51) < 1
	triggerall = RoundState = 2
	trigger1 = Root,StateNo = 195500
	trigger1 = Root,Time = 1
	var(57) = 100
	IgnoreHitPause = 1


;--------------------------------------------------------------
;; 点数表示	[ID:98###]
;; *処理落ちの場合は、削除するか、試合終了後に表示させてください。
;--------------------------------------------------------------

;; 点数再描画(７桁)
[State 0]
	type = RemoveExplod
	triggerall = NumExplod(98000)
	trigger1 = var(57)%10 != var(58)%10
	trigger2 = var(40) = 0
	trigger3 = TeamSide = 1 && Floor(Log(10,var(57))) != Floor(Log(10,(var(58))))
	id = 98000
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	triggerall = NumExplod(98001)
	trigger1 = var(57)/10%10 != var(58)/10%10
	trigger2 = var(40) = 0
	trigger3 = TeamSide = 1 && Floor(Log(10,var(57))) != Floor(Log(10,(var(58))))
	id = 98001
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	triggerall = NumExplod(98002)
	trigger1 = var(57)/100%10 != var(58)/100%10
	trigger2 = var(40) = 0
	trigger3 = TeamSide = 1 && Floor(Log(10,var(57))) != Floor(Log(10,(var(58))))
	id = 98002
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	triggerall = NumExplod(98003)
	trigger1 = var(57)/1000%10 != var(58)/1000%10
	trigger2 = var(40) = 0
	trigger3 = TeamSide = 1 && Floor(Log(10,var(57))) != Floor(Log(10,(var(58))))
	id = 98003
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	triggerall = NumExplod(98004)
	trigger1 = var(57)/10000%10 != var(58)/10000%10
	trigger2 = var(40) = 0
	trigger3 = TeamSide = 1 && Floor(Log(10,var(57))) != Floor(Log(10,(var(58))))
	id = 98004
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	triggerall = NumExplod(98005)
	trigger1 = var(57)/100000%10 != var(58)/100000%10
	trigger2 = var(40) = 0
	trigger3 = TeamSide = 1 && Floor(Log(10,var(57))) != Floor(Log(10,(var(58))))
	id = 98005
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	triggerall = NumExplod(98006)
	trigger1 = var(57)/1000000%10 != var(58)/1000000%10
	trigger2 = var(40) = 0
	trigger3 = TeamSide = 1 && Floor(Log(10,var(57))) != Floor(Log(10,(var(58))))
	id = 98006
	IgnoreHitPause = 1

; 参照変数
[State 0]
	type = varset
	trigger1 = var(58) != var(57)
	var(58) = var(57)
	IgnoreHitPause = 1


; 点数描画
[State 0]
	type = Explod
	id = 98000
	triggerall = !NumExplod(98000)
	triggerall = var(40) && RoundState = 2
	triggerall = var(51) < 1
	trigger1 = var(58) > 0
	anim = F300000 + var(58)%10
	postype = Left
	pos = Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 54, 258), var(32) - 15
	sprpriority = 0
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999
	pausemovetime = 999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	id = 98001
	triggerall = !NumExplod(98001)
	triggerall = var(40) && RoundState = 2
	triggerall = var(51) < 1
	trigger1 = var(58) > 9
	anim = F300000 + var(58)/10%10
	postype = Left
	pos = Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 45, 249), var(32) - 15
	sprpriority = 0
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999
	pausemovetime = 999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	id = 98002
	triggerall = !NumExplod(98002)
	triggerall = var(40) && RoundState = 2
	triggerall = var(51) < 1
	trigger1 = var(58) > 99
	anim = F300000 + var(58)/100%10
	postype = Left
	pos = Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 36, 240), var(32) - 15
	sprpriority = 0
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999
	pausemovetime = 999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	id = 98003
	triggerall = !NumExplod(98003)
	triggerall = var(40) && RoundState = 2
	triggerall = var(51) < 1
	trigger1 = var(58) > 999
	anim = F300000 + var(58)/1000%10
	postype = Left
	pos = Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 27, 231), var(32) - 15
	sprpriority = 0
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999
	pausemovetime = 999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	id = 98004
	triggerall = !NumExplod(98004)
	triggerall = var(40) && RoundState = 2
	triggerall = var(51) < 1
	trigger1 = var(58) > 9999
	anim = F300000 + var(58)/10000%10
	postype = Left
	pos = Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 18, 222), var(32) - 15
	sprpriority = 0
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999
	pausemovetime = 999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	id = 98005
	triggerall = !NumExplod(98005)
	triggerall = var(40) && RoundState = 2
	triggerall = var(51) < 1
	trigger1 = var(58) > 99999
	anim = F300000 + var(58)/100000%10
	postype = Left
	pos = Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9 + 9, 213), var(32) - 15
	sprpriority = 0
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999
	pausemovetime = 999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	id = 98006
	triggerall = !NumExplod(98006)
	triggerall = var(40) && RoundState = 2
	triggerall = var(51) < 1
	trigger1 = var(58) > 999999
	anim = F300000 + var(58)/1000000%10
	postype = Left
	pos = Ifelse(TeamSide=1, Floor(Log(10,var(58))) * 9, 204), var(32) - 15
	sprpriority = 0
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	removetime = -1
	supermovetime = 999999
	pausemovetime = 999999
	IgnoreHitPause = 1









;--------------------------------------------------------------

;--------------------------------------------------------------
;; "CPU"標記を表示
[State 0, CPU-mark]
	type = Explod
	triggerall = var(51) = 1	;isAI
	triggerall = var(40)
	trigger1 = !NumExplod(297000)
	ID = 297000
	anim = F297000
	postype = Left
	pos = Ifelse(TeamSide = 1, 62, 230), 3
	sprpriority = 5
	removetime = -1
	supermovetime = 999999999
	pausemovetime = 999999999
	bindtime = -1
	ownpal = 1
	ontop = 1
	IgnoreHitPause = 1
	scale = 0.5, 0.5

[State 0, Remove CPU]		;"CPU"標記を消す
	type = RemoveExplod
	triggerall = NumExplod(297000)
	trigger1 = !var(40)
	ID = 297000
	IgnoreHitPause = 1







;==============================================================
; 気絶処理(dizzy process)
;==============================================================

[State 0]
	type = Varadd
	trigger1 = var(50) > 0
	var(50) = -1
;nor;	IgnoreHitPause = 1

[State 0]
	type = Varadd
	triggerall = Root,UniqHitCount <= 1
	triggerall = Root,GetHitVar(hitcount) < 3
	triggerall = Root,Time <= 1
	trigger1 = Root,Stateno = 5001 && Root,Anim = 5000 ;S
	trigger2 = Root,Stateno = 5001 && Root,Anim = 5010 ;C
	trigger3 = Root,Stateno = 5011 && Root,Anim = 5020 ;A
	var(50) = 50
	IgnoreHitPause = 1

[State 0]
	type = Varadd
	triggerall = Root,UniqHitCount <= 1
	triggerall = Root,GetHitVar(hitcount) < 3
	triggerall = Root,Time <= 1
	trigger1 = Root,Stateno = 5001 && Root,Anim = 5001
	trigger2 = Root,Stateno = 5001 && Root,Anim = 5011
	trigger3 = Root,Stateno = 5011 && Root,Anim = 5021
	var(50) = 100
	IgnoreHitPause = 1

[State 0]
	type = Varadd
	triggerall = Root,UniqHitCount <= 1
	triggerall = Root,GetHitVar(hitcount) < 3
	triggerall = Root,Time <= 1
	trigger1 = Root,Stateno = 5001 && Root,Anim = 5002
	trigger2 = Root,Stateno = 5001 && Root,Anim = 5012
	trigger3 = Root,Stateno = 5011 && Root,Anim = 5022
	var(50) = 200
	IgnoreHitPause = 1

[State 0]
	type = VarSet
	trigger1 = Root,StateNo = 190111
	var(50) = 0
	IgnoreHitPause = 1

;-------------------
; spinning the controll buttons!!!?

[State 0]
	type = VarSet
	trigger1 = Root,StateNo = 190111
	var(52) = 0
	IgnoreHitPause = 1

[State 0]
	type = varadd
	triggerall = Root,StateNo = 190116
	trigger1 = Root,command = "holdfwd"
	trigger1 = GameTime%8 = [0,1]
	trigger2 = Root,command = "holdback"
	trigger2 = GameTime%8 = [2,3]
	trigger3 = Root,command = "holdup"
	trigger3 = GameTime%8 = [4,5]
	trigger4 = Root,command = "holddown"
	trigger4 = GameTime%8 = [6,7]
	var(52) = 1
	IgnoreHitPause = 1






;==============================================================
; 評価(ランキング)システム
;==============================================================

; MaxHitCombo bonus p1
[State 0]
	type = varset
	triggerall = RoundState = 2
	trigger1 = Root,GetHitVar(HitCount)
	trigger1 = Root,GetHitVar(HitCount) > fvar(3)
	fvar(3) = Root,GetHitVar(HitCount)
[State 0]
	type = varset
	triggerall = RoundState = 2
	triggerall = NumPartner
	trigger1 = Partner,GetHitVar(HitCount)
	trigger1 = Partner,GetHitVar(HitCount) > fvar(3)
	fvar(3) = Partner,GetHitVar(HitCount)

; MaxHitCombo bonus p2
[State 0]
	type = varset
	triggerall = RoundState = 2
	trigger1 = NumEnemy
	trigger1 = Enemy,GetHitVar(HitCount)
	trigger1 = Enemy,GetHitVar(HitCount) > fvar(13)
	fvar(13) = Enemy,GetHitVar(HitCount)

; Guard point
[State 0]
	type = varadd
	triggerall = RoundState = 2
	triggerall = !var(12)     ;; << not in 'just defence' mode!
	triggerall = NumEnemy
	triggerall = !(Enemy, HitDefAttr = SCA, NA, NP)
	trigger1 = Root,StateNo = 150 || Root,StateNo = 152 || Root,StateNo = 154 ;air
	trigger1 = Root,Time = 1
	fvar(4) = (Root,GetHitVar(Damage) + Root,GetHitVar(HitShakeTime))/20.00
[State 0]
	type = varadd
	triggerall = RoundState = 2
	triggerall = !var(12)     ;; << not in 'just defence' mode!
	triggerall = NumEnemy
	triggerall = !(Enemy, HitDefAttr = SCA, NA, NP)
	trigger1 = NumPartner
	trigger1 = Partner,StateNo = 150 || Partner,StateNo = 152 || Partner,StateNo = 154 ;air
	trigger1 = Partner,Time = 1
	fvar(4) = (Partner,GetHitVar(Damage) + Partner,GetHitVar(HitShakeTime))/20.00
;---------------
; blocking / just defence bonus
[State 0]
	type = varadd
	triggerall = RoundState = 2
	trigger1 = Root,StateNo = 195500
	trigger1 = Root,Time = 1
	fvar(6) = 0.5
	IgnoreHitPause = 1

; guard bonus
[State 0]
	type = varadd
	triggerall = RoundState = 2
	triggerall = var(12)      ;; << in just defence mode!
	trigger1 = Root,StateNo = 150 || Root,StateNo = 152 || Root,StateNo = 154 ;air
	trigger1 = Root,Time = 1
	fvar(7) = 0.25
	IgnoreHitPause = 1



;---------------------------------
; 勝敗判定開始
[State 0]
	type = varadd
	triggerall = var(47) < 10
	trigger1 = Win
	trigger2 = NumEnemy
	trigger2 = Enemy,Win
	var(47) = 1
	IgnoreHitPause = 1



;==============================================================

;==============================================================
; スペシャル・フィニッシュ  (special finish message)
[State 0]
	type = varset
	triggerall = var(47) < 2 ; << 判定カウンター
	triggerall = var(45) = 0
	trigger1 = Root,WinKO
	trigger1 = Root,MoveHit
;or;	trigger1 = Root,HitDefAttr = SCA, SA, SP, ST ;StateNo=[????,????]の方が確実です
	trigger1 = !(Root,HitDefAttr = SCA, HA, HP, HT || Root,HitDefAttr = SCA, NA, NP, NT)
	trigger2 = NumPartner
	trigger2 = Partner,WinKO
	trigger2 = Partner,MoveHit
	trigger2 = !(Partner,HitDefAttr = SCA, HA, HP, HT || Partner,HitDefAttr = SCA, NA, NP, NT)
	var(45) = 1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

;スーパーコンボ・フィニッシュー(super / hyper finish)
[State 0]
	type = varset
	triggerall = var(47) < 2 ; << 判定カウンター
	triggerall = var(45) = 0
	trigger1 = Root,WinKO
	trigger1 = Root,MoveHit
	trigger1 = Root,HitDefAttr = SCA, HA, HP, HT  ;StateNo=[????,????]の方が確実です
	trigger2 = NumPartner
	trigger2 = Partner,WinKO
	trigger2 = Partner,MoveHit
	trigger2 = Partner,HitDefAttr = SCA, HA, HP, HT
	var(45) = 2
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

[State 0]
	type = Helper
	triggerall = var(45) = 2
	triggerall = var(47) = 1 ; << 判定カウンター
	triggerall = !NumHelper(99999)
	trigger1 = Root,WinKO
	trigger2 = NumPartner
	trigger2 = Partner,WinKO
	id = 99999
	StateNo = 99999
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1


;---------------------------------
; 評価ステートへ移動
[State 0]
	type = ChangeState
	trigger1 = var(47) = 1
	value = 99980
	IgnoreHitPause = 1








;; サバイバルモード用ヘルパーの呼出(*注:派生ヘルパー)
;;[State 0]
;;	type = Helper
;;	triggerall = var(47) = 1
;;	triggerall = !NumHelper(99985)
;;	trigger1 = RoundNo > 9 && var(51) > 0
;;	name = "Ranking"
;;	ID = 99985
;;	StateNo = 99985

;--;[State 0, get bonus player]
;--;	type = VarAdd
;--;	triggerall = Win && var(51) = -1
;--;	trigger1 = NumHelper(99980)
;--;	trigger1 = Helper(99980),time = 3
;--;	trigger1 = Helper(99980),var(58) > 0
;--;	var(57) = Helper(99980),var(58)

;--;[State 0, rank rota]
;--;	type = varset
;--;	triggerall = Win && var(51) = -1
;--;	trigger1 = NumHelper(99980)
;--;	trigger1 = Helper(99980),time = 3
;--;	trigger1 = Helper(99980),var(0) > 0
;--;	var(57) = (var(57)/100)*100 + ((var(57)%100) + (Helper(99980),var(0))) / Ceil(Ifelse(var(57)%100 > 0, 2, 1))





;--------------------------------------------------------------
;クリップボード出力
;--------------------------------------------------------------
;t;[State 0, clip status]	;*98-1
;t;	type=DisplayToClipboard
;t;	trigger1 = 1
;t;	text = "LIFE= %d ,  VALUE= %d ,  / %d ,  CON= %d ,  DANGER= %d"
;t;	params = Root,Life, var(1), var(10), var(0), var(4)

;t;[State 0, clip is ai]	;*98-2
;t;	type=DisplayToClipboard
;t;	trigger1 = 1
;t;	text = "AI=%d, IsHomeTeam=%d"
;t;	params = var(51), Root,IsHomeTeam

;t;[State 0, clip score]	;*98-3
;t;	type=DisplayToClipboard
;t;	trigger1 = var(58) > 0 && var(58) = var(57)
;t;	text = "SCORE= %d ,  5= %d ,  6= %d ,  7= %d ,  8= %d"
;t;	params = var(58), 10**5, 10**6, 10**7, 10**8

;t;[State 0, clip bonus]	;*98-3.5
;t;	type = DisplayToClipboard
;t;	trigger1 = 1
;t;	text = "HIT=%d, HIT2=%d, GUARD=%d, BLOCK=%d, JD=%d" ;,COUNTER=%d
;t;	params = Ceil(fvar(3)), Ceil(fvar(13)), Ceil(fvar(4)), Ceil(fvar(6)), Ceil(fvar(7)) ;,Ceil(fvar(5))

;t;[State 0, clip mode]	;*98-4
;t;	type=DisplayToClipboard
;t;	trigger1 = Root,TeamMode = Turns
;t;	text = "MODE_P1= %d ,  MODE_P2= %d ,  VAR_P1 %d ,  VAR_P2= %d ,  VAR(59)= %d"
;t;	params = Root,sysvar(4), (Enemy,sysvar(4)), var(22), var(15), Root,var(59)

;t;[State 0, clip dizzy]	;*98-5
;t;	type=DisplayToClipboard
;t;	trigger1 = Root,StateNo = 190116
;t;	text = "Time= %d ,  GameTime= %d ,  VAR(52) %d "
;t;	params = Root,Time, GameTime%8, var(52)



















;--------------------------------------------------------------

;--------------------------------------------------------------
; "Round 1 Fight!" (helper)
;--------------------------------------------------------------

[Statedef 180000]
type = A
physics = N
ctrl = 0
anim = 0
poweradd = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	flag2 = NoBarDisplay

[State 0]
	type = AssertSpecial
	trigger1 = RoundState < 2 && var(1) < 10 ;6
	flag = Intro

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA



;-----------------------

;-----------------------

; 通常モード
[State 0]
	type = varset
	trigger1 = RoundState >= 2
	var(0) = 1

; ボーナスステージ用
[State 0]
	type = varset
	trigger1 = Root,NumExplod(920000)
	trigger2 = NumEnemy
	trigger2 = Enemy,sysvar(4)
	trigger2 = Enemy,NumExplod(920000)
	var(0) = 2

; "F1"キーが押された場合
[State 0]
	type = varset
	trigger1 = Root,win
	trigger2 = NumEnemy
	trigger2 = Enemy,win
	var(0) = 10



;-------------------
; ラウンド数等を取得
;-------------------
[State 0]
	type = varset
	trigger1 = time = 0
	var(10) = Root,RoundNo


;-------------------
; カウント開始
; P1&P2のStateNo が0に戻されたときより

[State 0]
	type = varadd
;;	triggerall = Root,NumHelper(590190) = 0
;;	triggerall = NumEnemy
;;	triggerall = Enemy,NumHelper(590190) = 0
;--;	triggerall = var(0) < 1

	trigger1 = var(10) < 2 ;; << RoundNo 
	trigger1 = Root,StateNo = 0 || Root,StateNo = 190192 || Root,StateNo = 195900
	trigger1 = Enemy,StateNo = 0 || Enemy,StateNo = 190192 || Enemy,StateNo = 195900
	trigger1 = NumPartner = 0

	trigger1 = var(10) < 2 ;; << RoundNo 
	trigger2 = Root,StateNo = 0 || Root,StateNo = 190192 || Root,StateNo = 195900
	trigger2 = Enemy,StateNo = 0 || Enemy,StateNo = 190192 || Enemy,StateNo = 195900
	trigger2 = NumPartner
	trigger2 = Partner,StateNo = 0 || Partner,StateNo = 190192 || Partner,StateNo = 195900

	trigger3 = var(10) > 1 ;; << RoundNo 
;++;	trigger3 = Root,StateNo = 5900
;++;	trigger3 = Enemy,StateNo = 5900

	trigger4 = var(1) > 0
	var(1) = 1



;----------------------
; sound
[State 0]
	type = PlaySnd
	trigger1 = var(1) = 1
	value = F10500, var(10)%4
	channel = 0

; "ready"
[State 0]
	type = Explod
	triggerall = var(20) = 0
	triggerall = !NumExplod(0)
	trigger1 = var(1) = 1
	anim = F199139
	ID = 0
	postype = Left
	sprpriority = -2
	pos = 160, 120
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	removetime = -1
[State 0]
	type = Explod
	triggerall = var(20) = 0
	triggerall = NumExplod(0) = 1
	trigger1 = var(1) = 1
	anim = F199130
	ID = 0
	postype = Left
	sprpriority = 2
	pos = 160, 120
	scale = 0.5, 0.5
	ownpal = 1
	ontop = 1
	removetime = -1


; "rounds"
[State 0]
	type = Explod
	triggerall = var(20) = 0
	triggerall = NumExplod(0) = 2
	trigger1 = var(1) = 1
	anim = F199129
	ID = 0
	postype = Left
	sprpriority = -2
	pos = 182, 146
	scale = 0.5, 0.5
	vel = 0.15, 0
	ownpal = 1
	ontop = 1
	removetime = -1
[State 0]
	type = Explod
	triggerall = var(20) = 0
	triggerall = NumExplod(0) = 3
	trigger1 = var(1) = 1
	anim = F199120 + Random%3
	ID = 0
	postype = Left
	sprpriority = 2
	pos = 182, 146
	scale = 0.5, 0.5
	vel = 0.15, 0
	ownpal = 1
	ontop = 1
	removetime = -1


; numbers
[State 0]
	type = Explod
	ID = 10
	triggerall = var(20) = 0
	trigger1 = var(1) >= 1
	trigger1 = NumExplod(10) < Floor(Log(10, var(10))) + 1
	anim = F300020 + var(10)/(10**Ifelse(NumExplod(10)=5, 6, Ifelse(NumExplod(10)=6, 5, NumExplod(10)))) % 10
	postype = Left
	pos = 230 + Floor(Log(10, var(10))) * 15 - NumExplod(10) * 15 , 141
	scale = 0.5, 0.5
	vel = 0.15, 0
	sprpriority = 5
	removetime = -1
	ontop = 1

; lights -------------
[State 0]
	type = Explod
	triggerall = var(20) = 0
	trigger1 = var(1) = 30
	anim = F121
	postype = Left
	sprpriority = 3
	pos = 210, 147
	vel = -0.5, 0
	scale = 0.2, 5.0
	ownpal = 1
	ontop = 1
[State 0]
	type = Explod
	triggerall = var(20) = 0
	trigger1 = var(1) = 30
	anim = F121
	postype = Left
	sprpriority = 3
	pos = 210, 147
	vel = -0.5, 0
	scale = 5.0, 0.2
	ownpal = 1
	ontop = 1


;-----------------------
; pic-Fight
[State 0]
	type = Explod
	trigger1 = var(0) = 1
	anim = F199005
	id = 11
	postype = Left
	sprpriority = 0
	pos = 160, 120
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1
[State 0]
	type = Explod
	trigger1 = var(0) = 1
	anim = F199000
	id = 11
	postype = Left
	sprpriority = 7
	pos = 160, 120
	scale = 0.5, 0.5
	bindtime = -1
	ownpal = 1
	ontop = 1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1


[State 0]
	type = Explod
	trigger1 = var(0) = 1
	anim = F121
	id = 11
	postype = Left
	sprpriority = 7
	pos = 160, 120
	scale = 100, 100
	bindtime = -1
	ownpal = 1
	ontop = 1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1

;sound "Fight!!!"
[State 0]
	type = PlaySnd
	trigger1 = var(0) = 1
	value = F20000, 10
	channel = 0
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1



;--------
[State 0]
	type = RemoveExplod
	trigger1 = var(0)
	ID = 0
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	trigger1 = var(0)
	ID = 1
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	trigger1 = var(0)
	ID = 10
	supermovetime = 999999999
	pausemovetime = 999999999
	IgnoreHitPause = 1



;-----------------------
[State 0]
	type = DestroySelf
	trigger1 = var(0)
	IgnoreHitPause = 1











;--------------------------------------------------------------

;--------------------------------------------------------------
;地面衝突用ヘルパー
;Level: ID = [9005-9]

[StateDef 9005]
type = CF
physics = N
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	flag2 = noshadow
[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

[State 0]
	type = varset
	trigger1 = time = 0
	var(0) = IsHelper(9005)*0 + IsHelper(9006)*1 + IsHelper(9007)*2 + IsHelper(9008)*3 + IsHelper(9009)*4

[State 0]
	type = EnvShake
	trigger1 = time = 0
	time = Ifelse(var(0), 12, 6)
	ampl = Ifelse(var(0), 4, 3)
	IgnoreHitPause = 1

[State 0]
	type = Explod
	trigger1 = Time = 0
	anim = F62
	id = 1
	pos = 0, 0
	scale = Ifelse(!var(0), 1, 1.5), Ifelse(!var(0), 1, 1.5)
	postype = P1
	sprpriority = -2
	bindtime = 1
	ownpal = 1
	persistent = 0
	IgnoreHitPause = 1

;--------
[State 0]  ;水波
	type = Explod
	triggerall = Root,NumExplod(990100)
	trigger1 = Time = 0
	id = 990101
	anim = F127
	sprpriority = 7
	postype = p1
	pos = 0, -8
	ownpal = 1
[State 0]
	type = Explod
	triggerall = Root,NumExplod(990100)
	trigger1 = Time = 0
	id = 990102
	anim = F128
	sprpriority = 7
	postype = p1
	pos = 0, -8
	ownpal = 1

[State 0]
	type = PlaySnd
	triggerall = Root,NumExplod(990100)
	trigger1 = Time = 0
	value = F127, 0


[State 0]
	type = PlaySnd
	trigger1 = Time = 0
	value = F5000, 0
[State 0]
	type = PlaySnd
	trigger1 = Time = 0 && var(0)
	value = F5000, 1
[State 0]
	type = PlaySnd
	trigger1 = Time = 0 && var(0)
	value = F5000, 2



;ヒットスパーク・粒
;--------
[State 0]
	type = VarRangeSet
	trigger1 = time = 0
	first = 0
	last = 6
	fvalue = 1.00 + (Random%10)/10.0

;--------
[State 0]
	type = Explod
	trigger1 = Time = 0
	anim = F80 + (Random%5)
	sprpriority = 7
	postype = P1
	pos = 0, 0
	velocity = ((Random%100)-50)/10.00, -(1+(Random%100)/20.00)
	bindtime = 1
	scale = fvar(0), fvar(0)
	ownpal = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	trigger1 = Time = 0
	anim = F80 + (Random%5)
	sprpriority = 7
	postype = P1
	pos = 0, 0
	velocity = ((Random%100)-50)/10.00, -(1+(Random%100)/20.00)
	bindtime = 1
	scale = fvar(1), fvar(1)
	ownpal = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	trigger1 = Time = 0
	anim = F80 + (Random%5)
	sprpriority = 7
	postype = P1
	pos = 0, 0
	velocity = ((Random%100)-50)/10.00, -(1+(Random%100)/20.00)
	bindtime = 1
	scale = fvar(2), fvar(2)
	ownpal = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	trigger1 = Time = 0
	anim = F80 + (Random%5)
	sprpriority = 7
	postype = P1
	pos = 0, 0
	velocity = ((Random%100)-50)/10.00, -(1+(Random%100)/20.00)
	bindtime = 1
	scale = fvar(3), fvar(3)
	ownpal = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	trigger1 = Time = 0
	anim = F80 + (Random%5)
	sprpriority = 7
	postype = P1
	pos = 0, 0
	velocity = ((Random%100)-50)/10.00, -(1+(Random%100)/20.00)
	bindtime = 1
	scale = fvar(4), fvar(4)
	ownpal = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	trigger1 = Time = 0
	anim = F80 + (Random%5)
	sprpriority = 7
	postype = P1
	pos = 0, 0
	velocity = ((Random%100)-50)/10.00, -(1+(Random%100)/20.00)
	bindtime = 1
	scale = fvar(5), fvar(5)
	ownpal = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	trigger1 = Time = 0
	anim = F80 + (Random%5)
	sprpriority = 7
	postype = P1
	pos = 0, 0
	velocity = ((Random%100)-50)/10.00, -(1+(Random%100)/20.00)
	bindtime = 1
	scale = fvar(6), fvar(6)
	ownpal = 1
	IgnoreHitPause = 1


[State 0]
	type = DestroySelf
	trigger1 = time = 0
	IgnoreHitPause = 1










;--------------------------------------------------------------

;--------------------------------------------------------------
;地面旋風ヘルパー (dust)
;Level: ID = [160100-9]
;time = ID * 5 / 19=-1

[StateDef 160100]
type = C
physics = N
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	flag2 = noshadow
[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA

;--------
[State 0]
	type = varset
	trigger1 = 1
	var(1) = Floor(GameTime*2)
	IgnoreHitPause = 1

[State 0]
	type = varset
	trigger1 = 1
	fvar(7) = var(1) / 180.00 * 3.14 * 4
	IgnoreHitPause = 1
[State 0]
	type = varset
	trigger1 = 1
	fvar(8) = (var(1) + 45) / 180.00 * 3.14 * 4
	IgnoreHitPause = 1

[State 0]
	type = varset
	trigger1 = 1
	fvar(1) = sin(fvar(7)) * 45
	IgnoreHitPause = 1
[State 0]
	type = varset
	trigger1 = 1
	fvar(2) = sin(fvar(8)) * 45
	IgnoreHitPause = 1

[State 0]
	type = varset
	trigger1 = 1
	fvar(4) = cos(fvar(7)) * 10
	IgnoreHitPause = 1
[State 0]
	type = varset
	trigger1 = 1
	fvar(5) = cos(fvar(8)) * 10
	IgnoreHitPause = 1

;--------
[State 0]
	type = Explod
	trigger1 = var(1)%3 = 0
	anim = F210530
	pos = Floor(fvar(1)), Floor(fvar(4))
	Sprpriority = Ifelse(fvar(4) > 0, 4, -4)
;	scale = 0.5, 0.5
	bindtime = 1
	IgnoreHitPause = 1
[State 0]
	type = Explod
	trigger1 = var(1)%3 = 0
	anim = F210530
	pos = Floor(fvar(2)), Floor(fvar(5))
	Sprpriority = Ifelse(fvar(5) > 0, 4, -4)
;	scale = 0.5, 0.5
	bindtime = 1
	IgnoreHitPause = 1


[State 0]
	type = DestroySelf
	trigger1 = var(1) > 2 ;27
	IgnoreHitPause = 1






;--------------------------------------------------------------

;--------------------------------------------------------------
;着地衝撃波ヘルパー (dust)

[StateDef 152000]
type = C
physics = N
ctrl = 0

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	flag2 = noshadow

[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA
	time = 1

[State 0]
	type = varset
	trigger1 = Time = 0
	var(0) = Ifelse(IsHelper(152010), 1, 0)

[State 0]
	type = varset
	trigger1 = Time = 0
	fvar(0) = (Parent,Const(Size.ground.back) + Parent,Const(Size.ground.front)) * (Parent,Const(Size.Xscale))
[State 0]
	type = varset
	trigger1 = Time = 0
	fvar(0) = fvar(0) / 50.00

;--------
[State 0]
	type = playsnd
	triggerall = Root,NumExplod(990100) = 0
	trigger1 = Time = 0
	value = F(Ifelse(var(0), 5000, 52)), 0

;--------
[State 0]
	type = Explod
	triggerall = Root,NumExplod(990100) = 0
	trigger1 = Time = 0
	anim = F(Ifelse(var(0), 60, 50))
	sprpriority = -2
	postype = p1
	ownpal = 1
	scale = fvar(0), fvar(0)

;--------
;水・ステージ用
[State 0]
	type = Explod
	triggerall = Root,NumExplod(990100)
	trigger1 = Time = 0
	id = 990101
	anim = F127
	sprpriority = 7
	postype = p1
	pos = 0, -8
	ownpal = 1
[State 0]
	type = Explod
	triggerall = Root,NumExplod(990100)
	trigger1 = Time = 0
	id = 990102
	anim = F128
	sprpriority = 7
	postype = p1
	pos = 0, -8
	ownpal = 1

[State 0]
	type = PlaySnd
	triggerall = Root,NumExplod(990100)
	trigger1 = Time = 0
	value = F127, 0


;--------
[State 0]
	type = DestroySelf
	trigger1 = time > 0











;--------------------------------------------------------------

;--------------------------------------------------------------
;サイコドライブの映像...(^^; (mini display)

[StateDef 990107]
type = S
physics = N
ctrl = 0
sprpriority = -7

[State 0]
	type = AssertSpecial
	trigger1 = 1
	flag = invisible
	flag2 = noshadow
[State 0]
	type = NotHitBy
	trigger1 = 1
	value = SCA


;--------
[State 0]
	type = varset
	trigger1 = GameTime%1200 = 0
	var(0) = !var(0)

;--------
[State 0]
	type = ChangeAnim
	trigger1 = Anim != Parent,Anim
	trigger1 = SelfAnimExist(Parent,Anim)
	value = Parent,Anim

[State 0]
	type = Turn
	trigger1 = facing != Parent,facing


[State 0]
	type = varset
	trigger1 = AnimElem = 1
	trigger2 = AnimTime = 0
	var(3) = Ifelse((AnimElem = 1), 0, 250)

[State 0]
	type = Afterimage
	triggerall = GameTime%2
	trigger1 = MatchNo = 1 && Ifelse(TeamSide = 1, var(0), !var(0))
	trigger2 = MatchNo > 1
	time = 2
	length = 2
	TimeGap = 1
	FrameGap = 1
	PalContrast = 0, 125, 0
	Trans = Add1


















;==============================================================

;==============================================================
[Statedef -2]
;==============================================================


;--------------------------------------------------------------
; [5900]で一回のみ実行 Set PlayerType for normal mode
[State 0]
	type = VarSet
	triggerall = !IsHelper
	triggerall = StateNo = 5900 && time = 0
	trigger1 = sysvar(4) = 0
	trigger1 = NumPartner = 0
	sysvar(4) = Ifelse(!(PalNo%3), 3, PalNo%3)

; for TeamMode (tag)
[State 0]
	type = VarSet
	triggerall = !IsHelper
	triggerall = StateNo = 5900 && time = 0
	trigger1 = sysvar(4) = 0
	trigger1 = NumPartner
	trigger1 = ID < Partner,ID
	sysvar(4) = 4




;#ADD004BASC PIEs#
;============================================================================
; edited life & power bar
[State 2,1]
	type = Helper
	triggerall = !IsHelper
	triggerall = !NumHelper(90900)
	triggerall = !NumHelper(90901)
	triggerall = !NumHelper(90902)
	trigger1 = NumPartner
	trigger1 = ID < Partner,ID
	trigger2 = !NumPartner
	name = "LifeBar-A4"
	ID = 90900  ;; << 90901 ;;  << PowerBar Off Mode
	Stateno = 90900
;======================================
;--------------------------------------
; ブロッキング/ジャストディフェンス
; blocking/JD system helper set
[State 2,1]
	type = Helper
	triggerall = !IsHelper
	triggerall = NumHelper(90900)
	triggerall = Helper(90900),var(22) = [2,3]
	triggerall = !NumHelper(99997) && !NumHelper(99998)
	triggerall = Ctrl || StateNo = 40 || StateNo = 52 || StateNo = 100
	triggerall = StateNo != 195500
	trigger1 = Helper(90900),var(22) = 2 && Command = "holdfwd"
	trigger2 = Helper(90900),var(22) = 3 && Command = "holdback"
	;-----------------
	;-;(デバッグモード) (debug mode)
	;trigger3 = Helper(90900),var(51) < 1 && Helper(90900),var(22) = 2 && Command != "holdback"
	;trigger4 = Helper(90900),var(51) < 1 && Helper(90900),var(22) = 3 && Command != "holdfwd"
	;-----------------
	ID = 99997 + (Helper(90900),var(22) = 3)
	Stateno = 99997
	IgnoreHitPause = 1
;--------------------------------------
; 成功
; blocking/JD succeed!
[State 0]
	type = ChangeState
	triggerall = !IsHelper
	triggerall = NumHelper(90900)
	triggerall = Helper(90900),var(22) = [2,3]
	triggerall = NumHelper(99997) || NumHelper(99998)
	triggerall = Ctrl || StateNo = 40 || StateNo = 52 || StateNo = 100
	triggerall = StateNo != 195500
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo = 99996
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo = 99996
	value = 195500  ;; << 成功した時のステート(上書き可)
	IgnoreHitPause = 1
;--------------------------------------
; 無敵関係/判定開始時
; muteki
[State 0]
	type = HitBy
	triggerall = !IsHelper
	triggerall = NumHelper(90900)
	triggerall = Helper(90900),var(22) = [2,3]
	trigger1 = NumHelper(99997)
	trigger1 = Helper(99997),StateNo = [99996, 99997]
	trigger2 = NumHelper(99998)
	trigger2 = Helper(99998),StateNo = [99996, 99997]
	value = SCA, NT, ST, HT
	IgnoreHitPause = 1
;============================================================================











;==============================================================
; STAGE OPTIONS
; ステージ設定
; 水飛沫表現…(-_-;
;==============================================================

; ステージ情報取得
[State 0]
	type = Explod
	triggerall = !IsHelper
	triggerall = !NumExplod(990100)
	trigger1 = sysvar(0) = 1073
	trigger2 = NumEnemy
	trigger2 = Enemy,NumExplod(990100)
	ID = 990100
	anim = F111111
	removetime = -1
; 水
[State 0]
	type = Explod
	triggerall = NumExplod(990100)
	triggerall = Time = 1
	trigger1 = StateNo = 5100
	trigger2 = StateNo = 5110
	trigger3 = StateNo = 5201
	trigger4 = StateNo = 190112
	trigger5 = StateNo = 190114
	id = 990101
	anim = F127
	sprpriority = 7
	postype = p1
	pos = 0, -8
	ownpal = 1
[State 0]
	type = Explod
	triggerall = NumExplod(990100) && !NumExplod(990102)
	triggerall = Time = 1
	trigger1 = StateNo = 5100
	trigger2 = StateNo = 5110
	trigger3 = StateNo = 5201
	trigger4 = StateNo = 190112
	trigger5 = StateNo = 190114
	trigger6 = Pos Y = 0 
	id = 990102
	anim = F128
	sprpriority = 7
	postype = p1
	pos = 0, -8
	ownpal = 1
	bindtime = -1
	removetime = -1
	IgnoreHitPause = 1
[State 0]
	type = PlaySnd
	triggerall = NumExplod(990100)
	triggerall = Time = 1
	trigger1 = StateNo = 5100
	trigger2 = StateNo = 5110
	trigger3 = StateNo = 5201
	trigger4 = StateNo = 190112
	trigger5 = StateNo = 190114
	value = F127, 0

; 水(ジャンプ前)
[State 0]
	type = Explod
	triggerall = NumExplod(990102)
	trigger1 = Pos Y < 0
	trigger1 = !NumExplod(990103)
	id = 990103
	anim = F127
	sprpriority = 7
	postype = p1
	pos = 0, -6 + Floor(Abs(Pos Y + Vel Y))
	ownpal = 1
	scale = 0.75, 0.40
	IgnoreHitPause = 1
[State 0]
	type = RemoveExplod
	triggerall = NumExplod(990102)
	trigger1 = Pos Y != 0
	id = 990102
	IgnoreHitPause = 1




;==============================================================
;[EOF]
